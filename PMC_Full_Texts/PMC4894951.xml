<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName NPG_XML_Article.dtd?><?SourceDTD.Version 2.7.10?><?ConverterInfo.XSLTName nature2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4894951</article-id><article-id pub-id-type="pii">ncomms11729</article-id><article-id pub-id-type="doi">10.1038/ncomms11729</article-id><article-id pub-id-type="pmid">27222432</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Cox process representation and inference for stochastic reaction&#x02013;diffusion processes</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Schnoerr</surname><given-names>David</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="aff" rid="a2">2</xref><xref ref-type="aff" rid="a3">3</xref></contrib><contrib contrib-type="author"><name><surname>Grima</surname><given-names>Ramon</given-names></name><xref ref-type="aff" rid="a1">1</xref><xref ref-type="aff" rid="a3">3</xref></contrib><contrib contrib-type="author"><name><surname>Sanguinetti</surname><given-names>Guido</given-names></name><xref ref-type="corresp" rid="c1">a</xref><xref ref-type="aff" rid="a2">2</xref><xref ref-type="aff" rid="a3">3</xref></contrib><aff id="a1"><label>1</label><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3JH, <country>UK</country></aff><aff id="a2"><label>2</label><institution>School of Informatics, University of Edinburgh</institution>, Edinburgh EH8 9AB, <country>UK</country></aff><aff id="a3"><label>3</label><institution>SynthSys, University of Edinburgh</institution>, Edinburgh EH9 3JD, <country>UK</country></aff></contrib-group><author-notes><corresp id="c1"><label>a</label><email>gsanguin@inf.ed.ac.uk</email></corresp></author-notes><pub-date pub-type="epub"><day>25</day><month>05</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>7</volume><elocation-id>11729</elocation-id><history><date date-type="received"><day>16</day><month>12</month><year>2015</year></date><date date-type="accepted"><day>26</day><month>04</month><year>2016</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2016, Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved.</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved.</copyright-holder><license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><!--author-paid--><license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p></license></permissions><abstract><p>Complex behaviour in many systems arises from the stochastic interactions of spatially distributed particles or agents. Stochastic reaction&#x02013;diffusion processes are widely used to model such behaviour in disciplines ranging from biology to the social sciences, yet they are notoriously difficult to simulate and calibrate to observational data. Here we use ideas from statistical physics and machine learning to provide a solution to the inverse problem of learning a stochastic reaction&#x02013;diffusion process from data. Our solution relies on a non-trivial connection between stochastic reaction&#x02013;diffusion processes and spatio-temporal Cox processes, a well-studied class of models from computational statistics. This connection leads to an efficient and flexible algorithm for parameter inference and model selection. Our approach shows excellent accuracy on numeric and real data examples from systems biology and epidemiology. Our work provides both insights into spatio-temporal stochastic systems, and a practical solution to a long-standing problem in computational modelling.</p></abstract><abstract abstract-type="web-summary"><p>
<inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="i1" xlink:href="ncomms11729-i1.jpg"/>Stochastic reaction-diffusion systems are used for modelling spatial dynamics in many disciplines, but parameter inference and model selection remain challenging. Here the authors offer a solution enabled by a connection between reaction-diffusion and the well-studied spatio-temporal Cox processes.</p></abstract></article-meta></front><body><p>Many complex behaviours in several disciplines originate from a common mechanism: the dynamics of locally interacting, spatially distributed agents. Examples arise at all spatial scales and in a wide range of scientific fields, from the microscopic interactions of low-abundance molecules within cells, to ecological and epidemic phenomena at the continental scale. Frequently, stochasticity and spatial heterogeneity play a crucial role in determining the process dynamics and the emergence of collective behaviour<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b6">6</xref><xref ref-type="bibr" rid="b7">7</xref><xref ref-type="bibr" rid="b8">8</xref>.</p><p>Stochastic reaction&#x02013;diffusion processes (SRDPs) constitute a convenient mathematical framework to model such systems. SRDPs were originally introduced in statistical physics<xref ref-type="bibr" rid="b9">9</xref><xref ref-type="bibr" rid="b10">10</xref> to describe the collective behaviour of populations of point-wise agents performing Brownian diffusion in space and stochastically interacting with other, nearby agents according to predefined rules. The flexibility afforded by the local interaction rules has led to a wide application of SRDPs in many different scientific disciplines where complex spatio-temporal behaviours arise, from molecular biology<xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref>, to ecology<xref ref-type="bibr" rid="b13">13</xref>, and to the social sciences<xref ref-type="bibr" rid="b14">14</xref>.</p><p>Despite their popularity, SRDPs pose considerable challenges, as analytical computations are only possible for a handful of systems<xref ref-type="bibr" rid="b8">8</xref>. Thus, many analytical techniques that are widely used for non-spatial stochastic systems cannot be used for SRDPs. From the practical point of view, perhaps the single most important outstanding problem is inference in SRDP models: given observations of the system, can we reconstruct the interaction rules/local dynamic parameters? Solving this inverse problem would be important, as it would allow to quantitatively assess model fit to data and to compare different models/hypotheses in the light of observations.</p><p>SRDPs are generally analysed by either Brownian dynamics simulations of individual particles or by resorting to spatial discretization, leading to the so-called &#x02018;reaction&#x02013;diffusion master equation' (RDME)<xref ref-type="bibr" rid="b15">15</xref><xref ref-type="bibr" rid="b16">16</xref>. The computational complexity of the RDME obviously increases as the spatial discretization becomes finer, and in many cases the limiting process does not lead to the original SRDP<xref ref-type="bibr" rid="b17">17</xref>. Significant effort has been spent to improve the performance of the two types of simulations<xref ref-type="bibr" rid="b18">18</xref><xref ref-type="bibr" rid="b19">19</xref><xref ref-type="bibr" rid="b20">20</xref><xref ref-type="bibr" rid="b21">21</xref><xref ref-type="bibr" rid="b22">22</xref><xref ref-type="bibr" rid="b23">23</xref><xref ref-type="bibr" rid="b24">24</xref>; however, the computational costs are still high and quickly become prohibitive for larger systems. More importantly, the lack of an analytical alternative to simulations means that evaluating the fit of a model to observations (the likelihood function) is computationally extremely expensive, effectively ruling out statistical analyses. As far as we are aware, the few attempts at statistical inference for SRDPs either used simulation-based likelihood free methods<xref ref-type="bibr" rid="b13">13</xref>, inheriting the intrinsic computational difficulties discussed above, or abandoned the SRDP framework by adopting a coarse space discretization<xref ref-type="bibr" rid="b25">25</xref> or neglecting the individual nature of agents using a linear-noise approximation<xref ref-type="bibr" rid="b26">26</xref>.</p><p>In this paper, we propose an approximate solution to the problem of computing the likelihood function in SRDPs, thus providing a principled solution to the inverse problem of model calibration. Using the classical theory of the Poisson representation (PR) for stochastic reaction processes<xref ref-type="bibr" rid="b27">27</xref>, we show that marginal probability distributions of SRDPs can be approximated in a mean-field sense by spatio-temporal Cox point processes, a class of models widely used in spatio-temporal statistics<xref ref-type="bibr" rid="b28">28</xref>. Cox processes model the statistics of point patterns via an unobserved intensity field, a random function that captures the local mean of the observed point process. This relationship between SRDPs and Cox processes is surprising, as SRDPs are mechanistic, microscopic descriptions of spatio-temporal systems, while Cox processes are employed phenomenologically to explain regularities in point patterns. This novel link between these two classes of models enables us to formally associate an SRDP with a continuous evolution equation on the local statistics of the process in terms of (stochastic) partial differential equations (SPDEs). Crucially, this novel representation of SRDPs allows us to efficiently approximate multiple-time marginals and thus data likelihoods associated with observed point patterns, enabling us to leverage the rich statistical literature on spatio-temporal point processes for parameter estimation and/or Bayesian inference<xref ref-type="bibr" rid="b28">28</xref><xref ref-type="bibr" rid="b29">29</xref>.</p><p>We demonstrate the efficiency and accuracy of our approach for the problem of parameter inference and model selection by means of a number of numerical and real data examples, using non-trivial models from systems biology and epidemiology. Our results provide both a valuable resource for performing statistical inference and assessing model fit in this important class of models, and a novel conceptual perspective on spatio-temporal stochastic systems.</p><sec disp-level="1"><title>Results</title><sec disp-level="2"><title>SRDPs and the PR</title><p>In the classical Doi interpretation<xref ref-type="bibr" rid="b9">9</xref><xref ref-type="bibr" rid="b10">10</xref>, which we adopt here, SRDPs describe the evolution of systems of point particles performing Brownian diffusion in a spatial domain <inline-formula id="d33e204"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e205" xlink:href="ncomms11729-m1.jpg"/></inline-formula>. While SRDPs are used in a variety of disciplines, we will use the language of chemical reactions to describe them in the following. We assume the existence of <italic>N</italic> different types of particles <italic>X</italic><sub><italic>i</italic></sub>, or species, which can interact through a set of predefined rules or reactions. We assume the structure of the model, that is, which reactions are possible, to be known exactly; later, we will relax this assumption to allow for the existence of a (finite) number of possible alternative mechanisms. Each particle of a particular species <italic>X</italic><sub><italic>i</italic></sub> performs Brownian diffusion with a species-specific microscopic diffusion constant <italic>D</italic><sub><italic>i</italic></sub>. Bimolecular reactions between particles occur with a certain rate whenever two particles are closer than some specified reaction range. In principle, both reaction and microscopic diffusion rate constants may be space dependent, for example, to account for geometric constraints; for simplicity, we will only describe the homogeneous case here.</p><p>SRDPs are frequently analysed via coarse graining by discretizing space and assuming dilute and well-mixed conditions in each compartment; in this case the dynamics in each compartment is described by the chemical master equation<xref ref-type="bibr" rid="b30">30</xref>. Modelling diffusion of particles between neighbouring compartments as unimolecular reactions leads to the RDME<xref ref-type="bibr" rid="b15">15</xref>, which describes the dynamics of a continuous-time Markov jump process. For systems with only zero- or first-order reactions, the RDME converges to Brownian dynamics in the continuum limit. For non-linear systems, however, this is not the case in two or more dimensions because the rate of bimolecular reactions converges to zero, independently of the scaling of the corresponding rate constant<xref ref-type="bibr" rid="b17">17</xref>.</p><p>Consider now a set of chemical species <italic>X</italic><sub><italic>i</italic></sub> in a finite volume divided into <italic>L</italic> cubic compartments of edge length <italic>h</italic>, interacting via the following <italic>R</italic> reactions:</p><p><disp-formula id="eq2"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e256" xlink:href="ncomms11729-m2.jpg"/></disp-formula></p><p><disp-formula id="eq3"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e259" xlink:href="ncomms11729-m3.jpg"/></disp-formula></p><p>Here, <italic>s</italic><sub><italic>ij</italic></sub> and <italic>r</italic><sub><italic>ij</italic></sub> are the number of reactants and product particles of species <italic>X</italic><sub><italic>i</italic></sub> in the <italic>j</italic>th reaction, respectively, <italic>k</italic><sub><italic>j</italic></sub> is the rate constant of the <italic>j</italic>th reaction, <inline-formula id="d33e293"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e294" xlink:href="ncomms11729-m4.jpg"/></inline-formula> denotes species <italic>X</italic><sub><italic>i</italic></sub> in the <italic>m</italic>th compartment and <italic>d</italic><sub><italic>i</italic></sub> is the diffusion rate constant of species <italic>X</italic><sub><italic>i</italic></sub>. The latter is related to the microscopic diffusion constant <italic>D</italic><sub><italic>i</italic></sub> via <italic>d</italic><sub><italic>i</italic></sub>=<italic>D</italic><sub><italic>i</italic></sub>/<italic>h</italic><sup>2</sup>. We assume homogenous diffusion here, that is, <italic>d</italic><sub><italic>i</italic></sub> is independent of the compartment position, but it would be straightforward to extend the following analysis to space-dependent diffusion. <inline-formula id="d33e348"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e349" xlink:href="ncomms11729-m5.jpg"/></inline-formula> denotes all the adjacent compartments of the <italic>l</italic>th compartment. <xref ref-type="disp-formula" rid="eq2">Equation (1)</xref> describes chemical reactions happening in single compartments, whereas <xref ref-type="disp-formula" rid="eq3">equation (2)</xref> describes diffusion between adjacent compartments. We confine our analysis to reactions with at most two reactant and at most two product particles, that is, <inline-formula id="d33e361"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e362" xlink:href="ncomms11729-m6.jpg"/></inline-formula>, since higher-order reactions rarely occur in nature. We call a reaction linear if <inline-formula id="d33e364"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e365" xlink:href="ncomms11729-m7.jpg"/></inline-formula> and bimolecular if <inline-formula id="d33e367"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e368" xlink:href="ncomms11729-m8.jpg"/></inline-formula>. Under well-mixed and dilute conditions in each compartment, the evolution of marginal probabilities of this system is given by the RDME that is given in general form in the Methods section.</p><p>In the case of only a single compartment, that is, <italic>L</italic>=1, the state of the system is given by <bold>n</bold>=(<italic>n</italic><sub>1</sub>,&#x02026;,<italic>n</italic><sub><italic>N</italic></sub>), where <italic>n</italic><sub><italic>i</italic></sub> is the number of <italic>X</italic><sub><italic>i</italic></sub> particles in the system, and the time evolution of the single-time probability distribution <italic>P</italic>(<bold>n</bold>,<italic>t</italic>) is determined by the chemical master equation (see the Methods section). Gardiner derived an alternative description of the dynamics of such a system by making the ansatz of writing <italic>P</italic>(<bold>n</bold>,<italic>t</italic>) as a Poisson mixture<xref ref-type="bibr" rid="b27">27</xref><xref ref-type="bibr" rid="b31">31</xref>:</p><p><disp-formula id="eq9"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e425" xlink:href="ncomms11729-m9.jpg"/></disp-formula></p><p>where <bold>u</bold>=(<italic>u</italic><sub>1</sub>,&#x02026;,<italic>u</italic><sub><italic>N</italic></sub>) and <inline-formula id="d33e442"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e443" xlink:href="ncomms11729-m10.jpg"/></inline-formula> is a Poisson distribution in <italic>n</italic><sub><italic>i</italic></sub> with mean <italic>u</italic><sub><italic>i</italic></sub>, and the <italic>u</italic><sub><italic>i</italic></sub> are complex-valued in general. Using this ansatz in the chemical master equation one can derive an exact Fokker&#x02013;Planck equation for <italic>p</italic>(<bold>u</bold>,<italic>t</italic>) or equivalently a Langevin equation for <bold>u</bold>(<italic>t</italic>)<xref ref-type="bibr" rid="b27">27</xref> (see Methods section for more details). Gardiner derived this result for the non-spatial chemical master equation and applied it to the RDME to study the corresponding continuum limit. While the PR provides an elegant analytical tool to study reaction systems, its applicability is severely hindered by the fact that the Poisson variables <italic>u</italic> are in general complex valued and hence lack a clear physical interpretation; in particular, all bimolecular reactions and all linear reactions with two non-identical product particles give rise to a complex-valued PR (for a taxonomy of which reaction systems become complex valued, see <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref>).</p></sec><sec disp-level="2"><title>Cox process representation</title><p>While in the classical view of the PR, the auxiliary variables <italic>u</italic><sub><italic>i</italic></sub> are simply introduced as a mathematical device, we can make some progress by considering a joint process over the <italic>u</italic><sub><italic>i</italic></sub> and <italic>n</italic><sub><italic>i</italic></sub> variables. Formally, this is equivalent to what in statistics is called demarginalization: a complex process is replaced by a (simpler) process in an augmented state space, such that the marginals of the augmented process return exactly the initial process. To formalize this idea, we first introduce some concepts from spatial statistics.</p><p>A (spatial) Poisson process<xref ref-type="bibr" rid="b32">32</xref> is a measure on the space of zero-dimensional subsets of a domain <inline-formula id="d33e516"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e517" xlink:href="ncomms11729-m11.jpg"/></inline-formula>; in this work, we consider Poisson processes that admit an intensity function <italic>u</italic>(<italic>x</italic>), which gives the rate of finding a point in an infinitesimally small spatial region. The number of points in a finite spatial region is then a Poisson random variable, with mean given by the integral of the intensity function over that region. A Cox process (also called &#x02018;doubly stochastic Poisson process') is a generalization of a Poisson process, where the intensity field is itself a random process. Conditioned on a realization of the intensity field, the Cox process reduces to a Poisson process (see the Methods section for a more detailed definition of Poisson and Cox processes). We will consider families of spatial Poisson (Cox) process indexed by a time variable; importantly, in this case the intensity field can be thought of as the state variable of the system, with the actual spatial points being noisy realizations of this state (see <xref ref-type="fig" rid="f1">Fig. 1</xref> for a graphical explanation). Our first observation follows directly from Gardiner's analysis of the continuum limit of the RDME (see <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for a proof).</p></sec><sec disp-level="2"><title>Remark 1</title><p>Consider an SRDP on a spatial domain <inline-formula id="d33e537"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e538" xlink:href="ncomms11729-m12.jpg"/></inline-formula> and temporal domain <inline-formula id="d33e540"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e541" xlink:href="ncomms11729-m13.jpg"/></inline-formula>, and let all reactions involve production or decay of at most one particle. Then, for appropriate initial conditions, <inline-formula id="d33e543"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e544" xlink:href="ncomms11729-m14.jpg"/></inline-formula> the single-time-point spatial probability distribution of the SRDP is exactly the same as of a spatial Poisson process.</p></sec><sec disp-level="2"><title>General SRDPs</title><p>We can build on this point process representation to develop novel, mathematically consistent approximation schemes for SRDPs in general. Consider, for example, a bimolecular reaction of the type <inline-formula id="d33e551"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e552" xlink:href="ncomms11729-m15.jpg"/></inline-formula> with propensity function <italic>f</italic>(<italic>n</italic><sub><italic>A</italic></sub>,<italic>n</italic><sub><italic>B</italic></sub>)=<italic>kn</italic><sub><italic>A</italic></sub><italic>n</italic><sub><italic>B</italic></sub>/&#x003a9;, where <italic>n</italic><sub><italic>A</italic></sub> and <italic>n</italic><sub><italic>B</italic></sub> are the number of <italic>A</italic> and <italic>B</italic> particles in the system, respectively, and &#x003a9; is the system volume. While the PR for such systems is complex valued, we can formally obtain a real system by applying a mean-field approximation that replaces the bimolecular reaction <inline-formula id="d33e600"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e601" xlink:href="ncomms11729-m16.jpg"/></inline-formula> by the two reactions <inline-formula id="d33e603"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e604" xlink:href="ncomms11729-m17.jpg"/></inline-formula> and <inline-formula id="d33e606"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e607" xlink:href="ncomms11729-m18.jpg"/></inline-formula> with propensity functions <italic>f</italic>(<italic>n</italic><sub><italic>A</italic></sub>,<italic>n</italic><sub><italic>B</italic></sub>)=<italic>kn</italic><sub><italic>A</italic></sub>&#x02329;<italic>n</italic><sub><italic>B</italic></sub>&#x0232a;/&#x003a9; and <italic>f</italic>(<italic>n</italic><sub><italic>A</italic></sub>,<italic>n</italic><sub><italic>B</italic></sub>)=<italic>kn</italic><sub><italic>B</italic></sub>&#x02329;<italic>n</italic><sub><italic>A</italic></sub>&#x0232a;/&#x003a9;, respectively. Here, &#x02329;&#x000b7;&#x0232a; denotes the expectation of a random variable with respect to its marginal distribution. The proposed approximation hence replaces the direct interaction of the particles by an effective interaction of <italic>A</italic> with the mean field of <italic>B</italic> and vice versa. Other bimolecular reactions and linear reactions with two non-identical product particles can be approximated in a similar manner. This leads to a real-valued evolution equation for the <italic>u</italic><sub><italic>i</italic></sub> variables, see Methods and <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for details and examples.</p><p>Applying this approximation to a general RDME, and subsequently the PR and taking the continuum limit gives the following set of <italic>N</italic> coupled SPDEs (see Methods section for a derivation)</p><p><disp-formula id="eq19"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e688" xlink:href="ncomms11729-m19.jpg"/></disp-formula></p><p>where the sum over <italic>r</italic>&#x02032; runs over all reactions with two product particles of species <italic>X</italic><sub><italic>i</italic></sub>. In particular, this means that in the absence of reactions with two identical product molecules the diffusion term in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref> vanishes and <xref ref-type="disp-formula" rid="eq19">equation (4)</xref> reduces to a partial differential equation (PDE), that is, the <italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>) are deterministic. <italic>x</italic> in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref> is a spatial location, <italic>D</italic><sub><italic>i</italic></sub>=<italic>h</italic><sup>2</sup><italic>d</italic><sub><italic>i</italic></sub> is the microscopic diffusion constant of species <italic>X</italic><sub><italic>i</italic></sub>, &#x00394; is the Laplace operator, <bold>u</bold>(<italic>x</italic>,<italic>t</italic>)=(<italic>u</italic><sub>1</sub>(<italic>x</italic>,<italic>t</italic>),&#x02026;,<italic>u</italic><sub><italic>N</italic></sub>(<italic>x</italic>,<italic>t</italic>)), where <italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>) is the intensity field of species <italic>X</italic><sub><italic>i</italic></sub>, <italic>dW</italic><sub><italic>r</italic>&#x02032;</sub>(<italic>x</italic>,<italic>t</italic>) is spatio-temporal Gaussian white noise and we have defined the propensity functions <italic>g</italic><sub><italic>r</italic></sub>(<bold>u</bold>(<italic>x</italic>,<italic>t</italic>)) in PR space. The latter are obtained by applying the mean-field approximation to the propensity functions <italic>f</italic><sub><italic>r</italic></sub>(<bold>n</bold>) and subsequently replacing <italic>n</italic><sub><italic>i</italic></sub>&#x02192;<italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>) and &#x02329;<italic>n</italic><sub><italic>i</italic></sub>&#x0232a;&#x02192;&#x02329;<italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>)&#x0232a;. Note that the latter denotes a local expectation of the stochastic random field <italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>), rather than a spatial averaging. See Methods and <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for more details and examples.</p><p>To obtain <xref ref-type="disp-formula" rid="eq19">equation (4)</xref>, we approximated bimolecular reactions by linear reactions. Note, however, that the propensity functions of the latter reactions depend on the mean fields of certain species. This means that the resulting SPDEs in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref> are generally non-linear and hence in principle are able to capture non-linear dynamical behaviours.</p><p><xref ref-type="disp-formula" rid="eq19">Equation (4)</xref> looks similar to the spatial chemical Langevin equation<xref ref-type="bibr" rid="b33">33</xref>, but has a different interpretation here, since it describes the intensity in PR space. In particular, just as any other PDE or SPDE description in real space, the spatial chemical Langevin equation does not provide a generative model for the actual location of the events, and thus would not allow us to directly model statistically particle locations. Notice that, as a consequence of the mean-field approximation, the mean values of the <italic>u</italic><sub><italic>i</italic></sub> fields are the same as in a deterministic rate equation description; however, the dynamics of the observed variable, that is, the points in space, remain stochastic even when the intensity field evolves deterministically. We can therefore extend Remark 1 to obtain the following result (see <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for a proof).</p></sec><sec disp-level="2"><title>Result 1</title><p>Consider the same setting as in Remark 1. Under appropriate initial conditions, if there is at least one linear reaction with two product particles of the same species, the system's single-time-point distribution is exactly the same as of a Cox process, whose intensity fulfils the SPDE given in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref>. If the system involves other types of reactions, including bimolecular reactions, the single-time probability distribution of the SRDP is approximated in a mean-field sense by that of a Poisson (Cox) process, whose intensity fulfils <xref ref-type="disp-formula" rid="eq19">equation (4)</xref>.</p></sec><sec disp-level="2"><title>The likelihood function</title><p>Result 1 provides an efficient means to calculate statistics such as expected number of agents within a certain volume, without the need to perform extensive Monte Carlo simulations, since it only requires to solve a (S)PDE for which a rich literature of numerical methods exists<xref ref-type="bibr" rid="b28">28</xref><xref ref-type="bibr" rid="b29">29</xref>. The numerical methods used in this paper are presented in <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref>. Importantly, we can use Result 1 to approximate the likelihood function of a configuration of points arising from an SRDP, by using the well-known Cox process likelihood: if <italic>u</italic>(<italic>x</italic>,<italic>t</italic>) is the intensity of a spatio-temporal Cox process with distribution <italic>p</italic>(<italic>u</italic>(<italic>x</italic>,<italic>t</italic>)) and <bold>y</bold> a given measurement at time <italic>t</italic><sub>0</sub>, the corresponding likelihood is given by<xref ref-type="bibr" rid="b28">28</xref></p><p><disp-formula id="eq20"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e971" xlink:href="ncomms11729-m20.jpg"/></disp-formula></p><p>This function can be easily optimized to yield statistical estimates of kinetic parameters from single-time observations.</p></sec><sec disp-level="2"><title>Remark 2</title><p>We would like to emphasize that in the case of a Cox process, that is, a stochastic intensity field, the number of particles in two non-overlapping spatial regions are correlated random variables in general. The reason is that the PR ansatz in <xref ref-type="disp-formula" rid="eq9">equation (3)</xref> is not merely a product of Poisson distributions, but rather an integral over such a product weighted by a corresponding mixing distribution. In the case of a Poisson process, that is, a deterministic intensity field, in contrast, the numbers of particles in two non-overlapping spatial regions are always uncorrelated.</p></sec><sec disp-level="2"><title>Time-series observations</title><p>We next consider the problem of approximating the joint distribution of point patterns arising from an SRDP at different time points. This is important when we have time-series observations, that is, spatial measurements <inline-formula id="d33e987"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e988" xlink:href="ncomms11729-m21.jpg"/></inline-formula> at discrete time points <italic>t</italic><sub>0</sub>,&#x02026;,<italic>t</italic><sub><italic>n</italic></sub>, and we want to compute the likelihood <italic>p</italic>(<bold>y</bold>|&#x00398;) of the data given a model &#x00398;. Since the system is Markovian the likelihood factorizes as</p><p><disp-formula id="eq22"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1010" xlink:href="ncomms11729-m22.jpg"/></disp-formula></p><p>We would like to approximate this likelihood, using the relation to Cox processes established in Result 1. While this is in principle straightforward, computing the terms <inline-formula id="d33e1013"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1014" xlink:href="ncomms11729-m23.jpg"/></inline-formula> involves determining the distribution over the associated <italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>) fields in PR space. This would involve inverting the PR transformation in <xref ref-type="disp-formula" rid="eq9">equation (3)</xref>, which is computationally inconvenient. Instead, we opt for an approximation strategy: assume that we have determined the PR distribution <inline-formula id="d33e1032"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1033" xlink:href="ncomms11729-m24.jpg"/></inline-formula> at time <italic>t</italic><sub><italic>i</italic>&#x02212;1</sub>, where we introduced the shorthand <inline-formula id="d33e1042"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1043" xlink:href="ncomms11729-m25.jpg"/></inline-formula>. By definition of the intensity of a Poisson process, <inline-formula id="d33e1045"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1046" xlink:href="ncomms11729-m26.jpg"/></inline-formula> represents the expectation of the random configuration of points <inline-formula id="d33e1048"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1049" xlink:href="ncomms11729-m27.jpg"/></inline-formula> at time <italic>t</italic><sub><italic>i</italic>&#x02212;1</sub>. We then approximate <inline-formula id="d33e1059"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1060" xlink:href="ncomms11729-m28.jpg"/></inline-formula> in a mean-field way by replacing the explicit dependence on <inline-formula id="d33e1062"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1063" xlink:href="ncomms11729-m29.jpg"/></inline-formula> with its expectation <inline-formula id="d33e1065"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1066" xlink:href="ncomms11729-m30.jpg"/></inline-formula>. <xref ref-type="fig" rid="f1">Figure 1</xref> visualizes this approximation. <xref ref-type="fig" rid="f1">Figure 1a</xref> shows the time evolution in an SRDP, while <xref ref-type="fig" rid="f1">Fig. 1b</xref> shows the time evolution of a corresponding approximating Cox process. This leads to a new interpretation of the measured points <inline-formula id="d33e1078"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1079" xlink:href="ncomms11729-m31.jpg"/></inline-formula>: while they are snapshots of the actual state in the true system, they correspond to the noisy realizations of the state <bold>u</bold>(<italic>x</italic>,<italic>t</italic>) in the Cox process picture. We thus have the following result.</p></sec><sec disp-level="2"><title>Result 2</title><p>The joint <italic>n</italic>-time-point marginal distribution of an SRDP can be approximated in a mean-field sense by the joint probability of a Poisson (Cox) process, with intensity governed by the (S)PDE in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref>.</p></sec><sec disp-level="2"><title>Relation to Gardiner's work</title><p>As mentioned before, Gardiner had already derived similar equations as <xref ref-type="disp-formula" rid="eq19">equation (4)</xref> for single-time marginals of SRDPs<xref ref-type="bibr" rid="b27">27</xref>. Crucially, however, an approximation scheme for multiple-time joint marginals was, to our knowledge, never proposed; multi-time joint marginals are necessary for inference from time-series observations, hence the importance of Result 2. Furthermore, Gardiner's approach generally leads to a complex-valued PR; this motivates the novel approximation schemes of certain reactions that we introduced here. It is this novel real-valued PR, together with the interpretation of the PR variables as state variables, which allows us to derive the novel relation between SRDPs and spatio-temporal Poisson (Cox) processes.</p></sec><sec disp-level="2"><title>Inference</title><p>Result 2 is particularly powerful statistically, because it enables us to analytically approximate the exact (intractable) likelihood <italic>p</italic>(<bold>y</bold>|&#x00398;) in <xref ref-type="disp-formula" rid="eq22">equation (6)</xref>, by the likelihood of a spatio-temporal Cox process with intensity <italic>u</italic>(<italic>x</italic>,<italic>t</italic>). The intensity itself follows the dynamics imposed by the PR in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref>; importantly, the PR explicitly links the dynamic parameters governing the evolution of the intensity function to the microscopic diffusion and reaction rate constants of the SRDP.</p><p>Parameter estimation can therefore be performed efficiently by maximizing the Cox process likelihood. In the simpler case where the intensity function evolves deterministically, the likelihood can be evaluated numerically via the solution of a system of PDEs, and the dynamic parameters can be numerically recovered using standard optimization algorithms. In the case where the intensity function evolves stochastically, we evaluate the likelihood by an approximate filtering approach, as commonly used in many statistical and engineering applications (see <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for algorithmic details).</p><p>The availability of a likelihood function enables us to provide a statistically meaningful, data-driven assessment of how well a model describes the data. This is particularly important when there is uncertainty as to the precise mechanism underlying the data, for example, the exact reactions or species involved. Likelihood estimates, appropriately penalized to account for model complexity, can then be used to select models according to their support from the data.</p><p>It is important to notice that our approach directly optimizes the kinetic parameters of the model, rather than fitting an intensity function to the observed points and then fitting the dynamics. Since kinetic parameters are usually much fewer than the number of observations available, the risk of over-fitting is generally low in our approach.</p><p>Next, we apply Result 1 and Result 2 to several examples, and perform parameter inference by maximizing the data likelihood. We solve the corresponding (S)PDEs numerically by projecting them onto a finite set of spatial basis functions, see <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for details. The software used is available as <xref ref-type="supplementary-material" rid="S1">Supplementary Data 1&#x02013;4</xref>.</p></sec><sec disp-level="2"><title>Parameter estimation for a gene expression system</title><p>To demonstrate the accuracy of our method, we first consider simulated time-series data in this section. Consider a gene expression system as illustrated in <xref ref-type="fig" rid="f2">Fig. 2</xref>. For simplicitly, we consider a one-dimensional version of this system here, with the nucleus located at one side of the cell. A gene located in the nucleus is transcribed into messenger RNA (mRNA) molecules. The latter decay and diffuse across the whole cell and are translated into proteins in the cytosol. The protein molecules also diffuse across the whole cell and decay. For simplicity, we do not model the gene explicitly, but assume that mRNA becomes transcribed with a certain fixed rate <italic>m</italic><sub>1</sub> homogeneously in the nucleus. The corresponding reactions are</p><p><disp-formula id="eq32"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1171" xlink:href="ncomms11729-m32.jpg"/></disp-formula></p><p><disp-formula id="eq33"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1174" xlink:href="ncomms11729-m33.jpg"/></disp-formula></p><p>where <italic>M</italic> and <italic>P</italic> denote the mRNA and protein, respectively. For this system, the SPDE of our method in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref> becomes deterministic and thus corresponds to a Poisson process.</p><p>In addition to the reaction parameters <italic>m</italic><sub>1</sub>, <italic>m</italic><sub>2</sub>, <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub>, we have to infer the nucleus size <italic>r</italic>, as well as the diffusion rates <italic>d</italic><sub>m</sub> and <italic>d</italic><sub>p</sub> of the mRNA and protein, respectively, summing up to a total number of seven parameters. We assume that the positions of the protein molecules are observed at 30 time points, while the mRNA is unobserved. The results for one parameter set are shown in <xref ref-type="table" rid="t1">Table 1</xref>. Considering that we observe the protein at only 30 time points with unobserved mRNA and that we have seven unknown parameters, the inferred average values are remarkably close to the exact values. Moreover, the s.d.'s of the inferred results for single data sets are small, demonstrating the accuracy and precision of our method.</p><p>Next, we extend the system in <xref ref-type="fig" rid="f2">Fig. 2</xref> by adding an autocatalytic reaction for the protein,</p><p><disp-formula id="eq34"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1232" xlink:href="ncomms11729-m34.jpg"/></disp-formula></p><p>Including this reaction leads to a non-vanishing noise term in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref> and the system corresponds to a Cox process. We note that the system has a steady state only if <italic>p</italic><sub>3</sub>&#x0003c;<italic>p</italic><sub>2</sub>, with an otherwise exponentially growing mean protein number. On the mean level only the difference <italic>p</italic><sub>2</sub>&#x02212;<italic>p</italic><sub>3</sub> is identifiable, and we fix <italic>p</italic><sub>3</sub>=0.01. We thus infer the same parameters as in the previous case, but this time modelled as a Cox process. <xref ref-type="table" rid="t2">Table 2</xref> shows the results, indicating the accuracy of our method. See <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for more information on the used equations and algorithmic details.</p></sec><sec disp-level="2"><title>Parameter estimation for an SIRS model</title><p>We next consider the SIRS system, a popular model for describing the dynamics of an infection spreading through a population. Such systems are frequently modelled as SRDPs<xref ref-type="bibr" rid="b34">34</xref> or discretized versions thereof<xref ref-type="bibr" rid="b35">35</xref>. We consider a system in the two-dimensional square [0,1] &#x000d7; [0,1]. The system comprises a susceptible (<italic>S</italic>), an infected (<italic>I</italic>) and a recovered species (<italic>R</italic>), which perform Brownian diffusion and interact via the reactions</p><p><disp-formula id="eq35"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1290" xlink:href="ncomms11729-m35.jpg"/></disp-formula></p><p>where the bimolecular infection is characterized by the microscopic reaction rate <italic>k</italic> and the reaction range <italic>w</italic>. We assume that all three species diffuse with the same diffusion rate <italic>d</italic>. We assume further that initially there are no recovered (<italic>R</italic>) particles, <italic>S</italic><sub>ini</sub> susceptible (<italic>S</italic>) particles placed uniformly over the whole area and one infected (<italic>I</italic>) particle located at [0.05, 0.05]. We consider the case that all three species are observed and perform inference for 40 simulated data points using Result 2, thereby replacing <italic>k</italic> and <italic>w</italic> by an effective bimolecular reaction parameter <italic>k</italic><sup>PR</sup>. The model thus has four parameters that need to be inferred: the diffusion rate <italic>d</italic>, the recovery rate <italic>r</italic>, the susceptible rate <italic>s</italic> and the bimolecular infection rate <italic>k</italic><sup>PR</sup>. <xref ref-type="table" rid="t3">Table 3</xref> shows the corresponding results, demonstrating the accuracy and precision of our method. The computational efficiency of our method in comparison with stochastic simulations is particularly pronounced here. For the first parameter set in <xref ref-type="table" rid="t3">Table 3</xref>, for example, the Brownian dynamics simulation of a single realization of the system takes &#x0223c;250&#x02009;s, while the whole inference procedure for the four parameters using our method takes only &#x0223c;10&#x02009;s for one simulated data set on a 3.1&#x02009;GHz core. See <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for more details.</p><p><xref ref-type="fig" rid="f3">Figure 3</xref> visualizes the dynamics of the SIRS system for one parameter set. Individual points from a simulation are shown in different colours (turquoise for S, bronze for I and blue for R), while the background colours represent a superposition of the respective intensity fields with optimized parameters. Notice how the PR approximation is able to capture the emerging behaviour of a wave of infection sweeping through the domain from bottom left to top right, before the establishment of a dynamic equilibrium between the three populations. Such a phenomenon is clearly due to the spatial aspect of the system, and could not have been recovered using an inference method that does not incorporate spatial information. Indeed, the overall number of infected individuals rises rapidly and remains essentially constant between time 20 and 35 before dropping to steady state, a behaviour that is simply not possible in a non-spatial SIRS model.</p></sec><sec disp-level="2"><title>Parameter estimation for <italic>Drosophila</italic> embryo data</title><p>Finally, we apply our method to the real gene expression data for the bicoid protein at cleavage stage 13 in the <italic>Drosophila</italic> embryo. The data for 17 embryos can be obtained from the FlyEx database<xref ref-type="bibr" rid="b36">36</xref>. The data consists of fluorescence intensity measurements on a spatial grid and is shown for one embryo in <xref ref-type="fig" rid="f4">Fig. 4a</xref>. The protein becomes expressed in some region at the left end of the embryo, and then diffuses across the embryo and decays. The system is typically modelled by a linear birth&#x02013;death process<xref ref-type="bibr" rid="b25">25</xref><xref ref-type="bibr" rid="b26">26</xref>, and we assume the protein to be expressed within a certain distance <italic>r</italic> from the left end of the embryo. At cleavage stage 13, the system is supposed to be in steady state and we can perform inference using Result 1 and <xref ref-type="disp-formula" rid="eq19">equation (4)</xref>. For simplicity, we project the data to one dimension (see <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for more details).</p><p>The system has four parameters: the creation range <italic>r</italic>, the diffusion rate <italic>d</italic>, the production rate <italic>c</italic><sub>1</sub> and decay rate <italic>c</italic><sub>2</sub> of the bicoid protein. For steady-state data not all parameters, but only certain ratios are identifiable. We thus infer the creation range <italic>r</italic>, the diffusion rate <italic>d</italic> and the ratio <italic>c</italic>=<italic>c</italic><sub>1</sub>/<italic>c</italic><sub>2</sub>. For the average of the inferred parameters and their s.d.'s (shown here in parentheses) across the ensemble of embryos we obtain</p><p><disp-formula id="eq36"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1425" xlink:href="ncomms11729-m36.jpg"/></disp-formula></p><p>with s.d.'s of &#x0223c;20&#x02013;30&#x00025;. We find that these results do not change significantly under variations of the initial parameter values used in the likelihood optimiser.</p><p><xref ref-type="fig" rid="f4">Figure 4</xref> illustrates the inference result for one embryo. <xref ref-type="fig" rid="f4">Figure 4a,b</xref> shows the bicoid density across the whole embryo for experimental data and the PR prediction, respectively. We observe good agreement between the measurement data and the point process approximation. <xref ref-type="fig" rid="f4">Figure 4c</xref> shows a plot of the model residuals (difference between model predictions and real data); as can be seen, these are generally comparatively small. As could be expected, the larger errors are concentrated around the steeply changing gradient region between the anterior segments and the main body of the embryo.</p></sec><sec disp-level="2"><title>Model selection for an SIRS model</title><p>Next, we use Result 2 to perform model selection. Specifically, we use our method to decide which of two given microscopic models is more likely to be the true model underlying some given data set. To this end, we use the Bayesian information criterion (BIC)<xref ref-type="bibr" rid="b37">37</xref>. The BIC for a model is the negative log-likelihood penalized by a term depending on the number of inferred parameters and number of measurement points. The model with the lower BIC is then chosen to be the true model.</p><p>As an example, we modified the SIRS model of <xref ref-type="disp-formula" rid="eq35">equation (10)</xref> by including the possibility of a spontaneous, spatially homogeneous infection of susceptible agents, according to the reaction</p><p><disp-formula id="eq37"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1452" xlink:href="ncomms11729-m37.jpg"/></disp-formula></p><p>We consider two scenarios: the true microscopic model used to generate the data does or does not contain the spontaneous infection reaction. In either case, we use our method to select the true model. To this end, we optimize the likelihood with respect to the parameters using our method for both models, and compare the corresponding BICs. <xref ref-type="fig" rid="f5">Figure 5a,b</xref> shows the results for the two scenarios of true model without and with spontaneous infection, respectively. The figures show how often our method selected the right or wrong model, and with which confidence level. Each of the figures shows the combined results for 5 different parameter sets and 20 independent simulations for each parameter set. We find that our method chose the correct model in the vast majority of the cases (89&#x00025; where the true system does not include spontaneous infection and 96&#x00025; where the true system does contain spontaneous infection). Moreover, our method chooses the correct model with a &#x02018;very strong' confidence in most of the cases. This shows that our method is well suited for the problem of model selection. The effectiveness of our model selection approach is remarkable, since the two mechanisms (spontaneous infection and contact infection) can lead to identifiability problems. Such problems are particularly acute when spatial heterogeneities even out rapidly, as in the case of fast diffusion: the few mistakes that our model selection approach makes are primarily due to random samples of the SRDP when the infection spreads particularly fast, so that, for most time points, the process is effectively equilibrated.</p></sec></sec><sec disp-level="1"><title>Discussion</title><p>We considered two popular classes of models for studying stochasticity in spatio-temporal systems; SRDPs and spatio-temporal point processes. The two classes of models are both commonly used in many disciplines, such as epidemiology<xref ref-type="bibr" rid="b14">14</xref><xref ref-type="bibr" rid="b38">38</xref> and social sciences<xref ref-type="bibr" rid="b39">39</xref>; however, they are widely perceived as conceptually distinct. SRDPs are microscopic, mechanistic descriptions used to predict the dynamics of spatially interacting particles, whereas point processes are typically used empirically to perform inference tasks for systems for which no microscopic description exists. The two approaches therefore seem to be orthogonal to each other.</p><p>However, in this paper, we have shown that the two methods are intimately related. By using the PR we established a Cox process representation of SRDPs, which is exact for certain classes of systems and approximate for others. This novel representation enables us to apply a wide range of statistical inference methods to SRDPs, which has not been possible so far. We applied the developed method to several example systems from systems biology and epidemiology, and obtained remarkably accurate results.</p><p>Since our method agrees with a deterministic rate equation description on the mean level, bimolecular reactions may lead to deviations from the true mean, which is known to be the case in some non-spatial scenarios<xref ref-type="bibr" rid="b40">40</xref>. Since in our method distributions are given as real Poisson mixtures, sub-Poissonian fluctuations cannot be captured. However, Gardiner showed that fluctuations of SRDPs are dominated by diffusion on small length scales and therefore Poissonian<xref ref-type="bibr" rid="b33">33</xref>, which may explain the accuracy of our method.</p><p>Most inference methods in the literature for SRDPs are either based on Brownian dynamics simulations or stochastic simulations of spatially discretized systems, using the RDME. Both approaches are computationally extremely expensive, and quickly become unfeasible for larger systems and in particular for inference purposes. In contrast, our method relies on the solution of (S)PDEs for which a rich literature of efficient numerical methods exists. For the studied example systems, our method turned out to be highly efficient: the computational time for inferring four unknown parameters for the SIRS system, for example, was found to be of the order of 10&#x02009;s on a 3.1&#x02009;GHz processor. We therefore expect our method to be applicable to significantly larger systems, containing more species and unknown parameters. Remarkably, simulating a single realization of the SIRS system from Brownian dynamics simulations took about an order of magnitude longer than the whole inference procedure, using our method, that is, optimizing the likelihood with respect to the parameters, indicating the immense computational costs of inference methods based on such simulations.</p><p>Having access to a likelihood function also provides a major advantage in handling model uncertainty: our results on a spatial SIRS model show that likelihood-based criteria can efficiently and accurately discriminate between competing models. This success raises the possibility that our approach could lay the foundations for structure learning of spatio-temporal stochastic systems: leveraging spatially resolved data not only to identify parameters, but to learn directly the mechanisms underlying the data. The availability of a likelihood approximation makes it in principle possible to borrow techniques from fields, where structure learning is more established and where efficient network learning algorithms based on regularized regression or random forests are routinely used, such as learning gene regulatory networks<xref ref-type="bibr" rid="b41">41</xref><xref ref-type="bibr" rid="b42">42</xref>.</p><p>Our approach can also readily handle spatial heterogeneity in the reaction or diffusion rates: the gene regulation example showed that the method can precisely identify simple geometric features of the system, such as the radius of the cell nucleus. While our examples are primarily illustrative of the methodology, and hence simple, it would be in principle straightforward to generalize the approach to SRDPs defined on complex geometries, such as the intracellular landscapes revealed by X-ray tomography<xref ref-type="bibr" rid="b43">43</xref>. Learning complex geometries directly from the data would potentially be more challenging, however, as it would generally require learning a large number of parameters.</p><p>While we believe that the derived representation of SRDPs in terms of Cox process brings clear advantages from a statistical point of view, it is also important to acknowledge the limitations implied by the employed mean-field approximations. Perhaps, the most important step in our approximation is the mean-field treatment of multi-time joint distributions in Result 2. As noticed before, this replaces direct dependencies between particle locations at different time points, with indirect dependences through the intensity field. This implies that self-excitatory behaviours, such as clustering, cannot be accurately captured; at best, these will be mimicked by a local increase in the intensity field within a Cox process framework. More complex point processes that can account for self-excitatory behaviour do exist<xref ref-type="bibr" rid="b44">44</xref>; in our opinion, it is a question of considerable theoretical interest whether such processes can also arise from a dynamical SRDP representation.</p></sec><sec disp-level="1"><title>Methods</title><sec disp-level="2"><title>The chemical master equation</title><p>Consider a system of <italic>N</italic> species <italic>X</italic><sub><italic>i</italic></sub>, <italic>i</italic>=1,...,<italic>N</italic> that interact stochastically via <italic>R</italic> reaction channels</p><p><disp-formula id="eq38"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1517" xlink:href="ncomms11729-m38.jpg"/></disp-formula></p><p>where <italic>k</italic><sub><italic>j</italic></sub> is the rate constant of the <italic>j</italic>th reaction, and the <italic>s</italic><sub><italic>ij</italic></sub> and <italic>r</italic><sub><italic>ij</italic></sub> are non-negative integer numbers. Define the stoichiometric matrix <bold>S</bold> as <italic>S</italic><sub><italic>ij</italic></sub>=<italic>r</italic><sub><italic>ij</italic></sub>&#x02212;<italic>s</italic><sub><italic>ij</italic></sub>; the <italic>j</italic>th reaction is of order <italic>m</italic> if <inline-formula id="d33e1570"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1571" xlink:href="ncomms11729-m39.jpg"/></inline-formula>. We only consider reactions satisfying <inline-formula id="d33e1573"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1574" xlink:href="ncomms11729-m40.jpg"/></inline-formula>, that is, reactions with a maximum of two reactant and a maximum of two product particles, since higher-order reactions rarely occur in nature. Denote as <bold>n</bold>=(<italic>n</italic><sub>1</sub>,&#x02026;,<italic>n</italic><sub><italic>N</italic></sub>) the state of the system, where <italic>n</italic><sub><italic>i</italic></sub> is the copy number of species <italic>X</italic><sub><italic>i</italic></sub>. Under well-mixed and dilute conditions, the time evolution of the (single time) marginal probability distribution of the system obeys the chemical master equation<xref ref-type="bibr" rid="b30">30</xref></p><p><disp-formula id="eq41"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1607" xlink:href="ncomms11729-m41.jpg"/></disp-formula></p><p>where <bold>S</bold><sub><italic>r</italic></sub> is the <italic>r</italic>th column of the stoichiometric matrix <bold>S</bold>. The propensity function <italic>f</italic><sub><italic>r</italic></sub>(<bold>n</bold>)<italic>dt</italic> gives the probability for the <italic>r</italic>th reaction to happen in an infinitesimal time interval <italic>dt</italic> and is given by</p><p><disp-formula id="eq42"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1643" xlink:href="ncomms11729-m42.jpg"/></disp-formula></p><p>Here, &#x003a9; is the volume of the system.</p></sec><sec disp-level="2"><title>The Poisson representation</title><p>The PR makes the ansatz to write <italic>P</italic>(<bold>n</bold>,<italic>t</italic>) as a Poisson mixture<xref ref-type="bibr" rid="b27">27</xref></p><p><disp-formula id="eq43"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1663" xlink:href="ncomms11729-m43.jpg"/></disp-formula></p><p>where <bold>u</bold>=(<italic>u</italic><sub>1</sub>,&#x02026;,<italic>u</italic><sub><italic>N</italic></sub>) and <inline-formula id="d33e1680"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1681" xlink:href="ncomms11729-m44.jpg"/></inline-formula> is a Poisson distribution in <italic>n</italic><sub><italic>i</italic></sub> with mean <italic>u</italic><sub><italic>i</italic></sub>, and the <italic>u</italic><sub><italic>i</italic></sub> are complex in general. The integrals in <xref ref-type="disp-formula" rid="eq43">equation (16)</xref> in general run over the whole complex plane for each <italic>u</italic><sub><italic>i</italic></sub>. Using the ansatz (<xref ref-type="disp-formula" rid="eq43">equation 16</xref>) in the generating function equation that can be derived from <xref ref-type="disp-formula" rid="eq41">equation (14)</xref>, one can derive the following PDE for the distribution <italic>p</italic>(<bold>u</bold>,<italic>t</italic>)<xref ref-type="bibr" rid="b27">27</xref>,</p><p><disp-formula id="eq45"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1732" xlink:href="ncomms11729-m45.jpg"/></disp-formula></p><p>Note that this PDE generally involves derivatives of higher order than two, which means that <italic>p</italic>(<bold>u</bold>,<italic>t</italic>) can generally become negative, in which case it does not admit a probabilistic interpretation. However, since we only consider reactions satisfying <inline-formula id="d33e1744"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1745" xlink:href="ncomms11729-m46.jpg"/></inline-formula>, equation (17) simplifies to</p><p><disp-formula id="eq47"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1749" xlink:href="ncomms11729-m47.jpg"/></disp-formula></p><p>which is a Fokker&#x02013;Planck equation with drift vector <bold>A</bold>(<bold>u</bold>) and diffusion matrix <bold>B</bold>(<bold>u</bold>) given by</p><p><disp-formula id="eq48"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1766" xlink:href="ncomms11729-m48.jpg"/></disp-formula></p><p><disp-formula id="eq49"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1769" xlink:href="ncomms11729-m49.jpg"/></disp-formula></p><p><disp-formula id="eq50"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1772" xlink:href="ncomms11729-m50.jpg"/></disp-formula></p><p>where <italic>&#x003b4;</italic><sub><italic>i</italic>,<italic>j</italic></sub> denotes the Kronecker delta. The corresponding Langevin equation reads</p><p><disp-formula id="eq51"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1787" xlink:href="ncomms11729-m51.jpg"/></disp-formula></p><p>where <bold>W</bold> is a <italic>l</italic>-dimensional Wiener process and <italic>l</italic> is the number of columns of <bold>C</bold>.</p><p>Depending on the reactions in the system, the diffusion matrix may be zero, in which case the Langevin equation (<xref ref-type="disp-formula" rid="eq51">equation 22</xref>) reduces to deterministic ordinary differential equations. On the other hand, depending on the reactions, <bold>B</bold>(<bold>u</bold>) is not positive semidefinite and thus <bold>CC</bold><sup><italic>T</italic></sup>=<bold>B</bold> cannot be fulfilled for real <bold>C</bold>, which means that <xref ref-type="disp-formula" rid="eq47">equation (18)</xref> is not a proper Fokker&#x02013;Planck equation in real variables. Rather, it needs to be extended to complex space. Specifically, this is the case whenever the system contains bimolecular reactions or reactions with two non-identical product molecules.</p><p>An important property of the PR is that the mean values of the particle numbers <italic>n</italic><sub><italic>i</italic></sub> are equal to the mean values of the corresponding PR variables <italic>u</italic><sub><italic>i</italic></sub>, that is, &#x02329;<italic>n</italic><sub><italic>i</italic></sub>&#x0232a;=&#x02329;<italic>u</italic><sub><italic>i</italic></sub>&#x0232a;.</p></sec><sec disp-level="2"><title>The reaction&#x02013;diffusion master equation</title><p>Consider a system as in <xref ref-type="disp-formula" rid="eq38">equation (13)</xref>, but in an <italic>M</italic>-dimensional volume discretized into <italic>L</italic> cubic compartments of edge length <italic>h</italic> and volume <italic>h</italic><sup><italic>M</italic></sup>. Denote as <bold>n</bold>=(<italic>n</italic><sub>1</sub><sup>1</sup>,&#x02026;,<italic>n</italic><sub><italic>N</italic></sub><sup>1</sup>,&#x02026;,<italic>n</italic><sub>1</sub><sup><italic>L</italic></sup>,&#x02026;,<italic>n</italic><sub><italic>N</italic></sub><sup><italic>L</italic></sup>) the state of the system, where <inline-formula id="d33e1916"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1917" xlink:href="ncomms11729-m52.jpg"/></inline-formula> is the copy number of species <italic>X</italic><sub><italic>i</italic></sub> in the <italic>l</italic>th compartment. Under well-mixed and dilute conditions in each compartment, the reaction dynamics in each compartment is governed by a corresponding chemical master equation as in <xref ref-type="disp-formula" rid="eq41">equation (14)</xref>. If we model diffusion of species <italic>X</italic><sub><italic>i</italic></sub> between neighbouring compartments by linear reactions with rate constant <italic>d</italic><sub><italic>i</italic></sub>=<italic>D</italic><sub><italic>i</italic></sub>/<italic>h</italic><sup>2</sup>, where <italic>D</italic><sub><italic>i</italic></sub> is the microscopic diffusion constant of species <italic>X</italic><sub><italic>i</italic></sub>, the time evolution of the (single time) marginal probability distribution of the system obeys the RDME<xref ref-type="bibr" rid="b30">30</xref>:</p><p><disp-formula id="eq53"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1973" xlink:href="ncomms11729-m53.jpg"/></disp-formula></p><p><disp-formula id="eq54"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1976" xlink:href="ncomms11729-m54.jpg"/></disp-formula></p><p>where <italic>f</italic><sub><italic>r</italic></sub>(<bold>n</bold><sup><italic>l</italic></sup>) is the propensity function of the <italic>r</italic>th reaction evaluated at the state vector <inline-formula id="d33e1994"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1995" xlink:href="ncomms11729-m55.jpg"/></inline-formula> of the <italic>l</italic>th compartment, <inline-formula id="d33e2001"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2002" xlink:href="ncomms11729-m56.jpg"/></inline-formula> is a vector of length <italic>N</italic> &#x000d7; <italic>L</italic> with the entry corresponding to species <italic>X</italic><sub><italic>i</italic></sub> in the <italic>l</italic>th compartment equal to 1 and all other entries zero, and <inline-formula id="d33e2020"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2021" xlink:href="ncomms11729-m57.jpg"/></inline-formula> is a vector of length <italic>N</italic> &#x000d7; <italic>L</italic> with the entries corresponding to the <italic>l</italic>th compartment equal to the <italic>r</italic>th row of the stoichiometric matrix <bold>S</bold> and zero otherwise.</p></sec><sec disp-level="2"><title>Real-valued Poisson representation in space</title><p>We next apply the PR to the RDME in <xref ref-type="disp-formula" rid="eq53">equations (23)</xref> and <xref ref-type="disp-formula" rid="eq54">(24)</xref> after applying the mean-field approximations defined in the Results section to bimolecular reactions and reactions with two non-identical product molecules, and subsequently take the continuum limit. Consider first the diffusion term in <xref ref-type="disp-formula" rid="eq53">equation (23)</xref>. Since different species do not interact with each other if there are no chemical reactions happening, we can consider a system containing only a single species, say species <italic>X</italic><sub>1</sub>, for which <xref ref-type="disp-formula" rid="eq53">equation (23)</xref> reduces to</p><p><disp-formula id="eq58"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2063" xlink:href="ncomms11729-m58.jpg"/></disp-formula></p><p>where <bold>n</bold>=(<italic>n</italic><sup>1</sup>,&#x02026;,<italic>n</italic><sup><italic>L</italic></sup>), <italic>n</italic><sup><italic>m</italic></sup> is the number of <italic>X</italic><sub>1</sub> particles in the <italic>m</italic>th compartment, <italic><bold>&#x003b4;</bold></italic><sup><italic>m</italic></sup> is a vector with a one in the <italic>m</italic>th entry and zero otherwise, <italic>d</italic> is the diffusion constant of species <italic>X</italic><sub>1</sub> and the sum over <italic>m</italic> runs over all neighbouring compartments <inline-formula id="d33e2117"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2118" xlink:href="ncomms11729-m59.jpg"/></inline-formula> of the <italic>l</italic>th compartment. For this system, the PR is real and deterministic, and we use the PR without any approximations. The corresponding Langevin equation reads</p><p><disp-formula id="eq60"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2125" xlink:href="ncomms11729-m60.jpg"/></disp-formula></p><p>where <italic>M</italic> is the spatial dimension of the system and <italic>D</italic>=<italic>dh</italic><sup>2</sup> the microscopic diffusion constant. Since the sum over <italic>m</italic> runs over all adjacent compartments of the <italic>l</italic>th compartment, the fraction in <xref ref-type="disp-formula" rid="eq60">equation (26)</xref> is just the discretized version of the Laplace operator <inline-formula id="d33e2149"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2150" xlink:href="ncomms11729-m61.jpg"/></inline-formula>. Introducing a discretized density field <italic>u</italic>(<italic>x</italic><sup><italic>l</italic></sup>)=<italic>u</italic><sup><italic>l</italic></sup>/<italic>h</italic><sup><italic>M</italic></sup>, where <italic>x</italic><sup><italic>l</italic></sup> is the centre of the <italic>l</italic>th compartment, and taking the continuum limit of <xref ref-type="disp-formula" rid="eq60">equation (26)</xref>, we get the PDE</p><p><disp-formula id="eq62"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2188" xlink:href="ncomms11729-m62.jpg"/></disp-formula></p><p>which is just the diffusion equation for the field <italic>u</italic>(<italic>x</italic>,<italic>t</italic>).</p><p>Consider next the reaction term of the RDME given in <xref ref-type="disp-formula" rid="eq54">equation (24)</xref>. Since reactions only occur within compartments, we can treat the compartments independently of each other. For a single compartment, <xref ref-type="disp-formula" rid="eq54">equation (24)</xref> then reduces to the chemical master equation given in <xref ref-type="disp-formula" rid="eq41">equation (14)</xref>. Here, however, we first apply the approximations defined in the Results section to bimolecular reactions and reactions with two non-identical product molecules (see <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for more details). These approximations lead to a real-valued PR and only reactions with two identical product molecules lead to stochastic terms. The PR Langevin equation hence simplifies to</p><p><disp-formula id="eq63"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2216" xlink:href="ncomms11729-m63.jpg"/></disp-formula></p><p>where <bold>u</bold>=(<italic>u</italic><sub>1</sub>,&#x02026;,<italic>u</italic><sub><italic>N</italic></sub>) and the sum over <italic>r</italic>&#x02032; runs over all reactions with two product particles of species <italic>X</italic><sub><italic>i</italic></sub>. The propensities <italic>g</italic><sub><italic>r</italic></sub>(<bold>u</bold>) are obtained by replacing the <italic>n</italic><sub><italic>i</italic></sub> variables with <italic>u</italic><sub><italic>i</italic></sub> variables and &#x003a9; with <italic>h</italic><sup><italic>M</italic></sup> in the expressions for the <italic>f</italic><sub><italic>r</italic></sub> propensities of the approximated reactions. The factor of two in the square root in <xref ref-type="disp-formula" rid="eq63">equation (28)</xref> comes from the fact that two identical molecules become produced in these reactions. Reintroducing the label <italic>l</italic> denoting the compartment number in <xref ref-type="disp-formula" rid="eq63">equation (28)</xref>, and the species label <italic>i</italic> in <xref ref-type="disp-formula" rid="eq62">equation (27)</xref>, we can add the two contributions to obtain</p><p><disp-formula id="eq64"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2296" xlink:href="ncomms11729-m64.jpg"/></disp-formula></p><p>where <inline-formula id="d33e2299"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2300" xlink:href="ncomms11729-m65.jpg"/></inline-formula> and <italic>u</italic><sub><italic>i</italic></sub><sup><italic>l</italic></sup> is the PR variable of species <italic>X</italic><sub><italic>i</italic></sub> in the <italic>l</italic>th compartment. If we again define discretized density fields <inline-formula id="d33e2321"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2322" xlink:href="ncomms11729-m66.jpg"/></inline-formula>, where <italic>x</italic><sup><italic>l</italic></sup> is the centre of the <italic>l</italic>th compartment, and <inline-formula id="d33e2333"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2334" xlink:href="ncomms11729-m67.jpg"/></inline-formula>, we can take the continuum limit of <xref ref-type="disp-formula" rid="eq64">equation (29)</xref> that leads to the real-valued SPDE for the intensity fields given in <xref ref-type="disp-formula" rid="eq19">equation (4)</xref>. The <italic>g</italic><sub><italic>r</italic></sub>(<bold>u</bold>(<italic>x</italic>,<italic>t</italic>)) therein are not functions of single PR variables anymore, but rather functionals of the space-dependent intensity field vector <bold>u</bold>(<italic>x</italic>,<italic>t</italic>)=(<italic>u</italic><sub>1</sub>(<italic>x</italic>,<italic>t</italic>),&#x02026;,<italic>u</italic><sub><italic>N</italic></sub>(<italic>x</italic>,<italic>t</italic>)). They are obtained by taking the corresponding propensity functions <italic>f</italic><sub><italic>r</italic></sub>(<bold>n</bold>) of the approximate reactions in real space, replacing <italic>n</italic><sub><italic>i</italic></sub>&#x02192;<italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>) and &#x02329;<italic>n</italic><sub><italic>i</italic></sub>&#x0232a;&#x02192;&#x02329;<italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>)&#x0232a;, and omitting &#x003a9; factors. The latter can be identified with <italic>h</italic><sup><italic>M</italic></sup> here, and hence get absorbed in the definition of the intensity fields given below <xref ref-type="disp-formula" rid="eq64">equation (29)</xref>.</p><p>As an example, consider the reaction <italic>A</italic>&#x0002b;<italic>B</italic>&#x02192;&#x02205;. The non-spatial propensity in real space for this reaction is <italic>f</italic>(<italic>n</italic><sub><italic>A</italic></sub>,<italic>n</italic><sub><italic>B</italic></sub>)=<italic>kn</italic><sub><italic>A</italic></sub><italic>n</italic><sub><italic>B</italic></sub>/&#x003a9;. However, since this is a bimolecular reaction and hence leads to a complex-valued PR, we replace it by two reactions <italic>A</italic>&#x02192;&#x02205; and <italic>B</italic>&#x02192;&#x02205;, with propensities <italic>f</italic><sub>1</sub>(<italic>n</italic><sub><italic>A</italic></sub>,<italic>n</italic><sub><italic>B</italic></sub>)=<italic>k</italic>&#x02329;<italic>n</italic><sub><italic>B</italic></sub>&#x0232a;<italic>n</italic><sub><italic>A</italic></sub>/&#x003a9; and <italic>f</italic><sub>2</sub>(<italic>n</italic><sub><italic>A</italic></sub>,<italic>n</italic><sub><italic>B</italic></sub>)=<italic>k</italic>&#x02329;<italic>n</italic><sub><italic>A</italic></sub>&#x0232a;<italic>n</italic><sub><italic>B</italic></sub>/&#x003a9;, respectively. By replacing <italic>n</italic><sub><italic>i</italic></sub>&#x02192;<italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>) and &#x02329;<italic>n</italic><sub><italic>i</italic></sub>&#x0232a;&#x02192;&#x02329;<italic>u</italic><sub><italic>i</italic></sub>(<italic>x</italic>,<italic>t</italic>)&#x0232a;, and omitting &#x003a9; terms, we thus obtain the corresponding propensity functions in spatial PR space as <italic>g</italic><sub>1</sub>(<italic>u</italic><sub><italic>A</italic></sub>(<italic>x</italic>,<italic>t</italic>),<italic>u</italic><sub><italic>B</italic></sub>(<italic>x</italic>,<italic>t</italic>))=<italic>k</italic>&#x02329;<italic>u</italic><sub><italic>B</italic></sub>(<italic>x</italic>,<italic>t</italic>)&#x0232a;<italic>u</italic><sub><italic>A</italic></sub>(<italic>x</italic>,<italic>t</italic>) and <italic>g</italic><sub>2</sub>(<italic>u</italic><sub><italic>A</italic></sub>(<italic>x</italic>,<italic>t</italic>),<italic>u</italic><sub><italic>B</italic></sub>(<italic>x</italic>,<italic>t</italic>))=<italic>k</italic>&#x02329;<italic>u</italic><sub><italic>A</italic></sub>(<italic>x</italic>,<italic>t</italic>)&#x0232a;<italic>u</italic><sub><italic>B</italic></sub>(<italic>x</italic>,<italic>t</italic>), respectively. See <xref ref-type="supplementary-material" rid="S1">Supplementary Methods</xref> for more details and examples.</p></sec><sec disp-level="2"><title>Poisson and Cox processes</title><p>A (spatial) Poisson process on a spatial region <inline-formula id="d33e2721"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2722" xlink:href="ncomms11729-m68.jpg"/></inline-formula> of arbitrary dimension defines a measure on countable unions of zero-dimensional subsets (points) of <inline-formula id="d33e2724"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2725" xlink:href="ncomms11729-m69.jpg"/></inline-formula>. A Poisson process is often characterized by an intensity function <inline-formula id="d33e2727"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2728" xlink:href="ncomms11729-m70.jpg"/></inline-formula>, giving the probability density of finding a point in an infinitesimal region around <italic>x</italic>. Now, let <italic>N</italic>(<italic>A</italic>) denote the number of points in a subregion <inline-formula id="d33e2740"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2741" xlink:href="ncomms11729-m71.jpg"/></inline-formula>. Then <italic>N</italic>(<italic>A</italic>) is a Poisson random variable with mean given by the integral of <italic>u</italic>(&#x000b7;) over <italic>A</italic>:</p><p><disp-formula id="eq72"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2757" xlink:href="ncomms11729-m72.jpg"/></disp-formula></p><p>where <inline-formula id="d33e2760"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2761" xlink:href="ncomms11729-m73.jpg"/></inline-formula> is a Poisson distribution in <italic>n</italic> with mean <italic>u</italic><sub><italic>A</italic></sub>.</p><p>A (spatial) Cox process is a generalization of a Poisson process and also called &#x02018;doubly stochastic process', in the sense that the intensity function <italic>u</italic> is itself a random process. Conditioned on the intensity <italic>u</italic>, the Cox process reduces to a Poisson process. The distribution of the number of points in a subregion <inline-formula id="d33e2780"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2781" xlink:href="ncomms11729-m74.jpg"/></inline-formula> is hence a mixture of Poisson distributions,</p><p><disp-formula id="eq75"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2785" xlink:href="ncomms11729-m75.jpg"/></disp-formula></p><p>Since we are interested in dynamical systems, we will assume time-dependent intensities <inline-formula id="d33e2788"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2789" xlink:href="ncomms11729-m76.jpg"/></inline-formula>, where <inline-formula id="d33e2791"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2792" xlink:href="ncomms11729-m77.jpg"/></inline-formula> is a finite real interval denoting time. We then require that for any fixed time point <inline-formula id="d33e2794"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e2795" xlink:href="ncomms11729-m78.jpg"/></inline-formula>, the process is a spatial Poisson (Cox) process with intensity <italic>u</italic>(&#x000b7;,<italic>t</italic>). In the case of a Poisson (Cox) process, the intensity <italic>u</italic> may, for example, be defined as the solution of a PDE (SPDE).</p></sec><sec disp-level="2"><title>Code availability</title><p>The software used for the studied examples is available as <xref ref-type="supplementary-material" rid="S1">Supplementary Data 1&#x02013;4</xref>.</p></sec><sec disp-level="2"><title>Data availability</title><p>The <italic>Drosophila</italic> Bicoid data used in this study is available from the FlyEx database, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://urchin.spbcas.ru/flyex/">http://urchin.spbcas.ru/flyex/</ext-link>.</p></sec></sec><sec disp-level="1"><title>Additional information</title><p><bold>How to cite this article:</bold> Schnoerr, D. <italic>et al</italic>. Cox process representation and inference for stochastic reaction&#x02013;diffusion processes. <italic>Nat. Commun.</italic> 7:11729 doi: 10.1038/ncomms11729 (2016).</p></sec><sec sec-type="supplementary-material" id="S1"><title>Supplementary Material</title><supplementary-material id="d33e18" content-type="local-data"><caption><title>Supplementary Information</title><p>Supplementary Methods, Supplementary References</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-s1.pdf"/></supplementary-material><supplementary-material id="d33e24" content-type="local-data"><caption><title>Supplementary Dataset 1</title><p>Matlab code performing parameter inference for one simulated data set for the gene expression system.</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-s2.txt"/></supplementary-material><supplementary-material id="d33e30" content-type="local-data"><caption><title>Supplementary Dataset 2</title><p>Matlab code performing parameter inference for one simulated data set for the gene expression system with additional autocatalytic reaction.</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-s3.txt"/></supplementary-material><supplementary-material id="d33e36" content-type="local-data"><caption><title>Supplementary Dataset 3</title><p>Matlab code performing parameter inference for one simulated data set for the SIRS system.</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-s4.txt"/></supplementary-material><supplementary-material id="d33e42" content-type="local-data"><caption><title>Supplementary Dataset 4</title><p>Matlab code performing parameter inference for one embryo.</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-s5.txt"/></supplementary-material></sec></body><back><ack><p>This work was supported by the Biotechnology and Biological Sciences Research Council (BB/F017073/1); the Leverhulme Trust (RPG-2013-171); and the European Research Council (MLCS 306999). We thank Peter Swain, Andrew Zammit-Mangion, Manfred Opper and Giulio Caravagna for valuable discussions and comments on the draft.</p></ack><ref-list><ref id="b1"><mixed-citation publication-type="journal"><name><surname>Bullara</surname><given-names>D.</given-names></name> &#x00026; <name><surname>De Decker</surname><given-names>Y.</given-names></name>
<article-title>Pigment cell movement is not required for generation of Turing patterns in zebrafish skin</article-title>. <source>Nat. Commun.</source>
<volume>6</volume>, <fpage>6971</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25959141</pub-id></mixed-citation></ref><ref id="b2"><mixed-citation publication-type="journal"><name><surname>Metzler</surname><given-names>R.</given-names></name>
<article-title>The future is noisy: the role of spatial fluctuations in genetic switching</article-title>. <source>Phys. Rev. Lett.</source>
<volume>87</volume>, <fpage>068103</fpage> (<year>2001</year>).<pub-id pub-id-type="pmid">11497866</pub-id></mixed-citation></ref><ref id="b3"><mixed-citation publication-type="journal"><name><surname>Elf</surname><given-names>J.</given-names></name> &#x00026; <name><surname>Ehrenberg</surname><given-names>M.</given-names></name>
<article-title>Spontaneous separation of bi-stable biochemical systems into spatial domains of opposite phases</article-title>. <source>Syst. Biol.</source>
<volume>1</volume>, <fpage>230</fpage>&#x02013;<lpage>236</lpage> (<year>2004</year>).</mixed-citation></ref><ref id="b4"><mixed-citation publication-type="journal"><name><surname>Takahashi</surname><given-names>K.</given-names></name>, <name><surname>Tanase-Nicola</surname><given-names>S.</given-names></name> &#x00026; <name><surname>Ten Wolde</surname><given-names>P. R.</given-names></name>
<article-title>Spatio-temporal correlations can drastically change the response of a MAPK pathway</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>107</volume>, <fpage>2473</fpage>&#x02013;<lpage>2478</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20133748</pub-id></mixed-citation></ref><ref id="b5"><mixed-citation publication-type="journal"><name><surname>Short</surname><given-names>M. B.</given-names></name>, <name><surname>Brantingham</surname><given-names>P. J.</given-names></name>, <name><surname>Bertozzi</surname><given-names>A. L.</given-names></name> &#x00026; <name><surname>Tita</surname><given-names>G. E.</given-names></name>
<article-title>Dissipation and displacement of hotspots in reaction-diffusion models of crime</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>107</volume>, <fpage>3961</fpage>&#x02013;<lpage>3965</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20176972</pub-id></mixed-citation></ref><ref id="b6"><mixed-citation publication-type="journal"><name><surname>Mahmutovic</surname><given-names>A.</given-names></name>, <name><surname>Fange</surname><given-names>D.</given-names></name>, <name><surname>Berg</surname><given-names>O. G.</given-names></name> &#x00026; <name><surname>Elf</surname><given-names>J.</given-names></name>
<article-title>Lost in presumption: stochastic reactions in spatial models</article-title>. <source>Nat. Methods</source>
<volume>9</volume>, <fpage>1163</fpage>&#x02013;<lpage>1166</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23223170</pub-id></mixed-citation></ref><ref id="b7"><mixed-citation publication-type="journal"><name><surname>Yates</surname><given-names>C. A.</given-names></name>
<etal/>. <article-title>Inherent noise can facilitate coherence in collective swarm motion</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>106</volume>, <fpage>5464</fpage>&#x02013;<lpage>5469</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19336580</pub-id></mixed-citation></ref><ref id="b8"><mixed-citation publication-type="journal"><name><surname>Cottrell</surname><given-names>D.</given-names></name>, <name><surname>Swain</surname><given-names>P. S.</given-names></name> &#x00026; <name><surname>Tupper</surname><given-names>P. F.</given-names></name>
<article-title>Stochastic branching-diffusion models for gene expression</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>109</volume>, <fpage>9699</fpage>&#x02013;<lpage>9704</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22660929</pub-id></mixed-citation></ref><ref id="b9"><mixed-citation publication-type="journal"><name><surname>Doi</surname><given-names>M.</given-names></name>
<article-title>Second quantization representation for classical many-particle system</article-title>. <source>J. Phys. A</source>
<volume>9</volume>, <fpage>1465</fpage> (<year>1976</year>).</mixed-citation></ref><ref id="b10"><mixed-citation publication-type="journal"><name><surname>Doi</surname><given-names>M.</given-names></name>
<article-title>Stochastic theory of diffusion-controlled reaction</article-title>. <source>J. Phys. A</source>
<volume>9</volume>, <fpage>1479</fpage> (<year>1976</year>).</mixed-citation></ref><ref id="b11"><mixed-citation publication-type="journal"><name><surname>Bicknell</surname><given-names>B. A.</given-names></name>, <name><surname>Dayan</surname><given-names>P.</given-names></name> &#x00026; <name><surname>Goodhill</surname><given-names>G. J.</given-names></name>
<article-title>The limits of chemosensation vary across dimensions</article-title>. <source>Nat. Commun.</source>
<volume>6</volume>, <fpage>7468</fpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26088726</pub-id></mixed-citation></ref><ref id="b12"><mixed-citation publication-type="journal"><name><surname>Grima</surname><given-names>R.</given-names></name> &#x00026; <name><surname>Schnell</surname><given-names>S.</given-names></name>
<article-title>A systematic investigation of the rate laws valid in intracellular environments</article-title>. <source>Biophys. Chem.</source>
<volume>124</volume>, <fpage>1</fpage>&#x02013;<lpage>10</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16781049</pub-id></mixed-citation></ref><ref id="b13"><mixed-citation publication-type="journal"><name><surname>Holmes</surname><given-names>G. R.</given-names></name>
<etal/>. <article-title>Repelled from the wound, or randomly dispersed? Reverse migration behaviour of neutrophils characterized by dynamic modelling</article-title>. <source>J. R. Soc. Interface</source>
<volume>9</volume>, <fpage>3229</fpage>&#x02013;<lpage>3239</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22951343</pub-id></mixed-citation></ref><ref id="b14"><mixed-citation publication-type="journal"><name><surname>Davies</surname><given-names>T. P.</given-names></name>, <name><surname>Fry</surname><given-names>H. M.</given-names></name>, <name><surname>Wilson</surname><given-names>A. G.</given-names></name> &#x00026; <name><surname>Bishop</surname><given-names>S. R.</given-names></name>
<article-title>A mathematical model of the London riots and their policing</article-title>. <source>Sci. Rep.</source>
<volume>3</volume>, <fpage>1303</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23425781</pub-id></mixed-citation></ref><ref id="b15"><mixed-citation publication-type="journal"><name><surname>Gardiner</surname><given-names>C. W.</given-names></name>, <name><surname>McNeil</surname><given-names>K. J.</given-names></name>, <name><surname>Walls</surname><given-names>D. F.</given-names></name> &#x00026; <name><surname>Matheson</surname><given-names>I. S.</given-names></name>
<article-title>Correlations in stochastic theories of chemical reactions</article-title>. <source>J. Stat. Phys.</source>
<volume>14</volume>, <fpage>307</fpage>&#x02013;<lpage>331</lpage> (<year>1976</year>).</mixed-citation></ref><ref id="b16"><mixed-citation publication-type="journal"><name><surname>Fange</surname><given-names>D.</given-names></name>, <name><surname>Berg</surname><given-names>O. G.</given-names></name>, <name><surname>Sj&#x000f6;berg</surname><given-names>P.</given-names></name> &#x00026; <name><surname>Elf</surname><given-names>J.</given-names></name>
<article-title>Stochastic reaction-diffusion kinetics in the microscopic limit</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>107</volume>, <fpage>19820</fpage>&#x02013;<lpage>19825</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">21041672</pub-id></mixed-citation></ref><ref id="b17"><mixed-citation publication-type="journal"><name><surname>Isaacson</surname><given-names>S. A.</given-names></name>
<article-title>Relationship between the reaction-diffusion master equation and particle tracking models</article-title>. <source>J. Phys. A</source>
<volume>41</volume>, <fpage>065003</fpage> (<year>2008</year>).</mixed-citation></ref><ref id="b18"><mixed-citation publication-type="journal"><name><surname>van Zon</surname><given-names>J. S.</given-names></name> &#x00026; <name><surname>Ten Wolde</surname><given-names>P. R.</given-names></name>
<article-title>Simulating biochemical networks at the particle level and in time and space: Green's function reaction dynamics</article-title>. <source>Phys. Rev. Lett.</source>
<volume>94</volume>, <fpage>128103</fpage> (<year>2005</year>).<pub-id pub-id-type="pmid">15903966</pub-id></mixed-citation></ref><ref id="b19"><mixed-citation publication-type="journal"><name><surname>Isaacson</surname><given-names>S. A.</given-names></name> &#x00026; <name><surname>Peskin</surname><given-names>C. S.</given-names></name>
<article-title>Incorporating diffusion in complex geometries into stochastic chemical kinetics simulations</article-title>. <source>SIAM J. Sci. Comput.</source>
<volume>28</volume>, <fpage>47</fpage>&#x02013;<lpage>74</lpage> (<year>2006</year>).</mixed-citation></ref><ref id="b20"><mixed-citation publication-type="journal"><name><surname>Erban</surname><given-names>R.</given-names></name> &#x00026; <name><surname>Chapman</surname><given-names>S. J.</given-names></name>
<article-title>Stochastic modelling of reaction-diffusion processes: algorithms for bimolecular reactions</article-title>. <source>Phys. Biol.</source>
<volume>6</volume>, <fpage>046001</fpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19700812</pub-id></mixed-citation></ref><ref id="b21"><mixed-citation publication-type="journal"><name><surname>Drawert</surname><given-names>B.</given-names></name>, <name><surname>Lawson</surname><given-names>M. J.</given-names></name>, <name><surname>Petzold</surname><given-names>L.</given-names></name> &#x00026; <name><surname>Khammash</surname><given-names>M.</given-names></name>
<article-title>The diffusive finite state projection algorithm for efficient simulation of the stochastic reaction-diffusion master equation</article-title>. <source>J. Chem. Phys.</source>
<volume>132</volume>, <fpage>074101</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20170209</pub-id></mixed-citation></ref><ref id="b22"><mixed-citation publication-type="journal"><name><surname>Ferm</surname><given-names>L.</given-names></name>, <name><surname>Hellander</surname><given-names>A.</given-names></name> &#x00026; <name><surname>L&#x000f6;tstedt</surname><given-names>P.</given-names></name>
<article-title>An adaptive algorithm for simulation of stochastic reaction-diffusion processes</article-title>. <source>J. Comput. Phys.</source>
<volume>229</volume>, <fpage>343</fpage>&#x02013;<lpage>360</lpage> (<year>2010</year>).</mixed-citation></ref><ref id="b23"><mixed-citation publication-type="journal"><name><surname>Franz</surname><given-names>B.</given-names></name>, <name><surname>Flegg</surname><given-names>M. B.</given-names></name>, <name><surname>Chapman</surname><given-names>S. J.</given-names></name> &#x00026; <name><surname>Erban</surname><given-names>R.</given-names></name>
<article-title>Multiscale reaction-diffusion algorithms: PDE-assisted Brownian dynamics</article-title>. <source>SIAM J. Appl. Math.</source>
<volume>73</volume>, <fpage>1224</fpage>&#x02013;<lpage>1247</lpage> (<year>2013</year>).</mixed-citation></ref><ref id="b24"><mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>J.</given-names></name>, <name><surname>Wu</surname><given-names>S.</given-names></name>, <name><surname>Li</surname><given-names>H.</given-names></name> &#x00026; <name><surname>Petzold</surname><given-names>L. R.</given-names></name>
<article-title>The time dependent propensity function for acceleration of spatial stochastic simulation of reaction-diffusion systems</article-title>. <source>J. Comput. Phys.</source>
<volume>274</volume>, <fpage>524</fpage>&#x02013;<lpage>549</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">26609185</pub-id></mixed-citation></ref><ref id="b25"><mixed-citation publication-type="journal"><name><surname>Dewar</surname><given-names>M. A.</given-names></name>, <name><surname>Kadirkamanathan</surname><given-names>V.</given-names></name>, <name><surname>Opper</surname><given-names>M.</given-names></name> &#x00026; <name><surname>Sanguinetti</surname><given-names>G.</given-names></name>
<article-title>Parameter estimation and inference for stochastic reaction-diffusion systems: application to morphogenesis in D. melanogaster</article-title>. <source>BMC Syst. Biol.</source>
<volume>4</volume>, <fpage>21</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20219114</pub-id></mixed-citation></ref><ref id="b26"><mixed-citation publication-type="journal"><name><surname>Ruttor</surname><given-names>A.</given-names></name> &#x00026; <name><surname>Opper</surname><given-names>M.</given-names></name>
<article-title>Approximate parameter inference in a stochastic reaction-diffusion model</article-title>. <source>AISTATS</source>
<volume>9</volume>, <fpage>669</fpage>&#x02013;<lpage>676</lpage> (<year>2010</year>).</mixed-citation></ref><ref id="b27"><mixed-citation publication-type="journal"><name><surname>Gardiner</surname><given-names>C. W.</given-names></name> &#x00026; <name><surname>Chaturvedi</surname><given-names>S.</given-names></name>
<article-title>The Poisson representation. I. A new technique for chemical master equations</article-title>. <source>J. Stat. Phys.</source>
<volume>17</volume>, <fpage>429</fpage>&#x02013;<lpage>468</lpage> (<year>1977</year>).</mixed-citation></ref><ref id="b28"><mixed-citation publication-type="journal"><name><surname>Cressie</surname><given-names>N. A. C.</given-names></name> &#x00026; <name><surname>Wikle</surname><given-names>C. K.</given-names></name>
<source>Statistics for Spatio-temporal Data</source> Wiley (<year>2011</year>).</mixed-citation></ref><ref id="b29"><mixed-citation publication-type="journal"><name><surname>Cseke</surname><given-names>B.</given-names></name>, <name><surname>Zammit Mangion</surname><given-names>A.</given-names></name>, <name><surname>Heskes</surname><given-names>T.</given-names></name> &#x00026; <name><surname>Sanguinetti</surname><given-names>G.</given-names></name>
<article-title>Sparse approximate inference for spatio-temporal point process models</article-title>. <source>JASA</source> (<year>2015</year>) (in the press).</mixed-citation></ref><ref id="b30"><mixed-citation publication-type="journal"><name><surname>Gillespie</surname><given-names>D. T.</given-names></name>, <name><surname>Hellander</surname><given-names>A.</given-names></name> &#x00026; <name><surname>Petzold</surname><given-names>L. R.</given-names></name>
<article-title>Perspective: stochastic algorithms for chemical kinetics</article-title>. <source>J. Chem. Phys.</source>
<volume>138</volume>, <fpage>170901</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23656106</pub-id></mixed-citation></ref><ref id="b31"><mixed-citation publication-type="journal"><name><surname>Thomas</surname><given-names>P.</given-names></name>, <name><surname>Straube</surname><given-names>A. V.</given-names></name> &#x00026; <name><surname>Grima</surname><given-names>R.</given-names></name>
<article-title>Stochastic theory of large-scale enzyme-reaction networks: Finite copy number corrections to rate equation models</article-title>. <source>J. Chem. Phys.</source>
<volume>133</volume>, <fpage>195101</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">21090871</pub-id></mixed-citation></ref><ref id="b32"><mixed-citation publication-type="journal"><name><surname>Kingman</surname><given-names>J. F. C.</given-names></name>
<source>Poisson Processes</source> Oxford Univ. Press (<year>1992</year>).</mixed-citation></ref><ref id="b33"><mixed-citation publication-type="journal"><name><surname>Gardiner</surname><given-names>C. W.</given-names></name>
<source>Handbook of Stochastic Methods</source> Springer (<year>1985</year>).</mixed-citation></ref><ref id="b34"><mixed-citation publication-type="journal"><name><surname>Peruani</surname><given-names>F.</given-names></name> &#x00026; <name><surname>Lee</surname><given-names>C. F.</given-names></name>
<article-title>Fluctuations and the role of collision duration in reaction-diffusion systems</article-title>. <source>EPL</source>
<volume>102</volume>, <fpage>58001</fpage> (<year>2013</year>).</mixed-citation></ref><ref id="b35"><mixed-citation publication-type="journal"><name><surname>Abdullah</surname><given-names>M.</given-names></name>, <name><surname>Cooper</surname><given-names>C.</given-names></name> &#x00026; <name><surname>Draief</surname><given-names>M.</given-names></name> in <source>Approximation, Randomization, and Combinatorial Optimization. Algorithms and Techniques: 14th International Workshop, APPROX 2011, and 15th International Workshop, RANDOM 2011</source>
<fpage>351</fpage>&#x02013;<lpage>364</lpage>Springer (<year>2011</year>).</mixed-citation></ref><ref id="b36"><mixed-citation publication-type="journal"><name><surname>Pisarev</surname><given-names>A.</given-names></name>, <name><surname>Poustelnikova</surname><given-names>E.</given-names></name>, <name><surname>Samsonova</surname><given-names>M.</given-names></name> &#x00026; <name><surname>Reinitz</surname><given-names>J.</given-names></name>
<article-title>FlyEx, the quantitative atlas on segmentation gene expression at cellular resolution</article-title>. <source>Nucleic Acids Res.</source>
<volume>37</volume>, <fpage>D560</fpage>&#x02013;<lpage>D566</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">18953041</pub-id></mixed-citation></ref><ref id="b37"><mixed-citation publication-type="journal"><name><surname>Schwarz</surname><given-names>G. E.</given-names></name>
<article-title>Estimating the dimension of a model</article-title>. <source>Ann. Stat.</source>
<volume>6</volume>, <fpage>461</fpage>&#x02013;<lpage>464</lpage> (<year>1978</year>).</mixed-citation></ref><ref id="b38"><mixed-citation publication-type="journal"><name><surname>Grell</surname><given-names>K.</given-names></name>
<etal/>. <article-title>A three-dimensional point process model for the spatial distribution of disease occurrence in relation to an exposure source</article-title>. <source>Stat. Med.</source>
<volume>34</volume>, <fpage>3170</fpage>&#x02013;<lpage>3180</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26011698</pub-id></mixed-citation></ref><ref id="b39"><mixed-citation publication-type="journal"><name><surname>Zammit-Mangion</surname><given-names>A.</given-names></name>, <name><surname>Dewar</surname><given-names>M.</given-names></name>, <name><surname>Kadirkamanathan</surname><given-names>V.</given-names></name> &#x00026; <name><surname>Sanguinetti</surname><given-names>G.</given-names></name>
<article-title>Point process modelling of the Afghan War Diary</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>109</volume>, <fpage>12414</fpage>&#x02013;<lpage>12419</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22802667</pub-id></mixed-citation></ref><ref id="b40"><mixed-citation publication-type="journal"><name><surname>Ramaswamy</surname><given-names>R.</given-names></name>, <name><surname>Gonzalez-Segredo</surname><given-names>N.</given-names></name>, <name><surname>Sbalzarini</surname><given-names>I. F.</given-names></name> &#x00026; <name><surname>Grima</surname><given-names>R.</given-names></name>
<article-title>Discreteness-induced concentration inversion in mesoscopic chemical systems</article-title>. <source>Nat. Commun.</source>
<volume>3</volume>, <fpage>779</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22491327</pub-id></mixed-citation></ref><ref id="b41"><mixed-citation publication-type="journal"><name><surname>Bonneau</surname><given-names>R.</given-names></name>
<etal/>. <article-title>The Inferelator: an algorithm for learning parsimonious regulatory networks from systems-biology data sets <italic>de novo</italic></article-title>. <source>Genome Biol.</source>
<volume>7</volume>, <fpage>R36</fpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16686963</pub-id></mixed-citation></ref><ref id="b42"><mixed-citation publication-type="journal"><name><surname>Huynh-Thu</surname><given-names>V.-A.</given-names></name> &#x00026; <name><surname>Sanguinetti</surname><given-names>G.</given-names></name>
<article-title>Combining tree-based and dynamical systems for the inference of gene regulatory networks</article-title>. <source>Bioinformatics</source>
<volume>31</volume>, <fpage>1614</fpage>&#x02013;<lpage>1622</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25573916</pub-id></mixed-citation></ref><ref id="b43"><mixed-citation publication-type="journal"><name><surname>Do</surname><given-names>M.</given-names></name>, <name><surname>Isaacson</surname><given-names>S. A.</given-names></name>, <name><surname>McDermott</surname><given-names>G.</given-names></name>, <name><surname>Le Gros</surname><given-names>M. A.</given-names></name> &#x00026; <name><surname>Larabell</surname><given-names>C. A.</given-names></name>
<article-title>Imaging and Characterizing Cells using Tomography</article-title>. <source>Arch. Biochem. Biophys.</source>
<volume>581</volume>, <fpage>111</fpage>&#x02013;<lpage>121</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25602704</pub-id></mixed-citation></ref><ref id="b44"><mixed-citation publication-type="journal"><name><surname>Hawkes</surname><given-names>A. G.</given-names></name> &#x00026; <name><surname>Oakes</surname><given-names>D.</given-names></name>
<article-title>A cluster process representation of a self-exciting process</article-title>. <source>J. Appl. Prob.</source>
<volume>11</volume>, <fpage>493</fpage>&#x02013;<lpage>503</lpage> (<year>1974</year>).</mixed-citation></ref></ref-list><fn-group><fn><p><bold>Author contributions</bold> All authors designed the research. D.S. implemented the research. D.S. and G.S. wrote the paper with input from R.G.</p></fn></fn-group></back><floats-group><fig id="f1"><label>Figure 1</label><caption><title>Visualization of Cox process approximation of SRDPs for multi-time points.</title><p>(<bold>a</bold>) Time evolution of the true SRDP in space. Particles diffuse in space, may decay or are created and react with each other. (<bold>b</bold>) Time evolution of a Cox process. Here, the intensity field evolves in time, rather than the points in real space. The latter are merely noisy realizations of the intensity field. In particular, the point patterns at two different time points are independent of each other conditioned on the intensity field.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-f1"/></fig><fig id="f2"><label>Figure 2</label><caption><title>Gene expression system.</title><p>(<bold>a</bold>) Chemical reactions taking place. (<bold>b</bold>) Illustration of system. The mRNA becomes transcribed in the nucleus, and becomes translated to proteins in the cytosol. mRNA and protein molecules decay stochastically and undergo Brownian diffusion across the whole cell.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-f2"/></fig><fig id="f3"><label>Figure 3</label><caption><title>Dynamics of SIRS system.</title><p>The figure shows the time evolution of a single simulated realization (points) and of the prediction of our method (background colours) for the SIRS system with reactions in <xref ref-type="disp-formula" rid="eq35">equation (10)</xref> for time <italic>t</italic>=0&#x02013;45, with steps of &#x00394;<italic>t</italic>=5. For the simulation, we use the parameters (<italic>S</italic><sub>ini,</sub><italic>k</italic>, <italic>w</italic>, <italic>d</italic>, <italic>r</italic>, <italic>s</italic>)=(10<sup>3</sup>, 10<sup>4</sup>, 0.02, 0.0002, 0.3, 0.01) and for the point process prediction the corresponding inferred parameters. The background is an RGB image with the three colour components being proportional to the intensity fields of the three species <italic>S</italic> (turquoise), <italic>I</italic> (bronze) and <italic>R</italic> (blue). Notice how the mean-field approximation captures the complex behaviour of a wave of infection, spreading through the domain from the bottom left corner.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-f3"/></fig><fig id="f4"><label>Figure 4</label><caption><title>Results for the <italic>Drosophila</italic> embryo bicoid data.</title><p>(<bold>a</bold>) Measurement data of bicoid fluorescence intensity across a single embryo. (<bold>b</bold>) Corresponding prediction of our point process model. (<bold>c</bold>) Difference of the experimental data and point process prediction. We observe the point process prediction agrees well with the experimental data. The point process prediction is obtained by solving <xref ref-type="disp-formula" rid="eq19">equation (4)</xref> numerically for the inferred parameter values maximizing the data likelihood.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-f4"/></fig><fig id="f5"><label>Figure 5</label><caption><title>Model selection results for SIRS system.</title><p>We use the Bayesian information criterion (BIC) for model selection for the SIRS system, with reactions in <xref ref-type="disp-formula" rid="eq35">equation (10)</xref> and the additional spontaneous infection reaction in <xref ref-type="disp-formula" rid="eq37">equation (12)</xref>. The sign of the difference in the BIC numbers of the two models determines if the correct model is selected, and the corresponding magnitude how confident this choice is. We simulated 20 experiments for 5 parameter sets each. The figures show the combined results of these 100 experiments. (<bold>a</bold>) The true system used to generate the data does not include spontaneous infection. The parameter sets are the same as in <xref ref-type="table" rid="t3">Table 3</xref>. (<bold>b</bold>) The true system used to generate the data does include spontaneous infection. The parameter sets are the same as in <xref ref-type="table" rid="t3">Table 3</xref>, but with modified bimolecular infection rate that we set to <italic>k</italic>=10, 5, 10, 100 and 10, respectively. The spontaneous infection rate is set to <italic>v</italic>=0.002 for all parameter sets. In both cases, we observe that our method selects the correct model in &#x0003e;80&#x00025; of the cases, and in most of these cases with &#x02018;very strong' confidence. This demonstrates the strong performance of our method for this model selection problem.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="ncomms11729-f5"/></fig><table-wrap position="float" id="t1"><label>Table 1</label><caption><title>Inference results for gene expression system.</title></caption><table frame="hsides" rules="groups" border="1"><colgroup><col align="left"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/></colgroup><thead valign="bottom"><tr><th align="left" valign="top" charoff="50">&#x000a0;</th><th align="center" valign="top" charoff="50"><italic><bold>r</bold></italic></th><th align="center" valign="top" charoff="50"><italic><bold>d</bold></italic><sub><bold>m</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>d</bold></italic><sub><bold>p</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>m</bold></italic><sub><bold>1</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>m</bold></italic><sub><bold>2</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>p</bold></italic><sub><bold>1</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>p</bold></italic><sub><bold>2</bold></sub></th></tr></thead><tbody valign="top"><tr><td align="left" valign="top" charoff="50">Exact</td><td align="center" valign="top" charoff="50">0.3</td><td align="center" valign="top" charoff="50">0.1</td><td align="center" valign="top" charoff="50">0.1</td><td align="center" valign="top" charoff="50">20</td><td align="center" valign="top" charoff="50">0.5</td><td align="center" valign="top" charoff="50">20</td><td align="center" valign="top" charoff="50">0.2</td></tr><tr><td align="left" valign="top" charoff="50">Inferred</td><td align="center" valign="top" charoff="50">0.31 (0.06)</td><td align="center" valign="top" charoff="50">0.12 (0.08)</td><td align="center" valign="top" charoff="50">0.14 (0.06)</td><td align="center" valign="top" charoff="50">23 (12)</td><td align="center" valign="top" charoff="50">0.51 (0.4)</td><td align="center" valign="top" charoff="50">26 (18)</td><td align="center" valign="top" charoff="50">0.25 (0.1)</td></tr></tbody></table><table-wrap-foot><fn id="t1-fn1"><p>The table shows the inferred parameter values for the gene expression system illustrated in <xref ref-type="fig" rid="f2">Fig. 2</xref>, with reactions in <xref ref-type="disp-formula" rid="eq32">equations (7)</xref> and <xref ref-type="disp-formula" rid="eq33">(8)</xref>. We assume the measurements of the protein, while the mRNA is unobserved. The inference is carried out by maximizing the likelihood of simulated data for 30 measurement points separated by &#x00394;<italic>t</italic>=0.5. This procedure is carried out for 100 simulated data sets and the mean value and s.d. (in parenthesis) of the inferred results are displayed.</p></fn></table-wrap-foot></table-wrap><table-wrap position="float" id="t2"><label>Table 2</label><caption><title>Inference results for gene expression system with additional autocatalytic reaction.</title></caption><table frame="hsides" rules="groups" border="1"><colgroup><col align="left"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/></colgroup><thead valign="bottom"><tr><th align="left" valign="top" charoff="50">&#x000a0;</th><th align="center" valign="top" charoff="50"><italic><bold>r</bold></italic></th><th align="center" valign="top" charoff="50"><italic><bold>d</bold></italic><sub><bold>m</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>d</bold></italic><sub><bold>p</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>m</bold></italic><sub><bold>1</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>m</bold></italic><sub><bold>2</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>p</bold></italic><sub><bold>1</bold></sub></th><th align="center" valign="top" charoff="50"><italic><bold>p</bold></italic><sub><bold>2</bold></sub></th></tr></thead><tbody valign="top"><tr><td align="left" valign="top" charoff="50">Exact</td><td align="center" valign="top" charoff="50">0.3</td><td align="center" valign="top" charoff="50">0.1</td><td align="center" valign="top" charoff="50">0.1</td><td align="center" valign="top" charoff="50">20</td><td align="center" valign="top" charoff="50">0.5</td><td align="center" valign="top" charoff="50">20</td><td align="center" valign="top" charoff="50">0.2</td></tr><tr><td align="left" valign="top" charoff="50">Inferred</td><td align="center" valign="top" charoff="50">0.30 (0.05)</td><td align="center" valign="top" charoff="50">0.14 (0.08)</td><td align="center" valign="top" charoff="50">0.088 (0.03)</td><td align="center" valign="top" charoff="50">27 (17)</td><td align="center" valign="top" charoff="50">0.57 (0.3)</td><td align="center" valign="top" charoff="50">24 (21)</td><td align="center" valign="top" charoff="50">0.19 (0.08)</td></tr></tbody></table><table-wrap-foot><fn id="t2-fn1"><p>The table shows the inferred parameter values for the gene expression system illustrated in <xref ref-type="fig" rid="f2">Fig. 2</xref>, with reactions in <xref ref-type="disp-formula" rid="eq32">equations (7)</xref> and <xref ref-type="disp-formula" rid="eq33">(8)</xref>, and the additional autocatalytic reaction in <xref ref-type="disp-formula" rid="eq34">equation (9)</xref>. Since, only the difference <italic>p</italic><sub>2</sub>&#x02212;<italic>p</italic><sub>3</sub> is identifiable, we fix <italic>p</italic><sub>3</sub>=0.01 and infer the other seven parameters. The table shows the average and s.d. (in parenthesis) of the inference results for 100 simulated data set.</p></fn></table-wrap-foot></table-wrap><table-wrap position="float" id="t3"><label>Table 3</label><caption><title>Inference results for SIRS system.</title></caption><table frame="hsides" rules="groups" border="1"><colgroup><col align="left"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/></colgroup><thead valign="bottom"><tr><th align="left" valign="top" charoff="50">&#x000a0;</th><th align="center" valign="top" charoff="50"><bold>10</bold><sup><bold>3</bold></sup><bold>&#x000d7; d</bold></th><th align="center" valign="top" charoff="50"><bold>10 &#x000d7; r</bold></th><th align="center" valign="top" charoff="50"><bold>10 &#x000d7; s</bold></th><th align="center" valign="top" charoff="50"><bold>10</bold><sup><bold>3</bold></sup><bold>&#x000d7;</bold><italic><bold>k</bold></italic><sup><bold>PR</bold></sup></th><th align="center" valign="top" charoff="50"><bold>k</bold></th><th align="center" valign="top" charoff="50"><bold>w</bold></th><th align="center" valign="top" charoff="50"><italic><bold>S</bold></italic><sub><bold>ini</bold></sub></th></tr></thead><tbody valign="top"><tr><td align="left" valign="top" charoff="50">Exact</td><td align="center" valign="top" charoff="50">1</td><td align="center" valign="top" charoff="50">0.2</td><td align="center" valign="top" charoff="50">2</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">100</td><td align="center" valign="top" charoff="50">0.01</td><td align="center" valign="top" charoff="50">200</td></tr><tr><td align="left" valign="top" charoff="50">Inferred</td><td align="center" valign="top" charoff="50">0.8 (0.3)</td><td align="center" valign="top" charoff="50">0.19 (0.09)</td><td align="center" valign="top" charoff="50">1.8 (1.2)</td><td align="center" valign="top" charoff="50">2.5 (0.5)</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr><tr><td align="left" valign="top" charoff="50">Exact</td><td align="center" valign="top" charoff="50">1</td><td align="center" valign="top" charoff="50">0.2</td><td align="center" valign="top" charoff="50">2</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">100</td><td align="center" valign="top" charoff="50">0.01</td><td align="center" valign="top" charoff="50">300</td></tr><tr><td align="left" valign="top" charoff="50">Inferred</td><td align="center" valign="top" charoff="50">0.9 (0.4)</td><td align="center" valign="top" charoff="50">0.15 (0.06)</td><td align="center" valign="top" charoff="50">1.4 (0.9)</td><td align="center" valign="top" charoff="50">2.4 (0.5)</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr><tr><td align="left" valign="top" charoff="50">Exact</td><td align="center" valign="top" charoff="50">1</td><td align="center" valign="top" charoff="50">2</td><td align="center" valign="top" charoff="50">2</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">100</td><td align="center" valign="top" charoff="50">0.02</td><td align="center" valign="top" charoff="50">200</td></tr><tr><td align="left" valign="top" charoff="50">Inferred</td><td align="center" valign="top" charoff="50">1.0 (0.6)</td><td align="center" valign="top" charoff="50">1.6 (0.7)</td><td align="center" valign="top" charoff="50">1.5 (1.0)</td><td align="center" valign="top" charoff="50">3.4 (1.1)</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr><tr><td align="left" valign="top" charoff="50">Exact</td><td align="center" valign="top" charoff="50">1</td><td align="center" valign="top" charoff="50">0.2</td><td align="center" valign="top" charoff="50">2</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">1000</td><td align="center" valign="top" charoff="50">0.005</td><td align="center" valign="top" charoff="50">200</td></tr><tr><td align="left" valign="top" charoff="50">Inferred</td><td align="center" valign="top" charoff="50">0.8 (0.4)</td><td align="center" valign="top" charoff="50">0.21 (0.11)</td><td align="center" valign="top" charoff="50">2.2 (1.6)</td><td align="center" valign="top" charoff="50">2.4 (0.5)</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr><tr><td align="left" valign="top" charoff="50">Exact</td><td align="center" valign="top" charoff="50">2</td><td align="center" valign="top" charoff="50">0.2</td><td align="center" valign="top" charoff="50">2</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">100</td><td align="center" valign="top" charoff="50">0.01</td><td align="center" valign="top" charoff="50">100</td></tr><tr><td align="left" valign="top" charoff="50">Inferred</td><td align="center" valign="top" charoff="50">1.6 (0.8)</td><td align="center" valign="top" charoff="50">0.19 (0.09)</td><td align="center" valign="top" charoff="50">1.9 (1.2)</td><td align="center" valign="top" charoff="50">4.6 (1.1)</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x02014;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr></tbody></table><table-wrap-foot><fn id="t3-fn1"><p>The table shows the results for parameter inference for the SIRS system, with reactions given in <xref ref-type="disp-formula" rid="eq35">equation (10)</xref>. The inference is carried out by maximizing the likelihood of the simulated data for 40 measurement points. This procedure is carried out for 200 simulated data sets, and the mean value and s.d. (in parenthesis) of the inferred results are displayed.</p></fn></table-wrap-foot></table-wrap></floats-group></article>