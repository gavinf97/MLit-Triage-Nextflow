<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nat Commun</journal-id><journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id><journal-title-group><journal-title>Nature Communications</journal-title></journal-title-group><issn pub-type="epub">2041-1723</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">8225676</article-id><article-id pub-id-type="publisher-id">24150</article-id><article-id pub-id-type="doi">10.1038/s41467-021-24150-4</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Bioactivity descriptors for uncharacterized chemical compounds</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0720-1027</contrib-id><name><surname>Bertoni</surname><given-names>Martino</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9906-6936</contrib-id><name><surname>Duran-Frigola</surname><given-names>Miquel</given-names></name><address><email>miquel@ersilia.io</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1004-3923</contrib-id><name><surname>Badia-i-Mompel</surname><given-names>Pau</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Pauls</surname><given-names>Eduardo</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Orozco-Ruiz</surname><given-names>Modesto</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Guitart-Pla</surname><given-names>Oriol</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Alcalde</surname><given-names>V&#x000ed;ctor</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8561-7576</contrib-id><name><surname>Diaz</surname><given-names>V&#x000ed;ctor M.</given-names></name><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3742-8161</contrib-id><name><surname>Berenguer-Llergo</surname><given-names>Antoni</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5828-0020</contrib-id><name><surname>Brun-Heath</surname><given-names>Isabelle</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9323-0697</contrib-id><name><surname>Villegas</surname><given-names>N&#x000fa;ria</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>de Herreros</surname><given-names>Antonio Garc&#x000ed;a</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3557-0236</contrib-id><name><surname>Aloy</surname><given-names>Patrick</given-names></name><address><email>patrick.aloy@irbbarcelona.org</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff5">5</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.473715.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 6475 7299</institution-id><institution>Joint IRB-BSC-CRG Programme in Computational Biology, Institute for Research in Biomedicine (IRB Barcelona), </institution><institution>The Barcelona Institute of Science and Technology, </institution></institution-wrap>Barcelona, Catalonia Spain </aff><aff id="Aff2"><label>2</label>Ersilia Open Source Initiative, Cambridge, UK </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5612.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2172 2676</institution-id><institution>Programa de Recerca en C&#x000e0;ncer, Institut Hospital del Mar d&#x02019;Investigacions M&#x000e8;diques (IMIM) and Departament de Ci&#x000e8;ncies de la Salut, </institution><institution>Universitat Pompeu Fabra (UPF), </institution></institution-wrap>Barcelona, Catalonia Spain </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.410675.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2325 3084</institution-id><institution>Faculty of Medicine and Health Sciences, </institution><institution>International University of Catalonia, </institution></institution-wrap>Barcelona, Catalonia Spain </aff><aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.425902.8</institution-id><institution-id institution-id-type="ISNI">0000 0000 9601 989X</institution-id><institution>Instituci&#x000f3; Catalana de Recerca i Estudis Avan&#x000e7;ats (ICREA), </institution></institution-wrap>Barcelona, Catalonia Spain </aff></contrib-group><pub-date pub-type="epub"><day>24</day><month>6</month><year>2021</year></pub-date><pub-date pub-type="pmc-release"><day>24</day><month>6</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>12</volume><elocation-id>3932</elocation-id><history><date date-type="received"><day>25</day><month>9</month><year>2020</year></date><date date-type="accepted"><day>27</day><month>5</month><year>2021</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2021</copyright-statement><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Chemical descriptors encode the physicochemical and structural properties of small molecules, and they are at the core of chemoinformatics. The broad release of bioactivity data has prompted enriched representations of compounds, reaching beyond chemical structures and capturing their known biological properties. Unfortunately, bioactivity descriptors are not available for most small molecules, which limits their applicability to a few thousand well characterized compounds. Here we present a collection of deep neural networks able to infer bioactivity signatures for any compound of interest, even when little or no experimental information is available for them. Our signaturizers relate to bioactivities of 25 different types (including target profiles, cellular response and clinical outcomes) and can be used as drop-in replacements for chemical descriptors in day-to-day chemoinformatics tasks. Indeed, we illustrate how inferred bioactivity signatures are useful to navigate the chemical space in a biologically relevant manner, unveiling higher-order organization in natural product collections, and to enrich mostly uncharacterized chemical libraries for activity against the drug-orphan target Snail1. Moreover, we implement a battery of signature-activity relationship (SigAR) models and show a substantial improvement in performance, with respect to chemistry-based classifiers, across a series of biophysics and physiology activity prediction benchmarks.</p></abstract><abstract id="Abs2" abstract-type="web-summary"><p id="Par2">Small molecules bioactivity descriptors are enriched representations of compounds, reaching beyond chemical structures and capturing their known biological properties. Here the authors present a collection of deep neural networks able to infer bioactivity signatures for any compound of interest, even when little or no experimental information is available for them.</p></abstract><kwd-group kwd-group-type="npg-subject"><title>Subject terms</title><kwd>Cheminformatics</kwd><kwd>Networks and systems biology</kwd><kwd>Machine learning</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/100011199</institution-id><institution>EC | EC Seventh Framework Programm | FP7 Ideas: European Research Council (FP7-IDEAS-ERC - Specific Programme: "Ideas" Implementing the Seventh Framework Programme of the European Community for Research, Technological Development and Demonstration Activities (2007 to 2013))</institution></institution-wrap></funding-source><award-id>614944</award-id><principal-award-recipient><name><surname>Aloy</surname><given-names>Patrick</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000780</institution-id><institution>European Commission (EC)</institution></institution-wrap></funding-source><award-id>101003633</award-id><principal-award-recipient><name><surname>Aloy</surname><given-names>Patrick</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100003329</institution-id><institution>Ministerio de Econom&#x000ed;a y Competitividad (Ministry of Economy and Competitiveness)</institution></institution-wrap></funding-source><award-id>BIO2016-77038-R</award-id><principal-award-recipient><name><surname>Aloy</surname><given-names>Patrick</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100002809</institution-id><institution>Generalitat de Catalunya (Government of Catalonia)</institution></institution-wrap></funding-source><award-id>001-P-001682; 001-P-001647</award-id><principal-award-recipient><name><surname>Aloy</surname><given-names>Patrick</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2021</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par3">Most of the chemical space remains uncharted and identifying its regions of biological relevance is key to medicinal chemistry and chemical biology<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. To explore and catalog this vast space, scientists have invented a variety of chemical descriptors, which encode physicochemical and structural properties of small molecules. Molecular fingerprints are a widespread form of descriptors consisting of&#x000a0;binary (1/0) vectors describing the presence or absence of certain molecular substructures. These encodings are at the core of chemoinformatics and are fundamental in compound similarity searches and&#x000a0;clustering, and are&#x000a0;applied to computational drug discovery (CDD), structure optimization, and target prediction.</p><p id="Par4">The corpus of bioactivity records available suggests that other numerical representations of molecules are possible, reaching beyond chemical structures and capturing their known biological properties. Indeed, it has been shown that an enriched representation of molecules can be achieved through the use of bioactivity signatures<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Bioactivity signatures are multi-dimensional vectors that capture the biological traits of the molecule in a format that is akin to the structural descriptors or fingerprints used in the field of chemoinformatics. The first attempts to develop biological descriptors for chemical compounds encapsulated ligand-binding affinities<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, and fingerprints describing the target profile of small molecules unveiled many unanticipated and physiologically relevant associations<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Currently, public databases contain experimentally determined bioactivity data for about a million molecules, which represent only a small percentage of commercially available compounds<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> and a negligible fraction of the&#x000a0;synthetically accessible chemical space<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. In practical terms, this means bioactivity signatures cannot be derived for most compounds, and CDD methods are limited to using chemical information alone as a primary input, thereby hindering their performance and not fully exploiting the bioactivity knowledge produced over the years by the scientific community.</p><p id="Par5">Recently, we integrated the major chemogenomics and drug databases in a single resource named the Chemical Checker (CC), which is the largest collection of small-molecule bioactivity signatures available to date<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. In the CC, bioactivity signatures are organized by data type (ligand-receptor binding, cell sensitivity profiles, toxicology, etc.), following a chemistry-to-clinics rationale that facilitates the selection of relevant signature classes at each step of the drug discovery pipeline. In essence, the CC is an alternative representation of the small-molecule knowledge deposited in the public domain and, as such, it is also limited by the availability of experimental data and the coverage of its source databases (e.g., ChEMBL<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> or DrugBank<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>). Thus, the CC is most useful when a substantial amount of bioactivity information is available for the molecules and remains of limited value for poorly characterized compounds<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. In the current study, we present a methodology to infer CC bioactivity signatures for any compound of interest, based on the observation that the different bioactivity spaces are not completely independent, and thus similarities of a given bioactivity type (e.g., targets) can be transferred to other data kinds (e.g., therapeutic indications). Overall, we make bioactivity signatures available for any given compound, assigning confidence to our predictions and illustrating how they can be used to navigate the chemical space in an efficient, biologically relevant manner. Moreover, we explore their added value in the identification of hit compounds against the drug-orphan target Snail1 in a mostly uncharacterized compound library, and through the implementation of a battery of signature&#x02013;activity relationship (SigAR) models to predict biophysical and physiological properties of molecules.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><p id="Par6">The current version of the CC is organized into 5 levels of complexity (A: Chemistry, B: Targets, C: Networks, D: Cells, and E: Clinics), each of which is divided into 5 sublevels (1&#x02013;5). In total, the CC is composed of 25 spaces capturing the 2D/3D structures of the molecules, targets and metabolic genes, network properties of the targets, cell response profiles, drug indications, and side effects, among others (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref>). In the CC, each molecule is annotated with multiple n-dimensional vectors (i.e., bioactivity signatures) corresponding to the spaces where experimental information is available. As a result, chemistry (A) signatures are widely available (~10<sup>6</sup> compounds), whereas cell-based assays (D) cover about 30,000 molecules, and clinical (E) signatures are known for only a few thousand drugs (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>). We thus sought to infer missing signatures for any compound in the CC, based on the observation that the different bioactivity spaces are not completely independent and can be correlated.<fig id="Fig1"><label>Fig. 1</label><caption><title>Training and evaluation of CC signaturizers.</title><p><bold>a</bold> Scheme of the methodology. Signaturizers produce bioactivity signatures that fill the gaps in the experimental version of the CC. A SNN is trained using a signature-dropout scheme over 10<sup>7</sup> triplets of molecules (anchor, positive, negative) to infer missing signatures in each bioactivity space. The inferred signatures are finally evaluated. <bold>b</bold> Coverage of the experimental version of the CC. The bar plot indicates the number of molecules available for each CC data type. The heatmap shows the cross-coverage between data sets, i.e., it is a 25&#x02009;&#x000d7;&#x02009;25 matrix capturing the proportion of molecules in one data set (rows) that are also available in other data sets (columns) <bold>c</bold> Accuracy of the 25 signaturizers, measured as the proportion of correctly classified cases within a triplet. Train&#x02013;test refers to the case where the anchor molecule belongs to the test set, and the positive and negative molecules belong to the training set. Test&#x02013;test corresponds to the most difficult case where none of the three molecules within the triplet has been utilized during the training. <bold>d</bold> Performance of the 25 signaturizers, measured for each molecule as the correlation between the true and predicted signatures along the 128 dimensions. Given the bimodal distribution of signature values, signatures are binarized (positive/negative) and correlation is measured as a Matthew&#x02019;s correlation coefficient (MCC) over the true-vs-predicted contingency table. <bold>e</bold> Three exemplary molecules (<bold>1</bold>, <bold>2</bold>, and <bold>3</bold>) are shown for the D1 and E3 spaces. True and predicted signatures are displayed as color bars, both sorted according to true signature values. <bold>f</bold> Correspondingly, t-SNE 2D projections of D1 and E3 predictions, where <bold>1</bold>, <bold>2</bold>, and <bold>3</bold> are highlighted, the intensity level describes the density of molecules in the 2D space going from dark red (low density) to white (high density). <bold>g</bold> 2D-projected train (gray) and test (colored) samples for the 25 CC spaces. The legend at the bottom specifies the A1-E5 organization of the CC.</p></caption><graphic xlink:href="41467_2021_24150_Fig1_HTML" id="d32e473"/></fig></p><p id="Par7">Bioactivity signatures must be amenable to similarity calculations, ideally by conventional metrics such as cosine or Euclidean distances, so that short distances between molecule signatures reflect a similar biological behavior. Therefore, inference of bioactivity signatures can be posed as a metric learning problem where observed compound&#x02013;compound similarities of a given kind are correlated to the full repertoire of CC signatures, so that similarity measures are possible for any compound of interest, including those that are not annotated with experimental data. In practice, for each CC space (S<sub><italic>i</italic></sub>), we tackle the metric learning problem with a so-called Siamese Neural Network (SNN), having as input a stacked array of CC signatures available for the compound (belonging to any of the A1&#x02013;E5 layers, S<sub>1</sub>&#x02013;S<sub>25</sub>) and as output, an <italic>n</italic>-dimensional embedding optimized to discern between similar and dissimilar molecules in S<sub><italic>i</italic></sub>. More specifically, we feed the SNN with triplets of molecules (an anchor molecule, one that is similar to the anchor (positive) and one that is not (negative)), and we ask the SNN to correctly classify this pattern with a distance measurement performed in the embedding space (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1a</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). We trained 25 such SNNs, corresponding to the 25 spaces available in the CC. We used 10<sup>7</sup> molecule triplets and chose an SNN embedding dimension of 128 for all CC spaces, scaling it to the norm so as to unify the distance magnitude across SNNs (see &#x0201c;Methods&#x0201d; section for details). As a result of this procedure, we obtained 25 SNN &#x02018;signaturizers&#x02019; (S<sub>1&#x02013;25</sub>), each of them devoted to one of the CC spaces (S<sub><italic>i</italic></sub>). A signaturizer takes as input the subset of CC signatures available for a molecule and produces a 128D signature that, in principle, captures the similarity profile of the molecule in the S<sub><italic>i</italic></sub> CC space, where experimental information may not be available for the compound.</p><p id="Par8">To handle the acute incompleteness of experimental signatures accessible for training the SNNs (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1b</xref>), we devised a signature-dropout sampling scheme that simulates a realistic prediction scenario where, depending on the CC space of interest (S<sub><italic>i</italic></sub>), signatures from certain spaces will be available while others may not. For example, in the CC, biological pathway signatures (C3) are directly derived from binding signatures (B4), thus implying that, in a real B4 prediction case, C3 will never serve as a covariate. In practice, signature sampling probabilities for each CC space S<sub><italic>i</italic></sub> were determined from the coverage of S<sub>1</sub>&#x02013;S<sub>25</sub> signatures of molecules lacking an experimental S<sub><italic>i</italic></sub> signature. Overall, chemical information (A1&#x02013;5), as well as signatures from large chemogenomics databases (e.g., B4-5), could be used throughout (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">2</xref>). Signatures related to the subset of drug molecules (e.g., Mode of Action (MoA): B1, indications: E2, side-effects: E3, etc.) were mutually inclusive; however, they were more frequently dropped out in order to extend the applicability of signaturizers beyond the relatively narrow space of known drugs.</p><p id="Par9">We evaluated the performance of a signaturizer S<sub><italic>i</italic></sub> in an 80:20 train&#x02013;test split both (a) as its ability to classify similar and dissimilar compound pairs within the triplets (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1c</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">3</xref>), and (b) as the correlation observed between each predicted signature (i.e., obtained without using S<sub><italic>i</italic></sub> as part of the input (S<sub>1</sub>&#x02013;S<sub>25</sub>)) and, correspondingly, a truth signature produced using only S<sub><italic>i</italic></sub>. In the &#x0201c;Methods&#x0201d; section, we further explain these two metrics, as well as the splitting and signature-dropout methods that are key to obtain valid performance estimates. In general, as expected, chemistry (A) signaturizers performed almost perfect (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1c</xref>). The A-level signatures are of little added value, since chemical information is always available for compounds; however, we see that the inferred signatures cannot only faithfully reproduce the original CC signatures but also recapitulate the similarity information captured by the much longer extended connectivity fingerprints (ECFP4; Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">4</xref>). At the targets levels (B), the performance of the signaturizers was high for large-scale binding data B4, while accuracy was variable at deeper annotation levels where the number of compounds available for training was smaller (e.g., MoA (B1) or for drug-metabolizing enzymes (B2)) (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1d</xref>). Performance at the networks level (C) was high, as this level is directly informed by the underlying targets (B) level. Not surprisingly, the most challenging models were those related to cell-based (D) and clinical (E) data, probably due to the inherent complexity of these data with respect to the number of annotated molecules. On average, the accuracy of cell-based signaturizers was moderate (~0.7) and true-vs-predicted correlation of clinical signatures such as therapeutic classes (Anatomical Therapeutic Chemical, ATC; E1) was variable across molecules. The performance of SNNs varied depending on the CC space and molecule of interest, with signatures being well predicted in all spaces. Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1e</xref> and&#x000a0;f illustrate this observation for three drugs (namely perphenazine (<bold>1</bold>), acebutolol (<bold>2</bold>), and perhexiline (<bold>3</bold>)), which have predicted signatures of variable quality in the transcriptional (D1) and side-effects (E3) spaces. Overall, bioactivity maps were well covered by test-set molecules, indicating that our SNNs are unbiased and able to generate predictions that are spread throughout the complete bioactivity landscape (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1g</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">5</xref>).</p><sec id="Sec3"><title>Large-scale inference of bioactivity signatures</title><p id="Par10">Having trained and validated the signaturizers, we massively inferred missing signatures for the ~800,000 molecules available in the CC, obtaining a complete set of 25&#x02009;&#x000d7;&#x02009;128-dimensional signatures for each molecule (<ext-link ext-link-type="uri" xlink:href="https://chemicalchecker.org/downloads">https://chemicalchecker.org/downloads</ext-link>). To explore the reliability of the inferred signatures, we assigned an applicability score (<italic>&#x003b1;</italic>) to predictions based on the following: (a) the proximity of a predicted signature to true (experimental) signatures available in the training set; (b) the robustness of the SNN output to a test-time data dropout<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>; and (c) the accuracy expected a priori based on the experimental CC data sets available for the molecule (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>). A deeper explanation of this score can be found in the &#x0201c;Methods&#x0201d; section, along with Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">6</xref> showing the relative contribution of a, b, and c factors to the value of <italic>&#x003b1;</italic>. In a similarity search exercise, we found that <italic>&#x003b1;</italic> scores &#x02265;0.5 retrieved a significant number of true hits (odds-ratios &#x0003e; 8, <italic>P</italic>-values&#x02009;&#x0003c;&#x02009;1.7&#x000b7;10<sup>&#x02212;21</sup> (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">7</xref>)). This observation shows that, even for modest-quality CC spaces such as D1 (transcription), the number of signatures available can be substantially increased by our method (in this case from 11,638 molecules covered in the experimental version of the CC to 69,532 (498% increase) when SNN predictions are included (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">8</xref>)). Moreover, low- and high-<italic>&#x003b1;</italic> areas of the signature landscape can be easily delimited, indicating the presence of reliable regions in the prediction space (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Large-scale bioactivity prediction using the signaturizers (~800k molecules).</title><p><bold>a</bold> Features combined to derive the applicability scores (<italic>&#x003b1;</italic>). <bold>b</bold> Applicability scores for the predictions, displayed across the 25 (A1-E5) 2D-projected signature maps. A grid was defined on the 2D coordinates, molecules were binned and the average <italic>&#x003b1;</italic> is plotted in a red (low) to blue (high) color scale. <bold>c</bold> Cross-correlation between CC spaces, defined as the capacity of similarities measured in S<sub><italic>i</italic></sub> (rows) to recall the top-5 nearest neighbors in <italic>S</italic><sub><italic>j</italic></sub> (columns) (ROC-AUC), the color scale goes from red to blue indicating low to high cross-correlation (also reported as dot size). Top 10k molecules (sorted by <italic>&#x003b1;</italic>) were chosen as <italic>S</italic><sub><italic>i</italic></sub>. <bold>d</bold> Scheme of the signature stacking procedure. Signatures can be stacked horizontally to obtain a global signature (GSig) of 3200 dimensions. <bold>e</bold> Ability of similarity measures performed in the GSig space to identify pairs of molecules sharing the Mode of action (MoA left) or therapeutic classes (ATC code right) (ROC-AUC). <bold>f</bold> Likewise, the ability of GSigs to identify the nearest neighbors found in the experimental (original) versions of the A1-E5 data sets. <bold>g</bold> t-SNE 2D projection of GSigs. The 10k molecules with the highest average <italic>&#x003b1;</italic> across the 25 signatures are displayed. The cool-warm color scale represents chemical diversity, red meaning that molecules in the neighborhood are structurally similar (Tanimoto MFp similarity between the molecule in question and their 5-nearest neighbors). A subset of representative clusters is annotated with enriched binding activities. <bold>h</bold> Example of a cluster enriched in heat shock protein 90 inhibitors (HSP90AA1) with highlighted representative molecules with distinct (<bold>4</bold>) or chemically related (<bold>5</bold>) neighbors in the cluster.</p></caption><graphic xlink:href="41467_2021_24150_Fig2_HTML" id="d32e714"/></fig></p><p id="Par11">The 5&#x02009;&#x000d7;&#x02009;5 organization of the CC (A1&#x02013;E5) was designed to capture distinct aspects of the chemistry and biology of compounds, and a systematic assessment of the original (experimental) resource revealed partial correlations between the 25 data types<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The original pattern of correlations was preserved among inferred signatures, especially for the high-<italic>&#x003b1;</italic> ones (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">9</xref>), thereby suggesting that the data integration performed by the SNNs conserves the genuine information contained within each data type, and implying that signatures can be stacked to provide non-redundant, information-rich representations of the molecules. For example, the 25 CC spaces can be concatenated horizontally to obtain a global signature (GSig) of 3200 dimensions (25&#x02009;&#x000d7;&#x02009;128D), encapsulating in a unique signature all the bioactivities assigned to a molecule (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2d</xref>). Similarity measures performed in the GSig space up-rank pairs of compounds with the same MoA or ATC code (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2e</xref>) and have an overall correlation with the rest of experimental data available from the CC, capturing not only chemical similarities between molecules but also common target profiles, clinical characteristics and, to a lesser degree, cell-based assay read-outs (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2f</xref>).</p><p id="Par12">Indeed, as shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2g</xref>, a 2D projection of GSigs reveals clusters of molecules with specific biological traits. Of note, some of the clusters group molecules with similar chemistries (e.g., ESR1,2 ligands), while others correspond to sets of diverse compounds (e.g., MAPK8,9,10 inhibitors). Most of the clusters have a mixed composition, containing subgroups of chemically related compounds while also including distinct molecules, as is the case for the HSP90AA1-associated cluster, of which compounds <bold>4</bold> and <bold>5</bold> are good representatives (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2h</xref>).</p></sec><sec id="Sec4"><title>Bioactivity-guided navigation of the chemical space</title><p id="Par13">Taken together, CC signatures offer a novel bioactivity-driven means to organize chemical space, with the potential to unveil higher levels of organization that may not be apparent in the light of chemical information alone. In Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3a</xref>, we analyze a diverse set of over 30 compound collections, ranging from species-specific metabolomes to purchasable building-block (BB) libraries. To expose the regions of the global bioactivity space covered by these collections, we first performed a large-scale GSig-clustering on the full CC. We then calculated GSigs for each compound in each library and mapped them to the CC clusters, thereby obtaining a specific cluster occupancy vector for each collection. Finally, we used these vectors to hierarchically group all the compound libraries. As can be seen, drug-related libraries (e.g., IUPHAR and IDG) had similar occupancy vectors to the reference CC library, meaning they were evenly distributed in the bioactivity space, which is expected given the over-representation of medicinal chemistry in our resource. Libraries containing BBs from different providers (ChemDiv, Sigma-Aldrich, and ChemBridge) were grouped together, although with an uneven representativity of the CC bioactivity space. Similar trends were observed for species-specific metabolomes (Yeast, <italic>E. coli</italic>, and Human (HMDB)) and natural products collected from various sources (Traditional Chinese Medicines (TCM), African substances (AfroDb), or food ingredients (FooDB)).<fig id="Fig3"><label>Fig. 3</label><caption><title>Signature-based analysis of compound collections.</title><p><bold>a</bold> Chemical libraries are hierarchically clustered by their proximity to the full CC; here, proximity is determined by the cluster occupancy vector relative to the k-means clusters identified in the CC collection (number of clusters&#x02009;=&#x02009;(<italic>N</italic>/2)<sup>1/2</sup>; GSigs are used). Proximal libraries have small Euclidean distances between their normalized occupancy vectors. Size of the circles is proportional to the number of molecules available in the collection. Color (blue-to-red) indicates the homogeneity (Gini coefficient) of the occupancy vectors relative to the CC. <bold>b</bold> Occupancy of high-applicability regions is further analyzed for five collections (plus the full CC). In particular, we measure the average 10-nearest-neighbor L2-distance (measured in the GSig space) of molecules to the high-<italic>&#x003b1;</italic> subset of CC molecules (10<sup>3</sup>, Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>). The red line denotes the distance corresponding to an empirical similarity <italic>P</italic>-value of 0.01. The percentage indicates the number of molecules in the collection having high-<italic>&#x003b1;</italic> vicinities that are, on average, below the significance threshold. This percentage is shown for the rest of the libraries in <bold>a</bold>. <bold>c</bold> The previous five compound collections are merged and projected together (t-SNE). Each of them is highlighted in a different color with darker color indicating a higher density of molecules. <bold>d</bold> Detail of the compound collections. The first column shows the chemical diversity of the projections, measured as the average Tanimoto similarity of the 5-nearest neighbors. Blue denotes high diversity and red high structural similarity between neighboring compounds. Coloring is done on a per-cluster basis. The rest of the columns focus on annotated subsets of molecules. Blue indicates high-density regions.</p></caption><graphic xlink:href="41467_2021_24150_Fig3_HTML" id="d32e811"/></fig></p><p id="Par14">To gain a better understanding of the bioactivity areas encompassed by each collection, we chose five examples related to drug molecules, metabolomes, and natural product extracts. More specifically, we considered 6505 approved and experimental drugs (REPO Hub)<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, 8603 endogenous human metabolites (HMDB)<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, 6355 metabolites found in other species beyond vertebrates (MetaboLights)<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, 49,818 food constituents (FooDB; <ext-link ext-link-type="uri" xlink:href="http://www.foodb.ca">www.foodb.ca</ext-link>) and 6502 plant chemicals (CMAUP)<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3b</xref> shows that, despite their variable depth of annotation (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">10</xref>), these collections, for the most part, are laid out in high-<italic>&#x003b1;</italic> regions of the GSig space. Moreover, Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3c</xref> offers a comparative view of the bioactivity areas occupied by each collection, with some overlapping regions as expected, especially between natural product collections. The map reveals a region that is specific to drug molecules, possibly belonging to a set of bioactivities that is outside the reach of natural metabolites.</p><p id="Par15">A deeper dive reveals further structure in the bioactivity maps. For example, when we focus on drug molecules (REPO Hub), broad therapeutic areas such as infectious diseases, neurology/psychiatry, cardiology, and oncology can be circumscribed within certain regions of the GSig landscape (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3d</xref>), and the same applies to finer-grained disease categories (indications) and mechanisms of action (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11</xref>). Thus, the chemistry-to-clinics scope of GSigs provides a multi-level view of the chemical space, clustering compounds first on the basis of their targets and, in turn, keeping targets close in space if they belong to the same disease area. This is exemplified by PI3K, CDK, and VEGFR inhibitors, which have their own well-defined clusters within the oncology region of the map, and by histamine receptor antagonists and acetylcholine receptor agonists, which are placed together in an area assigned to neurology/psychiatry (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3d</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">11</xref>).</p><p id="Par16">Analogous observations can be made beyond the well-annotated universe of drug molecules, consistently organizing the chemical space in relevant ways. For example, the HMDB map highlights tissue- and biofluid-specific regions with varying degrees of chemical diversity (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3d</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">12</xref>), and the MetaboLights cross-species metabolome database is well organized by taxonomy (e.g., Chordata, Ascomycota, Actinobacteria), revealing conserved metabolite regions as well as species-specific ones (in general, we found the former to be less chemically diverse (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">12</xref>)). Likewise, plants can be organized in families and species by means of their ingredient signatures, as exemplified in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3d</xref> for three <italic>Lamiaceae</italic> and two <italic>Apiaceae</italic> species. Finally, the map of food ingredients displays clear bioactivity clusters of food chemicals, adding to recent work suggesting that the food constituents landscape can be charted and exploited to identify links between diet and health<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>.</p></sec><sec id="Sec5"><title>Enriching chemical libraries for activity against Snail1</title><p id="Par17">After seeing that inferred CC signatures are indeed useful to characterize large natural product collections, we sought to assess whether they are also advantageous in combination with more classical chemo-centric approaches. To this end, we performed a computational assessment of two chemical libraries, namely the Prestwick collection (PWCK) and the IRB Barcelona proprietary library (IRB). The IRB library contains &#x0003e;17,000 compounds, only 3% of which have reported bioactivities and are thus included in the CC. This library was originally designed to inhibit t-RNA synthetases by means of ambivalent small molecules displaying ATP-like and amino acid-like chemotypes. The PWCK library is considerably smaller (&#x0003e;1,000 compounds), and it is composed of well-annotated molecules over a wide range of activities (&#x0003e;99% of the molecules are present in the CC). Thus, the IRB and PWCK libraries represent two typical scenarios: the recycling of a targeted library, and the use of a small diversity-oriented compound collection, respectively.</p><p id="Par18">We sought to enrich these libraries for activity against the product of <italic>SNAI1</italic> gene, Snail1, a zinc-finger transcription factor with an essential role in the epithelial-to-mesenchymal transition (EMT)<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. Being a transcription factor, Snail1 is almost undruggable<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, and we looked for indirect strategies to inhibit its function. In a previous siRNA screening, we found that the knock-down of certain deubiquitinases (DUBs) significantly decreased Snail1 levels, suggesting that DUBs promote Snail1 stabilization and are required for its effects on EMT and cancer progression<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>.</p><p id="Par19">We searched the literature for previous knowledge on DUB inhibition by small molecules<sup><xref ref-type="bibr" rid="CR21">21</xref>&#x02013;<xref ref-type="bibr" rid="CR23">23</xref></sup> and categorized DUBs on the basis of their performance in the siRNA-DUB/Snail1 screening assay (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>). We curated 45 DUB inhibitors, 6 of which were inhibitors of candidate DUBs in the siRNA-DUB/Snail1 assay. In parallel, we collected 5540 compound-DUB interactions available in the CC corresponding to 15 of the DUBs. Overall, this search yielded a substantial pool of chemical matter related to DUB inhibition (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>).</p><p id="Par20">In addition to DUBs, we considered other proteins with a well-established connection to Snail1 activity, including TGFBR1/2, ERK2, FBXL5/14, DDR2, and GSK3B<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. We collected perturbational (e.g., shRNA) expression signatures for the corresponding genes, together with the signatures of prominent DUBs found in the siRNA-DUB/Snail1 screen. In total, we retrieved 95 transcriptional signatures from the L1000 Connectivity Map and 18 from the Gene Expression Omnibus (GEO)<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> (see Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref> for the full list of signatures). Each signature was converted to the CC D1 format. Finally, we derived networks-level (C) signatures for the previous Snail1-related proteins by exploring their pathways (C3), biological processes (C4), and interactome neighborhoods (C5).</p><p id="Par21">We then devised a strategy to select a few hundred compounds enriched for activity against Snail1 from the IRB and PWCK libraries (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4a</xref>). On the one hand, we defined a chemical query to identify compounds that were (i) chemically similar (<italic>P</italic>&#x02009;&#x0003c;&#x02009;0.001) to well-curated DUB inhibitors, or to DUB inhibitors in a broader list (combined with binding data from chemogenomics resources). On the other hand, we designed two biological queries to capture connectivities between the biology of Snail1 and the bioactivity data available in the CC. In particular, we looked for (ii) compounds whose (putative) targets were functionally related to Snail1 (i.e., C3&#x02013;5 similarities to TGFBR1/2, ERK2, etc., <italic>P</italic>&#x02009;&#x0003c;&#x02009;0.001) but different from DUBs, and (iii) compounds whose gene expression pattern might mimic the transcriptional signatures of genetic KO perturbations of the above targets (i.e., D1 similarities, <italic>P</italic>&#x02009;&#x0003c;&#x02009;0.001). A detailed description of the queries is given in the &#x0201c;Methods&#x0201d; section.<fig id="Fig4"><label>Fig. 4</label><caption><title>Library enrichment to identify Snail1 inhibitors.</title><p><bold>a</bold> Scheme of the methodology. Two compound libraries are screened (IRB and PWCK). A chemical query is done by looking for similarities with known DUB inhibitors. A biological query is done by looking for transcriptional (D1) and network-based (C3&#x02013;5) signature matchings with Snail1-relevant targets. Random molecules are selected to estimate the background hit-rate. A Snail1 expression assay based on Firefly:Renilla luciferase ratios are used to screen candidate compounds. <bold>b</bold> Library enrichment quantification showing the effects of compounds selected by chemical (red), biological (blue), shared between both (magenta), and random (gray) queries, as well as the positive (PR-619) and negative (DMSO) controls. <bold>c</bold> Detail of the top 25 hit compounds. <bold>d</bold> Fold enrichment of compounds selected by chemical (red), biological (blue), and shared (magenta) queries with respect to random picks, based on their capacity to modulate Snail1 levels (Firefly:Renilla assay). Median&#x02009;&#x000b1;&#x02009;MAD (<italic>n</italic>&#x02009;=&#x02009;4). <bold>e</bold> MDA-MB-231 cells stably expressing luciferase constructs were treated for 6&#x02009;h with the indicated compounds, at different doses. Firefly:Renilla ratios were normalized with the corresponding concentration of vehicle (DMSO). Mean&#x02009;&#x000b1;&#x02009;SD of 2 independent experiments, each of them including 4 replicas, are shown.</p></caption><graphic xlink:href="41467_2021_24150_Fig4_HTML" id="d32e978"/></fig></p><p id="Par22">After inferring CC bioactivity signatures for all the ~20,000 compounds in our libraries, the chemical and biological queries detailed above retrieved 169 and 131 compounds, respectively, with 78 molecules being picked by both. Thus, overall, we selected 222 compounds from the three queries (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>); 131 from the IRB library and 91 to the PWCK collection. In addition, we selected 188 random compounds to be used as background, using the same library proportions. Selected compounds had comparable molecular weights and drug-like properties (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">13a</xref>). As expected, compounds identified by the chemical query are more similar to our reference set of 45 known DUB inhibitors than those retrieved by the biological queries (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">13b</xref>).</p><p id="Par23">To validate the capacity of these compounds to decrease Snail1 protein levels, we used a Snail1-Firefly-luciferase fusion protein stably expressed in MDA-MB-231 cells (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4a</xref>)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Figure&#x000a0;<xref rid="Fig4" ref-type="fig">4b</xref> shows the outcome of the Snail1-luciferase screening assay. As can be seen, 22 out of the 25 compounds displaying the strongest Snail1 down-regulation (including the two controls) came from chemical and biological queries. Importantly, a substantial number of hits (6 in the top 25) were candidate molecules selected by both biological and chemical queries, and an additional 3 compounds were retrieved only by biological queries (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">13c</xref>). It is important to note that these three compounds are chemically unrelated to any of the known DUB inhibitors, with Tanimoto similarities ranging from 0.13 to 0.32 (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>). Overall, our results highlight the added value of bioactivity signatures to complement chemical similarity searches (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4c</xref>). Certainly, considering as positive those molecules able to decrease 1.5 times Snail1 levels, selected compounds showed a 5-fold enrichment over the hit-rate of random compounds (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4d</xref>). It is also worth noting that 17 of the positive hits were not known to be bioactive, and therefore their CC signatures have been fully inferred by our signaturizers. Finally, we selected the 10 compounds that displayed the strongest effect on reducing Snail1 levels and re-tested them in a confirmatory dose-response assay (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">14</xref>). Indeed, 4 of them showed a dose-dependent regulation of Snail1 (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4e</xref>). Of note, compounds <bold>8</bold> and <bold>9</bold> had the same chemotype, which was identified in 4 of the top 25 hits. Taken together, these results demonstrate that the various kinds of inferred chemical and biological signatures can be used to implement complex searches to tackle the activity of currently orphan targets.</p></sec><sec id="Sec6"><title>Enhanced prediction capabilities compared to chemical descriptors</title><p id="Par24">In addition, we examined whether our signaturizers could be used as molecular features to predict the outcome of a given bioassay of interest, analogous to the use of chemical descriptors in structure-activity relationship (SAR) studies. We thus developed signature&#x02013;activity relationship (SigAR) models, and trained machine-learning classifiers to learn discriminative features from the CC signatures of active (1) and inactive (0) compounds, with the goal of assigning a 1/0 label to new (untested) compounds.</p><p id="Par25">To evaluate the SigAR approach in a wide range of scenarios, we used nine state-of-the-art biophysics and physiology benchmark data sets available from MoleculeNet<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. More specifically, we considered bioassays extracted from PubChem (PCBA), namely an unbiased virtual screening data set (MUV), inhibition of HIV replication (HIV), inhibition of beta-secretase 1 activity (BACE), blood-brain barrier penetration data (BBBP), toxicity experiments (Tox21 and ToxCast), organ-level side effects (SIDER), and clinical trial failures due to safety issues (ClinTox). Although none of these benchmark data sets are explicitly included in the CC resource, data points can be shared between MoleculeNet and the CC, which would trivialize predictions. To rule out this possibility, we excluded certain CC signature classes from some of the exercises, as detailed in Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref> (e.g., side-effect signatures (E3) were not used in the SIDER set of MoleculeNet tasks).</p><p id="Par26">Each MoleculeNet benchmark data set has a given number of prediction tasks, ranging from 617 (ToxCast) to just one (HIV, BACE, and BBBP). The number of molecules also varies (from 1,427 in SIDER to 437,929 in PCBA) (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). We trained a classifier for each MoleculeNet task independently, following a conformal prediction scheme that relates the prediction score to a measure of confidence<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. We chose to use a general-purpose machine-learning method (i.e., a random forest classifier) with automated hyperparameter tuning, allowing us to focus on the added value of the CC signatures rather than the classification algorithm. Nevertheless, to confirm that the observed trends are not dependent on the random forest classifier, we repeated the experiment with a model-agnostic approach based on an AutoML methodology. To evaluate the accuracy of the classifiers, we followed MoleculeNet recommendations strictly, both in terms of splitting (e.g., scaffold-based) and in terms of performance measure (AUROC/AUPR) to ensure a fair assessment. We primarily compared the performance of CC signatures with the popular Morgan fingerprint (MFp), but also included a collection of different chemical descriptors such as MACCS keys, Daylight-like, and continuous and data-driven descriptors. We also included in the comparison the performance of the best predictor for each task as reported in MoleculeNet. Finally, although CC signatures are abstract representations that do not offer direct structural/mechanistic interpretations, we devised a strategy to obtain high-level explanations for predicted activities. More specifically, for each molecule, we measured the cumulative explanatory potential (Shapley values<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>) of each signature type (S<sub>1&#x02013;25</sub>) across the GSig space, indicating the classes of data (chemistry, targets, etc.) that were more determinant for the classifier decision (see &#x0201c;Methods&#x0201d; section). In sum, we implemented an automated (parameter-free) SigAR methodology, the outcome of which can be interpreted at the signature-type level and is calibrated as a probability or confidence&#x000a0;score.</p><p id="Par27">In Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5a&#x02013;d</xref> and Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">15</xref>, we show the characteristics of a representative classifier, corresponding to the heat shock factor response element (SR-HSE) task in the Tox21 panel. In a 5-fold cross-validation, active molecules got higher prediction scores than inactive compounds (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">15</xref>). Moreover, the SigAR model outperformed the conventional chemical MFp (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5a</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><title>MoleculeNet benchmarks, comparing the predictive power of CC signatures with a classical MFp-based approach.</title><p><bold>a</bold> Precision&#x02013;recall curves (PRCs) for the Tox21 SR-HSE task, trained with CC signatures (blue) and MFps (red). Shaded areas span the standard deviation over five stratified train&#x02013;test splits, the darker lines indicate the mean value. <bold>b</bold> Robustness of the SR-HSE classifier, understood as the maintenance of performance (ROC-AUC) as fewer training samples become available. <bold>c</bold> Prediction scores (probabilities) of active test molecules using MFps (<italic>x</italic> axis) or CC signatures (<italic>y</italic> axis). <bold>d</bold> Importance of CC data sets for the predictions. Features are ranked by their absolute Shapley value (SHAP) across samples (plots are capped at the top 250 features). For each CC data set (<italic>S</italic><sub><italic>i</italic></sub>), SHAPs are cumulatively summed (<italic>y</italic> axis; normalized by the maximum cumulative sum observed across CC data sets). <bold>e</bold> 2D projections related to SR-HSE (first column) and other (second column) tasks, done for the A1, B5, and D4 CC categories (rows). A simple support vector classifier (SVC) is trained with the (<italic>x</italic>,<italic>y</italic>)-coordinates as features in order to determine an activity-decision function. Performance is given as a ROC-AUC on the side of the plots. Blue and red areas correspond to likely active and likely inactive regions, respectively. Active compounds are overlaid as black dots. <bold>f</bold> Performance of CC signatures (blue) and MFps (red) on the 12 Tox21 tasks. Tasks are ranked by their CC ROC-AUC performance. <bold>g</bold> Global performances of biophysics (purple) and physiology (orange) benchmark tasks. PRC and ROC AUCs are used, following MoleculeNet recommendations, the number of tasks of each category varies and is reported in the original MoleculeNet report. Here we report mean&#x02009;&#x000b1;&#x02009;SD. Shades of blue indicate whether all 25 CC data sets were used (light) or whether conservative data set removal was applied (darker) (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). Dashed and dotted lines mark respectively the best and average reported performance in the seminal MoleculeNet study<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. <bold>h</bold> Relative performance of CC and MFp classifiers across all MoleculeNet tasks (split by ROC-AUC and PRC-AUC metrics, correspondingly; top and middle panels). Higher performances are achieved when more active molecules are available for training (<italic>x</italic> axis). The average gain in AUC is plotted in the bottom panel.</p></caption><graphic xlink:href="41467_2021_24150_Fig5_HTML" id="d32e1137"/></fig></p><p id="Par28">Additionally, the accuracy of the classifier was more robust to successive removal of training data (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5b</xref>), suggesting that, in principle, fewer data would be necessary to achieve a proficient model if CC signatures are used. Of note, some molecules had a high prediction score with the GSig-based model but were nonetheless predicted to be inactive by the MFp-based counterpart, and vice versa (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5c</xref>), thus pointing to the complementarity between the SigAR and SAR approaches. Indeed, CC chemistry levels were not among the best explanatory signature types for the SR-HSE classifier. Instead, HTS bioassays (B5) and cell morphology data (D4) appeared to be more informative (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5d</xref>), an observation that is also apparent when active molecules are laid out on the B5 and D4 2D maps (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5e</xref>).</p><p id="Par29">Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5f</xref> demonstrates that GSigs are generally favorable to MFps across the 12 toxicity pathways defined in the Tox21 benchmark data set, with particularly large differences for the SR-p53, NR-Aromatase, NR-AR, NR-PPAR-gamma, and SR-HSE tasks, and essentially the same performance for the NR-AhR and NR-ER tasks. Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">16</xref>&#x02013;<xref rid="MOESM1" ref-type="media">20</xref> give further details for these classifiers, supporting the robustness of the SigAR approach and demonstrating that, depending on the classification task, the model will benefit from specific CC signature types (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5e</xref> and Supplementary Figs.&#x000a0;<xref rid="MOESM1" ref-type="media">19</xref>, &#x000a0;<xref rid="MOESM1" ref-type="media">20</xref>). The NR-AhR model, for instance, mostly leverages the chemical levels (A), whereas SR-ATAD5 benefits from cell sensitivity data (D2), and NR-ER-LBD exploits the functional (e.g., biological process (C3)) information contained within the network levels of the CC.</p><p id="Par30">More comprehensively, in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5g</xref> we evaluate the predictive power of the SigAR classifiers across the full collection of MoleculeNet benchmark data sets, comprising 806 prediction tasks (Supplementary Table&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>). Our SigAR predictions were generally more accurate than the equivalent chemistry-based models, meaning that our signaturizers feed additional, valuable information to a broad range of activity-prediction tasks. We observed a remarkable added value of the SigAR methodology for the physiology benchmark data sets (e.g., SIDER and ClinTox), which are, a priori, those that should benefit most from an integrative (data-driven) approach like ours. Overall, we observed 8.5% median improvements in performance with respect to chemistry-based classifiers (IQR: 1.4&#x02013;19.5%, Wilcoxon&#x02019;s test <italic>P</italic>-value&#x02009;=&#x02009;5&#x000b7;10<sup>&#x02212;60</sup>) (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5h</xref>). This implies a median reduction of the gap between the actual and perfect (ideal) performance of 17.6% (IQR: 24.4&#x02013;31.5%). Reassuringly, considering only molecules with reported bioactivity (i.e., included in the CC) further accentuated the difference in performance (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">21</xref>), highlighting the importance of data integration methodologies to overcome the limitations of a classical (chemistry-only) approach. Finally, it is worth noting that the superior performance of CC signatures is robustly maintained when benchmarked against different chemical descriptors or classifiers (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">22</xref>).</p></sec></sec><sec id="Sec7" sec-type="discussion"><title>Discussion</title><p id="Par31">Drug discovery is a funneling pipeline that ends with a drug being selected from a starting pool of hundreds of thousands, if not millions, of compounds. Computational drug discovery (CDD) methods can aid in many steps of this costly process<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, including target deconvolution, hit-to-lead optimization, and anticipation of toxicity events. An efficient mathematical representation of the molecules is key to all CDD methods, 2D structural fingerprints being the default choice in many cases.</p><p id="Par32">The renaissance of (deep) neural networks has fueled the development of novel structure featurizers<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> based on graph/image convolutions of molecules<sup><xref ref-type="bibr" rid="CR31">31</xref>&#x02013;<xref ref-type="bibr" rid="CR33">33</xref></sup>, the apprehension of the SMILES syntax<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, or even a unified representation of protein targets<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. These techniques are able to identify problem-specific patterns and, in general, they outperform conventional chemical fingerprints. However, neural networks remain challenging to deal with, and initiatives such as DeepChem are contributing to making them accessible to the broad CDD community<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. The CC approach presented here shares with these initiatives the will to democratize the use of advanced molecular representations. Our approach is complementary in that it does not focus on optimally encoding chemical structures. Instead, we have undertaken the task of gathering, harmonizing, and finally vectorizing the bioactivity data available for the molecules in order to embed a wide array of bioactivities in a compact descriptor.</p><p id="Par33">Since CC signatures are simple 128D-vectors, they are compatible with other CDD toolkits that primarily use multi-dimensional descriptors to represent molecular structures. This compatibility presents a unique opportunity to inject biological information into similarity searches, visualization of chemical spaces, and clustering and property prediction, among other widely used CDD tasks.</p><p id="Par34">In this study, we showed how CC signatures can be used to navigate the chemical space in a biological-relevant manner, revealing somehow unexpected high-order structure in poorly annotated natural product collections. We also demonstrated that inferred bioactivity signatures are useful to annotate mostly uncharacterized chemical libraries and enrich compound collections for activity against a drug-orphan target, beyond chemical similarities. Moreover, compared to using chemical information alone, we observed a superior performance of SigAR models across a series of biophysics and physiology activity-prediction benchmark data sets. We chose to train models with minimal parameter tuning, illustrating how our signaturizers can be used in practice with minimal knowledge of machine-learning to obtain state-of-the-art performances.</p><p id="Par35">A limitation of CC signatures is that they are difficult to interpret in detail. That is, the underlying data points (binding to receptor <italic>x</italic>, occurrence of drug side effect <italic>y</italic>, etc.) cannot be deconvoluted from the 128D signature. This caveat is common to other machine-learning applications (e.g., natural language processing) where embedded representations of entities are favored over sparser, more explicit ones<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. Nonetheless, we show that CC signatures can be interpreted at a coarser level, indicating which signature types are more informative for a certain prediction task. Another caveat of our approach is the likely existence of null signatures corresponding to innocuous molecules with no actual bioactivity in a given CC data type<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. Likewise, the accuracy of the signatures may vary depending on the molecule. To control for these factors, CC signatures are accompanied by an applicability score that estimates the signature quality on the basis of the amount of experimental data available for the molecule, the robustness of the prediction, and the resemblance of the predicted signature to signatures available from the training set.</p><p id="Par36">Contrary to most chemical descriptors, CC signatures evolve with time as bioactivity measurements accumulate in the databases. We will release updated versions of the signaturizers once a year and, as developers of the CC, we are committed to keeping abreast of the latest phenotypic screening technologies and chemogenomics data sets. Although the current version of the CC is constrained to 25 categories, our resource is prepared to accommodate new data types, offering the opportunity to customize and extend the current repertoire of signaturizers. The growth of the CC resource is restricted by the number and quality of publicly accessible data sets, a limitation that is likely to be ameliorated with the implementation of private-public partnerships and the general awareness that, in the markedly gene-centric omics era, the depth of small-molecule annotation lags behind genomes and proteomes<sup><xref ref-type="bibr" rid="CR39">39</xref>,<xref ref-type="bibr" rid="CR40">40</xref></sup>. The ever-growing nature of chemical matter (in contrast to the finite number of genes) demands computational methods to provide a first estimate of the biological properties of compounds<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. We believe that CC signaturizers can bridge this gap and become a reference tool to scrutinize the expected bioactivity spectrum of compounds.</p></sec><sec id="Sec8"><title>Methods</title><sec id="Sec9"><title>Data collection</title><p id="Par37">Experimental CC signatures were obtained from the CC repository (version 2019/05). Drug Repurposing Hub molecules and annotations were downloaded from <ext-link ext-link-type="uri" xlink:href="https://clue.io/repurposing">https://clue.io/repurposing</ext-link> (June 2019). HMDB and FooDB data were downloaded from <ext-link ext-link-type="uri" xlink:href="http://hmdb.ca">http://hmdb.ca</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://foodb.ca">http://foodb.ca</ext-link>, respectively (April 2020). Plant ingredients were collected from CMAUP (July 2019) and cross-species metabolites from <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/metabolights">https://www.ebi.ac.uk/metabolights</ext-link> (April 2020). MoleculeNet benchmark data sets were downloaded from <ext-link ext-link-type="uri" xlink:href="http://moleculenet.ai">http://moleculenet.ai</ext-link> in June 2019. The remaining compound collections were fetched from ZINC catalogs (<ext-link ext-link-type="uri" xlink:href="http://zinc.docking.org">http://zinc.docking.org</ext-link>) (June 2020).</p></sec><sec id="Sec10"><title>Siamese neural networks</title><p id="Par38">We carried out all procedures specified below for each CC data set (S<sub><italic>i</italic></sub>) independently, and we trained 25 SNNs based on existing CC signatures and molecule triplets reflecting S<sub><italic>i</italic></sub> similarities. SNNs use the same weights and neural architecture for the three input samples to produce comparable output vectors in the embedding space.</p><p id="Par39">Covariates matrixWe trained a SNN having horizontally concatenated signatures (S<sub>1</sub>&#x02013;S<sub>25</sub>) as a covariates matrix (<italic>X</italic>), and producing 128D-vectors as output (<italic>Y</italic>). The covariates matrix was stacked with a pre-compressed version of CC signatures (named signatures type II) with 128 dimensions. Only CC data sets covering at least 10% of S<sub><italic>i</italic></sub> were stacked in <italic>X</italic>. Thus, given <italic>n</italic> molecules in S<sub><italic>i</italic></sub>, and having <italic>m</italic> S<sub>1&#x02013;25</sub> data sets cross-covering at least 10% of n, <italic>X</italic> would be of shape (<italic>n</italic>, 128&#x000b7;<italic>m</italic>). For each molecule (row), missing signatures were represented as not-a-number (NaN) values.</p><p id="Par40"><italic>Triplet sampling</italic>. We sampled 10<sup>7</sup> molecule triplets (i.e., 10<sup>7</sup>/<italic>n</italic> triplets per anchor molecule). Positive samples (i.e., molecules similar to the anchor) were drawn using the FAISS k-nearest neighbor search tool<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. The value of <italic>k</italic> was empirically determined so that it maximized the average ROC-AUC of similarity measures performed against the rest of CC data sets, and it was then clipped between 10 and 50. Negative samples were randomly chosen from the pool of molecules at larger distances than the positive compounds.</p><p id="Par41"><italic>SNN architecture</italic>. SNNs were built and trained using Keras (<ext-link ext-link-type="uri" xlink:href="https://github.com/fchollet/keras">https://github.com/fchollet/keras</ext-link>). After the 128&#x000b7;m-dimensional input layer, we added a Gaussian dropout layer (<italic>&#x003c3;</italic>&#x02009;=&#x02009;0.1). We then sequentially added two fully connected (dense) layers whose size was determined by the m magnitude. When m&#x000b7;128 was higher than 512, the two hidden layers had sizes of 512 and 256, respectively. For smaller m values, we linearly interpolated the size between input and output (128) dimensions (e.g., for <italic>m</italic>&#x02009;=&#x02009;7, the two hidden layers had sizes of 448 and 224, respectively). Finally, a dense output layer of 128 dimensions was sequentially added. For the hidden layers, we used a SeLU activation with alpha-dropout regularization (0.2), and the last (output) layer was activated with a Tanh function, together with an L2-normalization.</p><p id="Par42"><italic>Signature dropout</italic>. We devised a dropout strategy to simulate the availability of CC signatures at prediction time. To do so, we measured the proportion of experimental S<sub>1&#x02013;25</sub> signatures available for not-in-S<sub><italic>i</italic></sub> molecules. These observed (realistic) probabilities were then used to mask input data at a fitting time, more frequently setting those CC categories with the smaller probabilities to NaN. The S<sub><italic>i</italic></sub> signature was dropped out with an oscillating probability (0&#x02013;1) over the training iterations (5000 oscillation cycles per epoch).</p><p id="Par43"><italic>Loss functions</italic>. To optimize the SNN, we used a pair of loss functions with a global orthogonal regularization<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. The first one was a conventional triplet loss, checking that the distance between the anchor and the positive molecule measured in the embedding (128D) space was shorter than the anchor-negative distance (margin&#x02009;=&#x02009;1). The second loss was exclusively applied to the anchor molecule, and it controlled that the embedding resulting from the signature dropout was similar to the embedding obtained using S<sub><italic>i</italic></sub> alone (mean-squared error (MSE)). Global orthogonal regularization (alpha&#x02009;=&#x02009;1) was used to favor the maximal spread-out of signatures in the embedding space. The Adam optimizer was used with a default learning rate of 10<sup>&#x02212;4</sup>.</p><p id="Par44"><italic>Evaluation</italic>. For each S<sub><italic>i</italic></sub>, we split the list of <italic>n</italic> molecules into the train (80%) and test (20%) sets. Splitting was done after removing near-duplicates with FAISS. We then defined three triplet splits, i.e., train&#x02013;train, test&#x02013;train, and test&#x02013;test, using molecules from the train and test sets as anchors and positives/negatives, correspondingly. For CC spaces with &#x0003c;30,000 molecules, we trained the model for 5 epochs, whereas the largest data sets were trained for 2 epochs. Two accuracy measures were defined: (a) a triplet-based accuracy quantifying the proportion of correctly classified triplets by Euclidean distance measurements in the embedding space (dropping out S<sub><italic>i</italic></sub>); and (b) an anchor-based accuracy measuring the correlation between the S<sub><italic>i</italic></sub>-dropped-out embedding and the S<sub><italic>i</italic></sub>-only embedding. Given the bimodal distribution endowed by the Tanh activation, we chose to use a Matthews correlation coefficient (MCC) on a contingency table of binarized data (positive/negative along the 128 dimensions).</p><p id="Par45"><italic>Light-weight signaturizers</italic>. We ran predictions for all molecules available in the CC universe (<italic>N</italic>&#x02009;=&#x02009;778,531), producing 25 matrices of shape (<italic>N</italic>, 128). These matrices were used to learn chemistry-to-signature (CTS) signaturizers that are easy to distribute, allowing us to obtain signatures for a given molecule on-the-fly. CTS signaturizers were trained on a large number of molecules (<italic>N</italic>) with the aim to approximate the pre-calculated signatures presented in this work. Thus, in practice, a CTS signaturizer will often act as a mapping function, since the number of pre-calculated signatures is very large and covers a considerable portion of the medicinal chemistry space. CTS signaturizers were trained for 30 epochs and validated with an 80:20 train&#x02013;test split, using 2048-bit Morgan Fingerprints (radius&#x02009;=&#x02009;2) as feature vectors. Three dense hidden layers were used (1024, 512, and 256 dimensions) with ReLU activations and dropout regularization (0.2). The output was a dense layer of 128 dimensions (Tanh activation). The Adam optimizer was used (learning rate&#x02009;=&#x02009;10<sup>&#x02212;3</sup>). CTS signaturizers achieved a correlation with the type III signature of 0.769 &#x000b1; 0.074.</p></sec><sec id="Sec11"><title>Applicability domain estimation</title><p id="Par46">An applicability score (<italic>&#x003b1;</italic>) for the signatures can be obtained at prediction time by means of a linear combination of five factors related to three characteristics that help increase trust in the predictions. These factors were tuned and calibrated on the test set.</p><sec id="Sec12"><title>Distance</title><p id="Par47">Signatures that are close to training-set signatures are, in principle, closer to the applicability domain. We measured this distance in an unsupervised way (i.e., the average distance to 5/25 nearest-neighbors) and in a supervised way by means of a random forest regressor trained on signatures as features and prediction accuracy (correlation) as a dependent variable. In addition, we devised a measure of intensity, defined as the mean absolute deviation of the signatures to the average (null) signature observed in the training set.</p></sec><sec id="Sec13"><title>Robustness</title><p id="Par48">The signature-dropout procedure presented above can be applied at prediction time to obtain an estimate of the robustness of the prediction. For each molecule, we generated 10 dropped-out inputs, thereby obtaining an ensemble of predictions. Small standard deviations over these predictions indicate a robust output.</p></sec><sec id="Sec14"><title>Expectancy a priori</title><p id="Par49">We calculated the accuracy that is expected given the input signatures available for a particular molecule. Some CC signature types are highly predictive for others; thus, having these informative signatures at hand will in principle favor reliable predictions. This prior expectancy was calculated by fitting a random forest classifier with 25 absence/presence features as covariates and prediction accuracy as an outcome.</p></sec></sec><sec id="Sec15"><title>Validation of the inferred bioactivity signatures and the signaturizers</title><p id="Par50">To further explore the validity of the inferred bioactivity signatures and the developed signaturizers, we ran three independent technical validations.</p><p id="Par51">First, we conducted a scrambling experiment, which involved the calculation of GSigs related to randomized MFps, in order to assess whether the resulting GSigs would have some sort of structure (signal) or not. This is, we randomly picked 1000 compounds from the CC universe and computed their GSigs with and without a scrambling of their structural representation (i.e., their Morgan fingerprints). Then, we calculated all the pairwise distances signatures in each set. As expected, when we plot the shortest distance between pairs of molecules within the GSig and scrambled-GSig sets, we see that there are no significant similarities between scrambled and global signatures, while GSigs can indeed detect similarities between small molecules, i.e., short distances between GSigs (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">23a</xref>). Additionally, 2D projections (t-SNE and PCA) of scrambled and global signatures (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">23b</xref>) reinforce the observation that scrambled signatures are indeed different from real GSigs and contain no bioactivity signal.</p><p id="Par52">Second, we performed a <italic>Y</italic>-scrambling experiment on the whole array of MoleculeNet prediction tasks (previously introduced). <italic>Y</italic>-scrambling (or <italic>Y</italic>-randomization) is commonly used to validate QSPR/QSAR models by training predictors on the randomly shuffled dependent variable (<italic>Y</italic>) that we aim to predict. Comparing the performances (on an unshuffled test set) of models trained on shuffled vs unshuffled data we can assess the robustness of descriptors and rule out the effect of random correlations. This is exactly what we observe for both GSig and ECFP4 descriptors (Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">24</xref>), with a drop of model performances to an average of 0.5 ROC-AUC when training on scrambled data.</p><p id="Par53">Lastly, we ran a time-series experiment by confronting the small-molecule bioactivity signatures predicted using the 2019_01 (September 2019) signaturizers with novel experimental bioactivity data available in the newly released 2020_02 (November 2020) version. In this new CC release, most of the source databases have been updated presenting new data for molecules that were not present in the previous versions.</p><p id="Par54">Profiting from the novel experimental data, for each bioactivity space, we gathered molecules only present in the new version and that are completely novel in terms of CC annotation. Using the signaturizer 2019_01, we predicted signatures for the new molecules and searched for neighbors in the 2019_01 CC universe. We then compared this set of neighbors to those confirmed in the 2020_02 version, excluding molecules not available in the 2019_01 CC universe (i.e., those neighbors that are also new molecules). Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">25</xref> shows the fraction of novel molecules (<italic>y</italic> axis) for which at least one correct neighbor is identified among the top [1&#x02013;1000] predicted neighbors (<italic>x</italic> axis), within the roughly 1&#x02009;M molecules in the CC chemical space. We also show the same fraction of recovered real neighbors when randomizing the signaturized molecules. Despite the limited number of new molecules with experimental information in some of the spaces, we observe that the signaturizers derived from previous versions can identify similar molecules for a significant fraction of the new compounds. Moreover, we also see how increasing the applicability score threshold augments the reliability of the predicted signatures in all the bioactivity spaces. However, as expected, when we use random molecules as bait, we cannot identify true neighbors and there is no relationship with the applicability scores.</p></sec><sec id="Sec16"><title>Library enrichment for activity against Snail1</title><sec id="Sec17"><title>Computational screening</title><p id="Par55"><italic>Compound collections</italic>: Two compound collections were considered for screening, namely the IRB Barcelona library (17,563 compounds, considering the connectivity layer of the InChIKey) and the commercial Prestwick library (1108 compounds). Of these, 627 and 1104 were part of the CC universe, respectively, meaning that they had some type of reported bioactivity.</p><p id="Par56"><italic>Chemical query</italic>: This query involved the search for compounds that were chemically similar to curated DUB inhibitors, based on their known activity on promising DUBs according to a previous siRNA/Snail1 screen<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>), or similar to DUB inhibitors belonging to a broader list (with DUB-binding data available). The query was implemented by computing chemical similarity (best across A1&#x02009;+&#x02009;A4, <italic>P</italic>&#x02009;&#x0003c;&#x02009;0.001) to DUB inhibitors from the literature (curation categories 1 and 2 in Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>, corresponding to 6 DUB inhibitors). In total, this query selected 169 compounds.</p><p id="Par57"><italic>Biological queries</italic>: In addition to DUBs, we considered other proteins relevant to Snail1 activity, namely TGFBR1/2, ERK2, FBXL5/14, DDR2, and GSK3B (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>). We then looked for transcriptional signatures associated with the corresponding genes in the L1000 Connectivity Map (shRNA assays, reversed over-expression assays, and known small-molecule perturbagens) and also in CREEDS, which brings together data from GEO<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Overall, we gathered 132 transcriptional signatures with a potential of having a connection to Snail1 (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>). Different priorities (0&#x02013;4) were given to these signatures based on our mechanistic knowledge of Snail1 (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref> legend). Transcriptional signatures were converted to the CC D1 format as explained above. In addition, we derived C3&#x02013;5 signatures for the Snail1-related genes, including DUBs highlighted by the siRNA/Snail1 screen.</p><p id="Par58">We looked for connectivities (similarities, <italic>P</italic>-value&#x02009;&#x0003c;&#x02009;0.001) between signatures of compounds in the D1 space and the list of Snai1-related signatures (at least 10 up/downregulated genes per signature). We did two searches (search H and search L), one against high-priority signatures (priority &#x02265;3), and another with a more relaxed cutoff (priority &#x02265;1). In parallel, we derived C3&#x02013;5 signatures for non-DUB Snail1-related proteins (TGFBR1/2, etc.).</p><p id="Par59"><italic>Random query</italic>: Molecules were randomly picked from the PWCK and IRB libraries, proportionally to the relative abundance of molecules from the two libraries in the lists retrieved from the previous queries (Supplementary Data&#x000a0;<xref rid="MOESM4" ref-type="media">1</xref>).</p><p id="Par60"><italic>Comparison to classical ECPF4-based queries</italic>: To compare our results to a more classical compound selection strategy, based on ECPF4 similarities, we calculated all Tanimoto similarities between the &#x0003e;17k compounds in our library and the 45 annotated DUB inhibitors, and selected the 222 compounds with the highest similarities. Additionally, for each compound, we also computed the average similarity to the closest 5 DUB inhibitors and, again, selected the 222 with the highest scores. The Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">26a</xref> shows the overlap between the different selections, revealing that all three approaches are indeed complementary. We then calculated the enrichment in the identification of Snail1 inhibitors achieved by each strategy considering as positive hits all those compounds able to decrease 1.5 times the levels of Snail1, and compared the hits found by each strategy to those found in random compounds. As Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">26b</xref> shows, the signatures-based approach achieved a ~3.5-fold enrichment, closely followed by the average score of compounds over the 5 closest DUB inhibitors (~2.8-fold) and the one that only considers the highest Tanimoto similarity with any DUB inhibitor (~1.7-fold). Overall, the three approaches show a significant capacity to enrich compound libraries for a given function but, as expected, the combination of chemical and biological signatures identifies additional compounds.</p></sec><sec id="Sec18"><title>Cells</title><p id="Par61">We used MDA-MB-231 cells stably transduced with pLEX-Snail1-Firefly Luciferase and pMSCV-Renilla Luciferase from our previous study<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, and cultured them in DMEM supplemented with 10% FBS, glutamine, and antibiotics (ThermoFisher Scientific).</p></sec><sec id="Sec19"><title>Dual-luciferase assay screening</title><p id="Par62">We seeded 5&#x000b7;10<sup>4</sup> cells in 96-well white plates prepared for cell culture (Corning). The day after, pre-diluted compounds of the chemical libraries were added to the cells at a final concentration of 20&#x02009;&#x000b5;M, or in a few cases, of 4&#x02009;&#x000b5;M, depending on the stock concentration and the maximum amount of DMSO that could be used in the assay. Several replicas of the vehicle controls (DMSO) or the positive control (the general DUB inhibitor PR-619 (Sigma-Aldrich)) were distributed along the experimental plates to allow internal normalization. After 6&#x02009;h of incubation, the medium was removed. Cells were then directly lysed with passive lysis buffer (Promega), and plates were stored at &#x02212;20&#x02009;&#x000b0;C. Firefly and Renilla luciferase were quantified using the Dual-Luciferase Reporter assay system (Promega) in a GloMax luciferase plate reader (Promega). Four replicas conducted on two days were performed.</p><p id="Par63">Intensities were corrected for each measurement (i.e., Firefly and Renilla) using one linear model per replica. The linear model included plate, row, and column (as ordinal covariates) and type of measure (namely compounds, negative and positive controls) as fixed effects, as well as plate-row and plate-column interactions. Estimation of effects for plate, row, and column (and their interactions) were used to correct intensity values. Intensities were previously transformed (square root) in order to fulfill the assumptions of linear models. In practice, this transformation implies a correction based on the median (instead of mean) effects, and it is thus robust to outliers (potential hits). Corrected values were transformed back to the original scale of the measures after correction. For normalization against controls, log2-ratios of intensities were computed against the mean of negative controls within each marker-replicate. Log2-ratios of Firefly:Renilla were then computed for signal evaluation.</p><p id="Par64">The enrichment of hit rates was evaluated separately for each query (chemical, biological) with respect to the random distribution of Firefly:Renilla ratios.</p><p id="Par65">To ensure that the tested compounds did not directly interfere with luciferase activity, we devised a double computational and experimental strategy. On the one hand, we used the available PubChem bioassay AID:411 (<ext-link ext-link-type="uri" xlink:href="https://pubchem.ncbi.nlm.nih.gov/bioassay/411">https://pubchem.ncbi.nlm.nih.gov/bioassay/411</ext-link>) listing inhibitors of Firefly Luciferase to train a simple predictor of luciferase inhibition. The Bioassay contains over 70 thousand inactive and over 1500 active compounds against luciferase for which we derived both the GSig (presented in our manuscript) and classical Morgan Fingerprint (ECFP4 descriptor). A simple logistic regression (with class weights to handle active/inactive imbalance) was sufficient to achieve good classification accuracy. We performed a 5-fold stratified cross-validation and we measured performance in terms of ROC-AUC and F1-score. We report the result of both train and test splits in Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">27a</xref>. We then used the classifier trained on GSigs to calculate the probability of luciferase interaction for the 400 tested compounds, including the top 25 candidates we identified. Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">27b</xref> shows that an interaction of these compounds to the luciferase reporter is unlikely. Unfortunately, we did not find training data of similar characteristics for Renilla luciferase; no PubChem bioassay provides inhibition data specifically for this enzyme. However, please note that in our experimental measure of activity (i.e., low Firefly:Renilla ratio), false positives may reveal Firefly luciferase inhibition (numerator), not Renilla luciferase inhibition (denominator).</p><p id="Par66">On the other hand, we used transiently transfected MDA-MB-231 cells expressing constitutively the Firefly and the Renilla Luciferases under the control of CMV and TK promoters, respectively. Specifically, MDA-MB-231 cell line was cultivated in DMEM-F12 medium. Cells were co-transfected with 2&#x02009;&#x000b5;g of pCMV-luc and 6&#x02009;&#x000b5;g of pTK-RN in 100&#x02009;mm plates, using Polyethylenimine (PEI) at a ratio DNA:PEI 1:3. 24&#x02009;h after transfection, cells were trypsinized and seeded in a 96-well plate at 40,000 cells per well. 48&#x02009;h after transfection, cells were treated with the drugs at 20&#x02009;&#x000b5;M during 6&#x02009;h. Cells were then lysed using the Passive Lysis Buffer provided in the Dual-Luciferase Reporter Assay System (Promega) and Firefly and Renilla activities were measured following the manufacturer&#x02019;s instructions. As can be seen in Supplementary Fig.&#x000a0;<xref rid="MOESM1" ref-type="media">27c</xref>, only the positive control (PR619) at a high concentration showed a moderate interference with the Renilla luciferase activity. Indeed, none of the selected compounds showed an inhibitory effect neither on Firefly nor on Renilla luciferase activity, confirming that the measured signal was not confused by interference with the reporter enzymes.</p></sec></sec><sec id="Sec20"><title>Signature&#x02013;activity relationship (SigAR) models</title><p id="Par67">For each classification task in the MoleculeNet, we sought to predict active/inactive (1/0) compounds using horizontally stacked CC signatures. A random forest classifier was trained using hyperparameters identified with HyperOpt<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> over 10 iterations (number of estimators: (100, 500, 1000), max depth: (None, 5, 10), minimum sample split: (2, 3, 10), criterion: (gini, entropy), maximum features: (square root, log2)). Classifiers were calibrated using a Mondrian cross-conformal prediction scheme over 10 stratified splits. The evaluation was done with five stratified 80:20 train&#x02013;test splits. Large MoleculeNet data sets such as PCBA were trained on a maximum of 30 under-sampled data sets, each comprising 10,000 samples. Scaffold-aware stratified splits, when necessary, were done ensuring that Murcko scaffolds<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> observed in the training set were not present in the test set<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. Please, note that we followed MoleculeNet recommendations strictly, both in terms of splitting (e.g., scaffold-based) and in terms of performance measure (AUROC/AUPR) to ensure a fair assessment.</p><p id="Par68">Signature importance for each prediction was calculated by aggregating Shapley values (SHAP) as follows. First, features were ranked by their absolute SHAP across molecules. We then calculated the cumulative rank specific to each signature type (S<sub><italic>i</italic></sub>) (up to 250 features). Signature types with more of their dimensions in highly ranked positions were deemed to be more explanatory for the prediction task.</p><p id="Par69">To assess the robustness of our results, we extended the collection of chemical descriptors beyond ECFPs. In particular, we included Daylight-like (RDKit) fingerprints (path-based), MACCS keys, and a data-driven state-of-the-art descriptor named CDDD, which is based on a deep-learning model trained on string (SMILES) representations of the molecules. Additionally, we repeated the SigAR task predictions with a model-agnostic approach based on the AutoML TPOT methodology. In brief, TPOT automatically performs feature selection/processing, classifier choice, and hyperparameter optimization across a wide array of standard ML techniques. Thus, this approach provides a fair (ML-independent) head-to-head comparison between our descriptors and the rest of the chemical fingerprints. Note that, in this case, we could not address the PCBA MoleculeNet subtasks (involving 400k molecules) due to prohibitive computational costs for TPOT.</p></sec></sec><sec id="Sec21"><title>Reporting summary</title><p id="Par70">Further information on research design is available in the&#x000a0;<xref rid="MOESM5" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p></sec><sec sec-type="supplementary-material"><title>Supplementary information</title><sec id="Sec22"><supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41467_2021_24150_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41467_2021_24150_MOESM2_ESM.pdf"><caption><p>Peer Review File</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="41467_2021_24150_MOESM3_ESM.pdf"><caption><p>Description of Additional Supplementary Files</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="41467_2021_24150_MOESM4_ESM.xlsx"><caption><p>Supplementary Data 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5"><media xlink:href="41467_2021_24150_MOESM5_ESM.pdf"><caption><p>Reporting Summary</p></caption></media></supplementary-material></sec></sec></body><back><fn-group><fn><p><bold>Peer review information</bold>
<italic>Nature Communications</italic> thanks Jean-Louis Reymond and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p></fn><fn><p><bold>Publisher&#x02019;s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn><fn><p>These authors contributed equally: Martino Bertoni, Miquel Duran-Frigola, Pau Badia-i-Mompel.</p></fn></fn-group><sec><title>Supplementary information</title><p>The online version contains supplementary material available at 10.1038/s41467-021-24150-4.</p></sec><ack><title>Acknowledgements</title><p>We would like to thank the SB&#x00026;NB lab members for their support and helpful discussions. We are grateful to T.O. Botelho, I. Ramos, and C. Gonzalez for giving us access to the IRB Barcelona and Prestwick libraries. P.A. acknowledges the support of the Generalitat de Catalunya (RIS3CAT Emergents CECH: 001-P-001682 and VEIS: 001-P-001647), the Spanish Ministerio de Econom&#x000ed;a y Competitividad (BIO2016-77038-R), the European Research Council (SysPharmAD: 614944), and the European Commission (RiPCoN: 101003633). A.G.d.H. acknowledges support by Agencia Estatal de Investigaci&#x000f3;n (AEI) and Fondos FEDER (PID2019-104698RB-I00).</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>M.D.-F. and P.A. designed the study and wrote the manuscript. M.B., M.D.-F., P.B.-i.-M., M.O.-R., and O.G.-P. implemented the entire computational strategy. E.P., V.A., V.M.D., A.B.-L.l., I.B.-H., N.V., and A.G.d.H. performed and analyzed the Snail1-luciferase assays. All authors analyzed the results and read and approved the manuscript.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>The latest version of inferred signatures (version 2020_02 at the moment of writing this manuscript) is available for direct download from <ext-link ext-link-type="uri" xlink:href="https://chemicalchecker.com/downloads">https://chemicalchecker.com/downloads</ext-link>. Additional data that support the findings of this study are available from the corresponding author upon reasonable request.</p></notes><notes notes-type="data-availability"><title>Code availability</title><p>Software for generating CC signatures is available as a python package at <ext-link ext-link-type="uri" xlink:href="http://gitlabsbnb.irbbarcelona.org/packages/signaturizer">http://gitlabsbnb.irbbarcelona.org/packages/signaturizer</ext-link>. The signaturizer API allows the conversion of molecules (represented as SMILES or InChl strings) to the 25 signature types available from the CC. These pre-trained signaturizers are light-weight versions of the SNNs presented here, freeing the user from the need of setting up a full version of the CC (see &#x0201c;Methods&#x0201d; section). Signaturizers are available as TensorFlow Hub SavedModel instances and are automatically downloaded by the API the first time they are used. The full CC repository is open-sourced at <ext-link ext-link-type="uri" xlink:href="http://gitlabsbnb.irbbarcelona.org/packages/chemical_checker">http://gitlabsbnb.irbbarcelona.org/packages/chemical_checker</ext-link> and also available on Zenodo<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>.</p></notes><notes id="FPar1" notes-type="COI-statement"><title>Competing interests</title><p id="Par71">The authors declare no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Llanos</surname><given-names>EJ</given-names></name><etal/></person-group><article-title>Exploration of the chemical space and its three historical regimes</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2019</year><volume>116</volume><fpage>12660</fpage><lpage>12665</lpage><pub-id pub-id-type="doi">10.1073/pnas.1816039116</pub-id><?supplied-pmid 31186353?><pub-id pub-id-type="pmid">31186353</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gromski</surname><given-names>PS</given-names></name><name><surname>Henson</surname><given-names>AB</given-names></name><name><surname>Granda</surname><given-names>JM</given-names></name><name><surname>Cronin</surname><given-names>L</given-names></name></person-group><article-title>How to explore chemical space using algorithms and automation</article-title><source>Nat. Rev. Chem.</source><year>2019</year><volume>3</volume><fpage>119</fpage><lpage>128</lpage><pub-id pub-id-type="doi">10.1038/s41570-018-0066-y</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wassermann</surname><given-names>AM</given-names></name><name><surname>Lounkine</surname><given-names>E</given-names></name><name><surname>Davies</surname><given-names>JW</given-names></name><name><surname>Glick</surname><given-names>M</given-names></name><name><surname>Camargo</surname><given-names>LM</given-names></name></person-group><article-title>The opportunities of mining historical and collective data in drug discovery</article-title><source>Drug Discov. Today</source><year>2015</year><volume>20</volume><fpage>422</fpage><lpage>434</lpage><pub-id pub-id-type="doi">10.1016/j.drudis.2014.11.004</pub-id><?supplied-pmid 25463034?><pub-id pub-id-type="pmid">25463034</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kauvar</surname><given-names>LM</given-names></name><etal/></person-group><article-title>Predicting ligand binding to proteins by affinity fingerprinting</article-title><source>Chem. Biol.</source><year>1995</year><volume>2</volume><fpage>107</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1016/1074-5521(95)90283-X</pub-id><?supplied-pmid 9383411?><pub-id pub-id-type="pmid">9383411</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keiser</surname><given-names>MJ</given-names></name><etal/></person-group><article-title>Predicting new molecular targets for known drugs</article-title><source>Nature</source><year>2009</year><volume>462</volume><fpage>175</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1038/nature08506</pub-id><?supplied-pmid 19881490?><pub-id pub-id-type="pmid">19881490</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sterling</surname><given-names>T</given-names></name><name><surname>Irwin</surname><given-names>JJ</given-names></name></person-group><article-title>ZINC 15&#x02013;ligand discovery for everyone</article-title><source>J. Chem. Inf. Model</source><year>2015</year><volume>55</volume><fpage>2324</fpage><lpage>2337</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.5b00559</pub-id><?supplied-pmid 26479676?><pub-id pub-id-type="pmid">26479676</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reymond</surname><given-names>J-L</given-names></name></person-group><article-title>The chemical space project</article-title><source>Acc. Chem. Res.</source><year>2015</year><volume>48</volume><fpage>722</fpage><lpage>730</lpage><pub-id pub-id-type="doi">10.1021/ar500432k</pub-id><?supplied-pmid 25687211?><pub-id pub-id-type="pmid">25687211</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duran-Frigola</surname><given-names>M</given-names></name><etal/></person-group><article-title>Extending the small-molecule similarity principle to all levels of biology with the Chemical Checker</article-title><source>Nat. Biotechnol.</source><year>2020</year><volume>38</volume><fpage>1087</fpage><lpage>1096</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0502-7</pub-id><?supplied-pmid 32440005?><pub-id pub-id-type="pmid">32440005</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendez</surname><given-names>D</given-names></name><etal/></person-group><article-title>ChEMBL: towards direct deposition of bioassay data</article-title><source>Nucleic Acids Res.</source><year>2019</year><volume>47</volume><fpage>D930</fpage><lpage>D940</lpage><pub-id pub-id-type="doi">10.1093/nar/gky1075</pub-id><?supplied-pmid 30398643?><pub-id pub-id-type="pmid">30398643</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wishart</surname><given-names>DS</given-names></name><etal/></person-group><article-title>DrugBank 5.0: a major update to the DrugBank database for 2018</article-title><source>Nucleic Acids Res.</source><year>2018</year><volume>46</volume><fpage>D1074</fpage><lpage>D1082</lpage><pub-id pub-id-type="doi">10.1093/nar/gkx1037</pub-id><?supplied-pmid 29126136?><pub-id pub-id-type="pmid">29126136</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duran-Frigola</surname><given-names>M</given-names></name><name><surname>Mateo</surname><given-names>L</given-names></name><name><surname>Aloy</surname><given-names>P</given-names></name></person-group><article-title>Drug repositioining beyond the low-hanging fruits</article-title><source>Curr. Opin. Syst. Biol.</source><year>2017</year><volume>3</volume><fpage>2452</fpage><lpage>3100</lpage></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cortes-Ciriano</surname><given-names>I</given-names></name><name><surname>Bender</surname><given-names>A</given-names></name></person-group><article-title>Reliable prediction errors for deep neural networks using test-time dropout</article-title><source>J. Chem. Inf. Model</source><year>2019</year><volume>59</volume><fpage>3330</fpage><lpage>3339</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.9b00297</pub-id><?supplied-pmid 31241929?><pub-id pub-id-type="pmid">31241929</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corsello</surname><given-names>SM</given-names></name><etal/></person-group><article-title>The drug repurposing hub: a next-generation drug library and information resource</article-title><source>Nat. Med.</source><year>2017</year><volume>23</volume><fpage>405</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1038/nm.4306</pub-id><?supplied-pmid 28388612?><pub-id pub-id-type="pmid">28388612</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wishart</surname><given-names>DS</given-names></name><etal/></person-group><article-title>HMDB 4.0: the human metabolome database for 2018</article-title><source>Nucleic Acids Res.</source><year>2018</year><volume>46</volume><fpage>D608</fpage><lpage>D617</lpage><pub-id pub-id-type="doi">10.1093/nar/gkx1089</pub-id><?supplied-pmid 29140435?><pub-id pub-id-type="pmid">29140435</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kale</surname><given-names>NS</given-names></name><etal/></person-group><article-title>MetaboLights: an open-access database repository for metabolomics data</article-title><source>Curr. Protoc. Bioinformatics</source><year>2016</year><volume>53</volume><fpage>14.13.1</fpage><lpage>14.13.18</lpage><pub-id pub-id-type="doi">10.1002/0471250953.bi1413s53</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>X</given-names></name><etal/></person-group><article-title>CMAUP: a database of collective molecular activities of useful plants</article-title><source>Nucleic Acids Res.</source><year>2019</year><volume>47</volume><fpage>D1118</fpage><lpage>D1127</lpage><pub-id pub-id-type="doi">10.1093/nar/gky965</pub-id><?supplied-pmid 30357356?><pub-id pub-id-type="pmid">30357356</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barabasi</surname><given-names>A</given-names></name><name><surname>Menichetti</surname><given-names>G</given-names></name><name><surname>Loscalzo</surname><given-names>J</given-names></name></person-group><article-title>The unmapped chemical complexity of our diet</article-title><source>Nat. Food</source><year>2020</year><volume>1</volume><fpage>33</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1038/s43016-019-0005-1</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dongre</surname><given-names>A</given-names></name><name><surname>Weinberg</surname><given-names>RA</given-names></name></person-group><article-title>New insights into the mechanisms of epithelial-mesenchymal transition and implications for cancer</article-title><source>Nat. Rev. Mol. Cell Biol.</source><year>2019</year><volume>20</volume><fpage>69</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1038/s41580-018-0080-4</pub-id><?supplied-pmid 30459476?><pub-id pub-id-type="pmid">30459476</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Oprea, T. I. et al. Unexplored therapeutic opportunities in the human genome. <italic>Nat. Rev. Drug Discov</italic>. <bold>17</bold>, 317&#x02013;332 (2018).</mixed-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambies</surname><given-names>G</given-names></name><etal/></person-group><article-title>TGFbeta-activated USP27X deubiquitinase regulates cell migration and chemoresistance via stabilization of Snail1</article-title><source>Cancer Res.</source><year>2019</year><volume>79</volume><fpage>33</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-18-0753</pub-id><?supplied-pmid 30341066?><pub-id pub-id-type="pmid">30341066</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritorto</surname><given-names>MS</given-names></name><etal/></person-group><article-title>Screening of DUB activity and specificity by MALDI-TOF mass spectrometry</article-title><source>Nat. Commun.</source><year>2014</year><volume>5</volume><fpage>4763</fpage><pub-id pub-id-type="doi">10.1038/ncomms5763</pub-id><?supplied-pmid 25159004?><pub-id pub-id-type="pmid">25159004</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kemp</surname><given-names>M</given-names></name></person-group><article-title>Recent advances in the discovery of deubiquitinating enzyme inhibitors</article-title><source>Prog. Med. Chem.</source><year>2016</year><volume>55</volume><fpage>149</fpage><lpage>192</lpage><pub-id pub-id-type="doi">10.1016/bs.pmch.2015.10.002</pub-id><?supplied-pmid 26852935?><pub-id pub-id-type="pmid">26852935</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrigan</surname><given-names>JA</given-names></name><name><surname>Jacq</surname><given-names>X</given-names></name><name><surname>Martin</surname><given-names>NM</given-names></name><name><surname>Jackson</surname><given-names>SP</given-names></name></person-group><article-title>Deubiquitylating enzymes and drug discovery: emerging opportunities</article-title><source>Nat. Rev. Drug Discov.</source><year>2018</year><volume>17</volume><fpage>57</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/nrd.2017.152</pub-id><?supplied-pmid 28959952?><pub-id pub-id-type="pmid">28959952</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baulida</surname><given-names>J</given-names></name><name><surname>de Herreros</surname><given-names>Garcia</given-names></name></person-group><article-title>Snail1-driven plasticity of epithelial and mesenchymal cells sustains cancer malignancy</article-title><source>Biochim. Biophys. Acta</source><year>2015</year><volume>1856</volume><fpage>55</fpage><lpage>61</lpage><?supplied-pmid 26050961?><pub-id pub-id-type="pmid">26050961</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barrett</surname><given-names>T</given-names></name><etal/></person-group><article-title>NCBI GEO: archive for functional genomics data sets&#x02013;update</article-title><source>Nucleic Acids Res.</source><year>2013</year><volume>41</volume><fpage>D991</fpage><lpage>D995</lpage><pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id><?supplied-pmid 23193258?><pub-id pub-id-type="pmid">23193258</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Z</given-names></name><etal/></person-group><article-title>MoleculeNet: a benchmark for molecular machine learning</article-title><source>Chem. Sci.</source><year>2018</year><volume>9</volume><fpage>513</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1039/C7SC02664A</pub-id><?supplied-pmid 29629118?><pub-id pub-id-type="pmid">29629118</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Cortes-Ciriano, I. &#x00026; Bender, A. Concepts and applications of conformal prediction in computational drug discovery. <italic>Artificial Intelligence in Drug Discovery</italic>. 10.1039/9781788016841-00063 (RCS Publishers, 2021).</mixed-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lundberg</surname><given-names>SM</given-names></name><etal/></person-group><article-title>Explainable machine-learning predictions for the prevention of hypoxaemia during surgery</article-title><source>Nat. Biomed. Eng.</source><year>2018</year><volume>2</volume><fpage>749</fpage><lpage>760</lpage><pub-id pub-id-type="doi">10.1038/s41551-018-0304-0</pub-id><?supplied-pmid 31001455?><pub-id pub-id-type="pmid">31001455</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sliwoski</surname><given-names>G</given-names></name><name><surname>Kothiwale</surname><given-names>S</given-names></name><name><surname>Meiler</surname><given-names>J</given-names></name><name><surname>Lowe</surname><given-names>EW</given-names><suffix>Jr.</suffix></name></person-group><article-title>Computational methods in drug discovery</article-title><source>Pharm. Rev.</source><year>2014</year><volume>66</volume><fpage>334</fpage><lpage>395</lpage><pub-id pub-id-type="doi">10.1124/pr.112.007336</pub-id><?supplied-pmid 24381236?><pub-id pub-id-type="pmid">24381236</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanchez-Lengeling</surname><given-names>B</given-names></name><name><surname>Aspuru-Guzik</surname><given-names>A</given-names></name></person-group><article-title>Inverse molecular design using machine learning: generative models for matter engineering</article-title><source>Science</source><year>2018</year><volume>361</volume><fpage>360</fpage><lpage>365</lpage><pub-id pub-id-type="doi">10.1126/science.aat2663</pub-id><pub-id pub-id-type="pmid">30049875</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>St John</surname><given-names>PC</given-names></name><etal/></person-group><article-title>Message-passing neural networks for high-throughput polymer screening</article-title><source>J. Chem. Phys.</source><year>2019</year><volume>150</volume><fpage>234111</fpage><pub-id pub-id-type="doi">10.1063/1.5099132</pub-id><pub-id pub-id-type="pmid">31228909</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mater</surname><given-names>AC</given-names></name><name><surname>Coote</surname><given-names>ML</given-names></name></person-group><article-title>Deep learning in chemistry</article-title><source>J. Chem. Inf. Model</source><year>2019</year><volume>59</volume><fpage>2545</fpage><lpage>2559</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.9b00266</pub-id><?supplied-pmid 31194543?><pub-id pub-id-type="pmid">31194543</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stokes</surname><given-names>JM</given-names></name><etal/></person-group><article-title>A deep learning approach to antibiotic discovery</article-title><source>Cell</source><year>2020</year><volume>180</volume><fpage>688</fpage><lpage>702 e13</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.01.021</pub-id><pub-id pub-id-type="pmid">32084340</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winter</surname><given-names>R</given-names></name><name><surname>Montanari</surname><given-names>F</given-names></name><name><surname>Noe</surname><given-names>F</given-names></name><name><surname>Clevert</surname><given-names>DA</given-names></name></person-group><article-title>Learning continuous and data-driven molecular descriptors by translating equivalent chemical representations</article-title><source>Chem. Sci.</source><year>2019</year><volume>10</volume><fpage>1692</fpage><lpage>1701</lpage><pub-id pub-id-type="doi">10.1039/C8SC04175J</pub-id><?supplied-pmid 30842833?><pub-id pub-id-type="pmid">30842833</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alley</surname><given-names>EC</given-names></name><name><surname>Khimulya</surname><given-names>G</given-names></name><name><surname>Biswas</surname><given-names>S</given-names></name><name><surname>AlQuraishi</surname><given-names>M</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><article-title>Unified rational protein engineering with sequence-based deep representation learning</article-title><source>Nat. Methods</source><year>2019</year><volume>16</volume><fpage>1315</fpage><lpage>1322</lpage><pub-id pub-id-type="doi">10.1038/s41592-019-0598-1</pub-id><?supplied-pmid 31636460?><pub-id pub-id-type="pmid">31636460</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Minnich</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>AMPL: a data-driven modeling pipeline for drug discovery</article-title><source>J. Chem. Inf. Model</source><year>2020</year><volume>60</volume><fpage>1955</fpage><lpage>1968</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.9b01053</pub-id><?supplied-pmid 32243153?><pub-id pub-id-type="pmid">32243153</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duran-Frigola</surname><given-names>M</given-names></name><name><surname>Fernandez-Torras</surname><given-names>A</given-names></name><name><surname>Bertoni</surname><given-names>M</given-names></name><name><surname>Aloy</surname><given-names>P</given-names></name></person-group><article-title>Formatting biological big data for modern machine learning in drug discovery</article-title><source>WIREs Comput. Mol. Sci.</source><year>2019</year><volume>9</volume><fpage>1759</fpage><lpage>0876</lpage></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><etal/></person-group><article-title>A next generation connectivity map: L1000 Platform and the first 1,000,000 profiles</article-title><source>Cell</source><year>2017</year><volume>171</volume><fpage>1437</fpage><lpage>1452.e17</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.10.049</pub-id><?supplied-pmid 29195078?><pub-id pub-id-type="pmid">29195078</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>Open PHACTS: semantic interoperability for drug discovery</article-title><source>Drug Discov. Today</source><year>2012</year><volume>17</volume><fpage>1188</fpage><lpage>1198</lpage><pub-id pub-id-type="doi">10.1016/j.drudis.2012.05.016</pub-id><?supplied-pmid 22683805?><pub-id pub-id-type="pmid">22683805</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodgers</surname><given-names>G</given-names></name><etal/></person-group><article-title>Glimmers in illuminating the druggable genome</article-title><source>Nat. Rev. Drug Discov.</source><year>2018</year><volume>17</volume><fpage>301</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1038/nrd.2017.252</pub-id><?supplied-pmid 29348682?><pub-id pub-id-type="pmid">29348682</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vamathevan</surname><given-names>J</given-names></name><etal/></person-group><article-title>Applications of machine learning in drug discovery and development</article-title><source>Nat. Rev. Drug Discov.</source><year>2019</year><volume>18</volume><fpage>463</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1038/s41573-019-0024-5</pub-id><?supplied-pmid 30976107?><pub-id pub-id-type="pmid">30976107</pub-id></element-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="other">Johnson, J., Matthijs, D. &#x00026; Jegou, H. Billion-scale similarity search with GPUs. <italic>IEEE Transactions on Big Data</italic><ext-link ext-link-type="uri" xlink:href="https://ieeexplore.ieee.org/document/8733051">https://ieeexplore.ieee.org/document/8733051</ext-link> (2019).</mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="other">Zhang, X., Yu, F. X., Kumar, S. &#x00026; Chang, S.-F. Learning spread-out local feature descriptors. <italic>Proc. IEEE Int. Conf. Comput Vis. (ICCV)</italic>, pp. 4595&#x02013;4603 (2017).</mixed-citation></ref><ref id="CR44"><label>44.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Extraction and analysis of signatures from the Gene Expression Omnibus by the crowd</article-title><source>Nat. Commun.</source><year>2016</year><volume>7</volume><fpage>12846</fpage><pub-id pub-id-type="doi">10.1038/ncomms12846</pub-id><?supplied-pmid 27667448?><pub-id pub-id-type="pmid">27667448</pub-id></element-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="other">Bergstra, A., Yamins, D. &#x00026; Cox, D. D. Making a science of model search: hyperparameter optimization in hundreds of dimensions for vision architectures. <italic>JML.org</italic> I-115-I-123 (2013).</mixed-citation></ref><ref id="CR46"><label>46.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bemis</surname><given-names>GW</given-names></name><name><surname>Murcko</surname><given-names>MA</given-names></name></person-group><article-title>The properties of known drugs. 1. Molecular frameworks</article-title><source>J. Med. Chem.</source><year>1996</year><volume>39</volume><fpage>2887</fpage><lpage>2893</lpage><pub-id pub-id-type="doi">10.1021/jm9602928</pub-id><?supplied-pmid 8709122?><pub-id pub-id-type="pmid">8709122</pub-id></element-citation></ref><ref id="CR47"><label>47.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>J</given-names></name><etal/></person-group><article-title>Applying Mondrian cross-conformal prediction to estimate prediction confidence on large imbalanced bioactivity data sets</article-title><source>J. Chem. Inf. Model</source><year>2017</year><volume>57</volume><fpage>1591</fpage><lpage>1598</lpage><pub-id pub-id-type="doi">10.1021/acs.jcim.7b00159</pub-id><?supplied-pmid 28628322?><pub-id pub-id-type="pmid">28628322</pub-id></element-citation></ref><ref id="CR48"><label>48.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bertoni</surname><given-names>M</given-names></name><etal/></person-group><article-title>Bioactivity descriptors for uncharacterized chemical compounds (this paper)</article-title><source>Zenodo</source><year>2021</year><pub-id pub-id-type="doi">10.5281/zenodo.4761691</pub-id></element-citation></ref></ref-list></back></article>