<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">2752621</article-id><article-id pub-id-type="pmid">19667082</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btp477</article-id><article-id pub-id-type="publisher-id">btp477</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>PineSAP&#x02014;sequence alignment and SNP identification pipeline</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wegrzyn</surname><given-names>Jill L.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1"><sup>*</sup></xref></contrib><contrib contrib-type="author"><name><surname>Lee</surname><given-names>Jennifer M.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Liechty</surname><given-names>John</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Neale</surname><given-names>David B.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Plant Sciences and <sup>2</sup>Department of Evolution and Ecology, Address One Shields Ave. University of California, Davis, CA 95616, USA</aff><author-notes><corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: John Quackenbush</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>10</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>10</day><month>8</month><year>2009</year></pub-date><pub-date pub-type="pmc-release"><day>10</day><month>8</month><year>2009</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. --><volume>25</volume><issue>19</issue><fpage>2609</fpage><lpage>2610</lpage><history><date date-type="received"><day>22</day><month>5</month><year>2009</year></date><date date-type="rev-recd"><day>31</day><month>7</month><year>2009</year></date><date date-type="accepted"><day>2</day><month>8</month><year>2009</year></date></history><permissions><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Summary:</bold> The Pine Alignment and SNP Identification Pipeline (PineSAP) provides a high-throughput solution to single nucleotide polymorphism (SNP) prediction using multiple sequence alignments from re-sequencing data. This pipeline integrates a hybrid of customized scripting, existing utilities and machine learning in order to increase the speed and accuracy of SNP calls. The implementation of this pipeline results in significantly improved multiple sequence alignments and SNP identifications when compared with existing solutions. The use of machine learning in the SNP identifications extends the pipeline's application to any eukaryotic species where full genome sequence information is unavailable.</p><p><bold>Availability:</bold> All code used for this pipeline is freely available at the Dendrome project website (<ext-link ext-link-type="uri" xlink:href="http://dendrome.ucdavis.edu/adept2/resequencing.html">http://dendrome.ucdavis.edu/adept2/resequencing.html</ext-link>)</p><p><bold>Contact:</bold> <email>jlwegrzyn@ucdavis.edu</email></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Single nucleotide polymorphism (SNP) detection involves looking across multiple sequence alignments and identifying base discrepancies. The higher the sequence coverage and quality score at a given site, the more confident the SNP prediction. In high-throughput studies, we rely on existing tools to make confident identifications as visual confirmation is not an option. Poor initial alignments can greatly increase both the false positive and false negative rate of SNP predictions. The automated alignment and SNP detection from re-sequencing data where a reference genome sequence is not available is an on-going challenge. Pine (Pinus) sequence data presents an even greater obstacle as it is highly polymorphic (average of one SNP per 50 bases) (Neale, <xref ref-type="bibr" rid="B8">2007</xref>).</p><p>Existing programs such as Phrap (Lee and Vega, <xref ref-type="bibr" rid="B5">2004</xref>) are heavily used for aligning genomic re-sequencing data and providing direct input to SNP prediction programs. Phrap, by definition, is a DNA sequence assembler and does not perform well when paired with the task of aligning highly polymorphic re-sequencing samples. It will often place individuals with different haplotypes into separate contigs. If the stringency of Phrap is reduced (in an attempt to force creation a single contig), misalignments of indels leads to poor overall sequence alignments. Quality benchmarks evaluated across several DNA and RNA aligners found ProbconsRNA (Do <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2005</xref>) to be highly accurate (Carroll <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2007</xref>; Wilm <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2006</xref>), however, it proves to be inhibitive in terms of speed for high-throughput studies.</p><p>SNP identification solutions that can accommodate fluorescence-based re-sequencing reads, often require genomic reference sequence. The utilities PolyPhred (Nickerson <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">1997</xref>) and Polybayes (Marth <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">1999</xref>) rely primarily on quality scores and sequence coverage. In tests utilizing Polybayes and Polyphred in loblolly pine (Pinus taeda L.), we received at best, 78% prediction accuracy with the majority of the discrepancy resulting from false positives. Recently, machine learning techniques have been applied to the problem of computational SNP discovery (Matukumalli <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2006</xref>; Unneberg <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2005</xref>; Zhang <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2005</xref>). Two of these applications rely on either an existing reference genome sequence (Zhang <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2005</xref>) or process EST sequences directly rather than raw tracefiles (Unneberg <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2005</xref>). The SNP-Phage application (Matukumalli <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2006</xref>) can call SNPs from fluorescent reads without a reference sequence, however, attention to the alignments of highly polymorphic organisms prior to SNP calling is not available.</p><p>PineSAP was developed as a high-throughput solution to analyze re-sequencing data in the form of chromatogram files for forward and reverse reads of multiple individuals. The pipeline presented here runs on the Unix/Linux platform and was written in Perl. PineSAP implements a combination of Phred, Phrap and ProbconsRNA to efficiently and accurately call bases and align re-sequencing reads. Following alignment, SNPs and indels are identified through the Polyphred and Polybayes packages. Sequence-based information is extracted and processed through a supervised machine learning algorithm for the purpose of accepting or rejecting the SNP predictions.</p></sec><sec id="SEC2"><title>2 ALIGNMENT</title><p>The alignment section of the pipeline implements a de-coupled and modified version of phredPhrap on the original chromatogram files. Phred (Ewing <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">1998</xref>) is responsible for the base calls and the assignment of quality scores. Phred is integrated into this pipeline with parameters to trim low quality ends in order to prevent alignment issues from bases in these regions. Conservative Phrap parameters are applied to prevent any misalignments in the resulting contigs and to ensure that all reads are retained.</p><p>Contig consensus sequences are exported from the ace format file generated from phredPhrap and aligned with ProbconsRNA. For each contig, an aligned FASTA file is created with each read in the contig aligned to the consensus sequence. These files along with the aligned file of all contig consensus sequences are used to generate a single multi-sequence FASTA file. In this file, each read is aligned to an overall consensus for the amplicon based on the alignment in the ProbconsRNA output and each read's alignment to the consensus sequence of its member contig. The final multi-sequence aligned FASTA file is converted back to an ace formatted file suitable for input to Polybayes and Polyphred.</p></sec><sec id="SEC3"><title>3 SNP CALLING</title><p>The purpose of the classifier is to evaluate the accuracy of the SNP calls resulting from Polyphred and Polybayes. Sequence-based statistics were derived through a customized feature extraction program and fed as a vector for each polymorphism to the J48 classification tree available in the WEKA classifier package. The final set of features identified fully represents the local and global sequence variation, alignment depth and quality, local and global base quality and sequence alignment quality. From the set of 300 used for training, all of the true positive and false negative vectors are represented as real SNPs and the true negative and false positive vectors as non-SNPs. The resulting SNP calls were extracted from their respective output files flanking sequence, quality scores and a normalized confidence score.</p></sec><sec id="SEC4"><title>4 VALIDATION</title><p>Manual validation of the alignments was completed with the same 300 loblolly pine amplicons. Each amplicon had between 8 and 36 reads. With Phrap alone and default parameters, 23% of the amplicons were placed in a single contig, 27% into two and 20% into three. Amplicons with two or more contigs could be forced into a single contig 82% of the time, however there are problems with the alignment in 34% of cases. The alignment method implemented in PineSAP improves the success rate to 98%.</p><p>When evaluated in terms of speed, the alignment method described above was run with a straight ProbconsRNA implementation. We determined it would take &#x0223c;25 times longer to process 36 sequences per amplicon.</p><p>The classification tree generated from the training sequences was tested against a unique set of 120 sequences with 563 manually validated SNPs. All SNP calls were identified as based on visual inspection of Polyphred and Polybayes predictions in Consed (Gordon <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">1998</xref>). The classification tree resulted in a significant overall improvement with a calculated accuracy of 93.6% (<xref ref-type="table" rid="T1">Table 1</xref>).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Results of SNP prediction on the test sequence data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Evaluation</th><th align="left" rowspan="1" colspan="1">J48</th><th align="left" rowspan="1" colspan="1">Polyphred</th><th align="left" rowspan="1" colspan="1">Polybayes</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">Accuracy</td><td align="left" rowspan="1" colspan="1">93.6</td><td align="left" rowspan="1" colspan="1">76.25</td><td align="left" rowspan="1" colspan="1">78.02</td></tr><tr><td align="left" rowspan="1" colspan="1">Sensitivity</td><td align="left" rowspan="1" colspan="1">88.21</td><td align="left" rowspan="1" colspan="1">83.22</td><td align="left" rowspan="1" colspan="1">86.54</td></tr><tr><td align="left" rowspan="1" colspan="1">Specificity</td><td align="left" rowspan="1" colspan="1">98.73</td><td align="left" rowspan="1" colspan="1">N/A</td><td align="left" rowspan="1" colspan="1">N/A</td></tr></tbody></table></table-wrap>
</p></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We would like to thank all the students that worked on the validation for both the alignments and SNP calls.</p><p><italic>Funding</italic>: Association Genetics of Natural Genetic Variation and Complex Traits in Pine &#x02013; NSF 0501763.</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carroll</surname><given-names>H</given-names></name><etal/></person-group><article-title>DNA reference alignment benchmarks based on tertiary structure of encoded proteins</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2648</fpage><lpage>2649</lpage><pub-id pub-id-type="pmid">17686799</pub-id></element-citation></ref><ref id="B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Do</surname><given-names>CB</given-names></name><etal/></person-group><article-title>ProbCons: probabilistic consistency-based multiple sequence alignment</article-title><source>Genome Res.</source><year>2005</year><volume>15</volume><fpage>330</fpage><lpage>340</lpage><pub-id pub-id-type="pmid">15687296</pub-id></element-citation></ref><ref id="B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ewing</surname><given-names>B</given-names></name><etal/></person-group><article-title>Base-calling of automated sequencer traces using phred. I. Accuracy assessment</article-title><source>Genome Res.</source><year>1998</year><volume>8</volume><fpage>175</fpage><lpage>185</lpage><pub-id pub-id-type="pmid">9521921</pub-id></element-citation></ref><ref id="B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gordon</surname><given-names>D</given-names></name><etal/></person-group><article-title>Consed: a graphical tool for sequence finishing</article-title><source>Genome Res.</source><year>1998</year><volume>8</volume><fpage>195</fpage><lpage>202</lpage><pub-id pub-id-type="pmid">9521923</pub-id></element-citation></ref><ref id="B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>WH</given-names></name><name><surname>Vega</surname><given-names>VB</given-names></name></person-group><article-title>Heterogeneity detector: finding heterogeneous positions in Phred/Phrap assemblies</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>2863</fpage><lpage>2864</lpage><pub-id pub-id-type="pmid">15130927</pub-id></element-citation></ref><ref id="B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marth</surname><given-names>GT</given-names></name><etal/></person-group><article-title>A general approach to single-nucleotide polymorphism discovery</article-title><source>Nature Genet.</source><year>1999</year><volume>23</volume><fpage>452</fpage><lpage>456</lpage><pub-id pub-id-type="pmid">10581034</pub-id></element-citation></ref><ref id="B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matukumalli</surname><given-names>LK</given-names></name><etal/></person-group><article-title>Application of machine learning in SNP discovery</article-title><source>BMC Bioinformatics</source><year>2006</year><volume>7</volume><fpage>4</fpage><pub-id pub-id-type="pmid">16398931</pub-id></element-citation></ref><ref id="B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neale</surname><given-names>DB</given-names></name></person-group><article-title>Genomics to tree breeding and forest health</article-title><source>Curr. Opin. Genet. Dev.</source><year>2007</year><volume>17</volume><fpage>539</fpage><lpage>544</lpage><pub-id pub-id-type="pmid">18060764</pub-id></element-citation></ref><ref id="B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nickerson</surname><given-names>DA</given-names></name><etal/></person-group><article-title>PolyPhred: automating the detection and genotyping of single nucleotide substitutions using fluorescence-based re-sequencing</article-title><source>Nucleic Acids Res.</source><year>1997</year><volume>25</volume><fpage>2745</fpage><lpage>2751</lpage><pub-id pub-id-type="pmid">9207020</pub-id></element-citation></ref><ref id="B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Unneberg</surname><given-names>P</given-names></name><etal/></person-group><article-title>SNP discovery using advanced algorithms and neural networks</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>2528</fpage><lpage>2530</lpage><pub-id pub-id-type="pmid">15746291</pub-id></element-citation></ref><ref id="B11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilm</surname><given-names>A</given-names></name><etal/></person-group><article-title>An enhanced RNA alignment benchmark for sequence alignment programs</article-title><source>Algorithms Mol. Biol.</source><year>2006</year><volume>1</volume><fpage>19</fpage><pub-id pub-id-type="pmid">17062125</pub-id></element-citation></ref><ref id="B12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><etal/></person-group><article-title>SNPdetector: a software tool for sensitive and accurate SNP detection</article-title><source>PLoS Comput. Biol.</source><year>2005</year><volume>1</volume><fpage>e53</fpage><pub-id pub-id-type="pmid">16261194</pub-id></element-citation></ref></ref-list></back></article>