<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id><journal-title-group><journal-title>BMC Genomics</journal-title></journal-title-group><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6929456</article-id><article-id pub-id-type="publisher-id">6305</article-id><article-id pub-id-type="doi">10.1186/s12864-019-6305-x</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>scReClassify: post hoc cell type classification of single-cell rNA-seq data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kim</surname><given-names>Taiyun</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Lo</surname><given-names>Kitty</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Geddes</surname><given-names>Thomas A.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Kim</surname><given-names>Hani Jieun</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Jean Yee Hwa</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1098-3138</contrib-id><name><surname>Yang</surname><given-names>Pengyi</given-names></name><address><email>pengyi.yang@sydney.edu.au</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 834X</institution-id><institution-id institution-id-type="GRID">grid.1013.3</institution-id><institution>School of Mathematics and Statistics, Faculty of Science, The University of Sydney, </institution></institution-wrap>2006 NSW, Australia </aff><aff id="Aff2"><label>2</label>Computational Systems Biology Group, Children&#x02019;s Medical Research Institute, Faculty of Medicine and Health, The University of Sydney, 2145 NSW, Australia </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 834X</institution-id><institution-id institution-id-type="GRID">grid.1013.3</institution-id><institution>Charles Perkins Centre, The University of Sydney, </institution></institution-wrap>2006 NSW, Australia </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 834X</institution-id><institution-id institution-id-type="GRID">grid.1013.3</institution-id><institution>School of Life and Environmental Sciences, Faculty of Science, The University of Sydney, </institution></institution-wrap>2006 NSW, Australia </aff></contrib-group><pub-date pub-type="epub"><day>24</day><month>12</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>24</day><month>12</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>20</volume><issue>Suppl 9</issue><elocation-id>913</elocation-id><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p id="Par1">Single-cell RNA-sequencing (scRNA-seq) is a fast emerging technology allowing global transcriptome profiling on the single cell level. Cell type identification from scRNA-seq data is a critical task in a variety of research such as developmental biology, cell reprogramming, and cancers. Typically, cell type identification relies on human inspection using a combination of prior biological knowledge (e.g. marker genes and morphology) and computational techniques (e.g. PCA and clustering). Due to the incompleteness of our current knowledge and the subjectivity involved in this process, a small amount of cells may be subject to mislabelling.</p></sec><sec><title>Results</title><p id="Par2">Here, we propose a semi-supervised learning framework, named scReClassify, for &#x02018;post hoc&#x02019; cell type identification from scRNA-seq datasets. Starting from an initial cell type annotation with potentially mislabelled cells, scReClassify first performs dimension reduction using PCA and next applies a semi-supervised learning method to learn and subsequently reclassify cells that are likely mislabelled initially to the most probable cell types. By using both simulated and real-world experimental datasets that profiled various tissues and biological systems, we demonstrate that scReClassify is able to accurately identify and reclassify misclassified cells to their correct cell types.</p></sec><sec><title>Conclusions</title><p id="Par3">scReClassify can be used for scRNA-seq data as a post hoc cell type classification tool to fine-tune cell type annotations generated by any cell type classification procedure. It is implemented as an R package and is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/SydneyBioX/scReClassify">https://github.com/SydneyBioX/scReClassify</ext-link></p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Single-cell RNA-seq</kwd><kwd>scRNA-seq</kwd><kwd>Cell type classification</kwd><kwd>Class label noise</kwd></kwd-group><conference xlink:href="https://incob2019.org/"><conf-name>International Conference on Bioinformatics (InCoB 2019)</conf-name><conf-acronym>InCoB 2019</conf-acronym><conf-loc>Jakarta, Indonesia</conf-loc><conf-date>10-12 September 2019</conf-date></conference><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>Accurate identification of cell types from complex tissues across different organisms is critical for research in developmental biology [<xref ref-type="bibr" rid="CR1">1</xref>] and cell reprogramming [<xref ref-type="bibr" rid="CR2">2</xref>]. It is also an essential step towards a comprehensive understanding of the formation of complex organs such as heart [<xref ref-type="bibr" rid="CR3">3</xref>], brain [<xref ref-type="bibr" rid="CR4">4</xref>], and liver [<xref ref-type="bibr" rid="CR5">5</xref>], and various cancers [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Single-cell RNA sequencing (scRNA-seq), a technique that allows the transcriptomes of individual cells to be quantified, has become the key enabling technology for profiling cell types [<xref ref-type="bibr" rid="CR8">8</xref>]. Significant effort and resources have been devoted for cell type profiling, such as the building of the mouse cell atlas [<xref ref-type="bibr" rid="CR9">9</xref>] and the ongoing effort to generate the human cell atlas [<xref ref-type="bibr" rid="CR10">10</xref>], but the accurate identification of the cell types based on scRNA-seq data remains a significant challenge [<xref ref-type="bibr" rid="CR11">11</xref>].</p><p>Typically, cell types can be identified from scRNA-seq data by human inspection using a combination of prior biological knowledge such as marker genes, cell type specific characteristics such as morphologies, physiologies and functions [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] and visualisation and unsupervised computational techniques such as principal component analysis (PCA), t-distributed stochastic neighbor embedding (tSNE) [<xref ref-type="bibr" rid="CR14">14</xref>], self-organizing maps (SOMs) [<xref ref-type="bibr" rid="CR15">15</xref>], and various clustering approaches [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Although these approaches can often lead to the correct identification of the majority of the cells in a scRNA-seq experiment, a small amount of cells may be mislabelled due to the incompleteness of our current knowledge and the subjectivity involved in the process [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>].</p><p>More recently, various supervised learning methods have been proposed for classifying cell types based on large collections of cell atlases [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], mapping cell types [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] and subtypes [<xref ref-type="bibr" rid="CR24">24</xref>] across multiple scRNA-seq datasets, and predicting cell types in a scRNA-seq dataset by transfer learning from multiple related scRNA-seq datasets [<xref ref-type="bibr" rid="CR25">25</xref>]. While these developments create new avenues for cell type identification, all these methods assume the cell type annotation in the training dataset is completely and perfectly defined beforehand, and therefore, their performance may suffer when mislabelled cells are present in the training dataset.</p><p>In this paper, we propose a post hoc cell type identification procedure to correct for any potentially mislabelled cells in a scRNA-seq dataset. To achieve this, we formulate the task of cell type identification as a machine learning problem in the presence of label noise [<xref ref-type="bibr" rid="CR26">26</xref>], and apply a semi-supervised learning framework (named scReClassify) to identify potentially mislabelled cells and subsequently reclassify them to their correct cell types (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). Specifically, scReClassify first reduces the dimensionality of scRNA-seq gene expression data into principal components (PCs) and subsequently applies a soft-label learning step, an extension to our recently proposed AdaSampling procedure [<xref ref-type="bibr" rid="CR27">27</xref>], to create a model using the initial cell type annotations and reclassifies potentially mislabelled cells into their correct categories.
<fig id="Fig1"><label>Fig. 1</label><caption><p>An illustration of the scReClassify framework. <bold>a</bold> The initial cell type annotation. This is typically achieved by using a combination of biological knowledge and computational approach. <bold>b</bold> Correction of mislabelled cells using an AdaSampling procedure. The dimensionality of the gene expression matrix is first reduced by PCA and mislabelled cells are identified and reclassified to their correct cell types by using AdaSampling with either a support vector machine (SVM) or a random forest (RF) classifier or an ensemble of SVMs or RFs</p></caption><graphic xlink:href="12864_2019_6305_Fig1_HTML" id="MO1"/></fig></p><p>We evaluate the performance of scReClassify using both simulated datasets as well as real-world experimental datasets encompassing various tissues and biological systems. Our benchmark experiments and case studies demonstrate that scReClassify is able to accurately identify mislabelled cells in scRNA-seq datasets and reclassify them to their correct cell types. We envisage scReClassify to be used as a post hoc cell type classification tool, after standard cell type identification procedure has been performed, to fine-tune cell type annotations in scRNA-seq data analysis.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Evaluation of scReClassify on simulated datasets</title><p>To study the behaviour of scReClassify in learning from and correcting the initial cell type labels, we first tested its performance on synthetic scRNA-seq datasets with 10% or 20% mislabelled cells (i.e. <italic>&#x003c1;</italic>=0.1 or 0.2). The left panels in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a and b visualise the true cell types and the mislabelled cells in the initial cell type labels in the two simulated datasets. After applying scReClassify with either SVM or RF as the base classifier, most of the mislabelled cells were corrected (accuracy up to 99%) with very few remaining mislabelled cells.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Evaluation of scReClassify on simulated datasets. In (<bold>a</bold>) and (<bold>b</bold>), each cell is shown as a solid point on each tSNE plot and coloured coded by its true cell type. The initial cell type labels (left panels in A and B) are the true cell types but with either 10% (<bold>a</bold>) or 20% (<bold>b</bold>) mislabelling. The solid point with an open ring represent incorrectly label cells and the ring colour represent the mislabelled type. In (<bold>c</bold>) and (<bold>d</bold>), scRNA-seq with varying percentages of mislabelled cells were simulated. Baselines represent the (<bold>c</bold>) mean accuracy and (<bold>d</bold>) adjusted Rand index (ARI) calculated from the ground truth and the initial annotations. Performance of scReClassify are shown as boxes coloured according to the percentages of mislabelled cells</p></caption><graphic xlink:href="12864_2019_6305_Fig2_HTML" id="MO2"/></fig></p><p>Unsurprisingly, the performance of scReClassify is affected by the quality of the initial cell type labels and a higher mislabelling percentage in the initial annotation is likely to result in more uncorrected cells even after applying scReClassify (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>). To investigate the relationship between the percentage of mislabelling in the initial annotation and the performance of scReClassify, we varied the range of <italic>&#x003c1;</italic> from 0.1 to 0.5 and assessed the performance of scReClassify on label correction of mislabelled cells using both mean classification accuracy and ARI (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>c and d). We found that in most cases scReClassify resulted in less mislabelled cells when <italic>&#x003c1;</italic> was set to less than or equal to 0.4 and, unsurprisingly, scReClassify was unable to improve cell type labels when half of the cells were mislabelled in their initial annotation (<italic>&#x003c1;</italic>=0.5). In particular, scReClassify with SVM showed notably better performance than with RF according to both mean accuracy (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>c) and ARI (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>d). These results suggest that RF in comparison to SVM may be more susceptible to overfitting and therefore leads to less efficient correction of mislabelled cells. Overall, scReClassify shows a robust performance when the level of mislabelled cells is low, and this is particularly apparent when <italic>&#x003c1;</italic>&#x02264; 0.4 and SVM was used as the base classifier (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>c).</p></sec><sec id="Sec4"><title>Determining ensemble size</title><p>One of the key parameters that may affect the performance of scReClassify is the number of base classifiers used to form the ensemble. To determine the minimum ensemble size required to achieve sufficient performance, we varied the number of base classifiers used to form the ensemble in scReClassify from 10 to 50 with a step of 10 and evaluated their performance using simulated scRNA-seq datasets with five cell types and <italic>&#x003c1;</italic> ranged from 0.1 to 0.5 (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>). We found the ensemble models of SVM and RF were better than their singles (i.e. ensemble size of 1) when the noise ratio was small <italic>&#x003c1;</italic>&#x02264; 0.2). However, only SVM maintained significant improvements when <italic>&#x003c1;</italic> increased to 0.3 and 0.4. Overall, the improvement of ensemble models over their respective single model was mild and an ensemble size of 10 was sufficient for achieving desirable performance of scReClassify.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Ensemble size of scReClassify. The x-axis shows the number of base classifiers used to form the ensemble in scReClassify. Each line shows the mean cell type classification accuracy under different levels of call type label noise and using different ensemble sizes</p></caption><graphic xlink:href="12864_2019_6305_Fig3_HTML" id="MO3"/></fig></p></sec><sec id="Sec5"><title>Evaluation of scReClassify on experimental datasets</title><p>To test if scReClassify can correctly reclassify mislabelled cells in real-world scRNA-seq datasets generated from diverse biological systems, we introduced different proportions of mislabelled cells (<italic>&#x003c1;</italic> range from 0.1 to 0.5), as was done for the simulated datasets, to each of the four experimental datasets as detailed in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of experimental scRNA-seq datasets used for method evaluation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">ID</th><th align="left">Publication</th><th align="left">Description</th><th align="left">Organism</th><th align="left"># cell</th><th align="left"># class</th><th align="left">Protocol</th></tr></thead><tbody><tr><td align="left">E-MTAB-3929</td><td align="left">[<xref ref-type="bibr" rid="CR1">1</xref>]</td><td align="left">Early human development</td><td align="left">Human</td><td align="left">1059</td><td align="left">3</td><td align="left">SMART-Seq2</td></tr><tr><td align="left">GSE87795</td><td align="left">[<xref ref-type="bibr" rid="CR5">5</xref>]</td><td align="left">Fetal liver development</td><td align="left">Mouse</td><td align="left">367</td><td align="left">6</td><td align="left">SMARTer</td></tr><tr><td align="left">GSE60361</td><td align="left">[<xref ref-type="bibr" rid="CR4">4</xref>]</td><td align="left">Cortex and hippocampus</td><td align="left">Mouse</td><td align="left">3005</td><td align="left">7</td><td align="left">SMARTer</td></tr><tr><td align="left">GSE82187</td><td align="left">[<xref ref-type="bibr" rid="CR28">28</xref>]</td><td align="left">Striatum</td><td align="left">Mouse</td><td align="left">705</td><td align="left">10</td><td align="left">SMARTer</td></tr></tbody></table></table-wrap></p><p>We found that in most cases scReClassify with either SVM or RF reduced the number of mislabelled cells. However, the improvements in terms of both mean accuracy and ARI are lower than those observed in simulations (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). One possible explanation is that there may be a proportion of mislabelled cells in each of four real-world experimental datasets even before the post hoc introduction of mislabelled cells. Furthermore, the performance of scReClassify also appears to be dataset dependent. For example, the reductions on mislabelled cells in the fetal liver development dataset [<xref ref-type="bibr" rid="CR5">5</xref>] and in datasets that profiles different types of brain tissues [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] are relatively higher than that in early human development dataset [<xref ref-type="bibr" rid="CR1">1</xref>]. This may be due to the biological signal-to-noise ratios and unique structural properties inherent in each dataset. Consistent with the simulation results, scReClassify with SVM shows better performance than those from using RF. Also in agreement with the simulation results, a clear reduction of mislabelled cells is achieved by scReClassify with SVM when the level of noise <italic>&#x003c1;</italic> is smaller or equal to 0.4, and scReClassify is unable to reduce the percentage of mislabelled cells when <italic>&#x003c1;</italic>=0.5.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Evaluation of scReClassify on experimental datasets. Varying percentages of mislabelled cells were introduced to each scRNA-seq dataset to create an initial cell type annotation with different level of label noise (<italic>&#x003c1;</italic> range from 0.1 to 0.5). The performance in terms of mean accuracy (<bold>a</bold>) and ARI (<bold>b</bold>) calculated from the gold standard cell type annotation (annotation of each dataset from its original studies) and the initial cell type annotation (baseline), and the scReClassify corrected cell type annotation. scReClassify was repeated 10 times to capture the variability and shown as boxes coloured according to the percentages of mislabelled cells</p></caption><graphic xlink:href="12864_2019_6305_Fig4_HTML" id="MO4"/></fig></p><p>Comparing the performance of scReClassify with baseline (calculated from the ground truth and the initial noisy cell type annotations) on the early human development dataset [<xref ref-type="bibr" rid="CR1">1</xref>], it appears that at <italic>&#x003c1;</italic>=0.1 there is no improvement based on mean accuracy (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>a) but ARI indicates a clear improvement of cell type classification after applying scReClassify (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>b). This is because the mean accuracy metric does not take into consideration the size difference of the cell types (i.e. number of cells annotated as Epiblast, Endoderm, and Trophectoderm are 122, 105, and 832) whereas ARI account for such size differences among different cell types [<xref ref-type="bibr" rid="CR29">29</xref>]. This demonstrate the importance to measure performance using different metrics. Together, these results suggest that scReClassify can recover mislabelled cells in both simulated datasets and real-world scRNA-seq datasets even when a large proportion of the cells are mislabelled initially.</p></sec><sec id="Sec6"><title>scReClassify identifies and corrects potentially misclassified cells in experimental datasets</title><p>Since the performance of scReClassify on real-world experimental datasets is lower than those from simulated datasets, we hypothesized that a small proportion of cells may be mislabelled in each of four real-world experimental datasets even before our post hoc introduction of mislabelled cells. We therefore applied scReClassify (using SVM as the base classifier) to correct the cell type annotation of each dataset obtained directly from their original study. This has led to the correction of 28 [<xref ref-type="bibr" rid="CR1">1</xref>], 12 [<xref ref-type="bibr" rid="CR5">5</xref>], 73 [<xref ref-type="bibr" rid="CR4">4</xref>], and 9 [<xref ref-type="bibr" rid="CR28">28</xref>] cells corresponding to 2.6%, 3.3%, 2.4%, and 1.3% of all cells in each of the four datasets.</p><p>We next performed case studies to validate some of the cells that are re-classified by scReClassify to a different cell type from their original annotation. Specifically, for the early human development dataset, we defined three marker genes for each of the three cell types in the dataset based on literature. These are Sox2, Nanog, and Tdgf1 for cells from Epiblast; Pdgfra, Gata4, and Sox17 for cells from Endoderm; and Gata2, Gata3, and Krt18 for cells from Trophectoderm. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a highlights six cells that represent all possible combinations of re-classification in which cells that are originally labeled as Endoderm (E5.40.3289) or Trophectoderm (E7.8.318) and are re-classified as Epiblast; cells that are originally labeled as Epiblast (E5.1.26) or Trophectoderm (E6.14.1433) and are re-classified as Endoderm; and cells that are originally labeled as Epiblast (E7.8.333) or Endoderm (E7.11.853) and are re-classified as Trophectoderm. As can be seen from Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a, the re-classified cell types fit significantly better to the marker genes than the originally assigned cell type for all six cells. Similarly, Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>b highlights six cells from four cell types that are re-classified to a different cell type from their original cell type assignment in the fetal liver development dataset [<xref ref-type="bibr" rid="CR5">5</xref>]. Again, the marker genes curated from literature clearly support these re-classification compared to their original cell type classification.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of gene expression levels of reclassified cells in cell type specific markers for early human development dataset (<bold>a</bold>) and fetal liver development dataset (<bold>b</bold>). The x-axis of the plots are grouped by cell types and the y-axis represent log2 transformed expression values. The boxes (coloured by cell types) represent expression distribution of corresponding cell type in the dataset. The red markers indicate the marker gene expression levels of the reclassified cell in the reassigned cell type. For each reclassified cell, the black arrows indicate the cell type annotation from its original publication and the red arrows indicate the newly scReClassify assigned cell type</p></caption><graphic xlink:href="12864_2019_6305_Fig5_HTML" id="MO5"/></fig></p><p>Together, these results indicate that a small proportion of cells are quite possibly misclassified in their original studies and scReClassify can serve as an effective tool to identify and reclassify these cells to their most likely cell type categories.</p></sec></sec><sec id="Sec7" sec-type="discussion"><title>Discussion</title><p>Cell type identification is an essential task in scRNA-seq data analysis. While a large number of methods have been proposed for achieving this goal, current methods typically rely on some form of prior biological knowledge, orthogonal biological data and/or computational techniques to assign cells to a set of possible cell types. These knowledge and empirical based approaches are likely to result in a small fraction of cells being incorrectly assigned to cell type. To fine-tune the initial annotations derived from experimental data, we proposed scReClassify, a post hoc cell type classification tool based on a semi-supervised learning approach. Taking the initial cell type annotations as soft-labels, it subsequently identifies and reclassifies potentially misclassified cells.</p><p>Current implementation of scReClassify does not take into consideration the sizes of different cell types in a scRNA-seq dataset. This is apparent when it is applied to early human development dataset [<xref ref-type="bibr" rid="CR1">1</xref>]. While scReClassify did reduce the total number of misclassified cells according on ARI (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>b), the reduction on average mislabelling rate across each cell type is less drastic. One future extension of scReClassify is to account for the unequal size of cell types which in supervised learning is known as imbalanced classification problem [<xref ref-type="bibr" rid="CR30">30</xref>]. To this end, different sampling and cost-sensitive learning methods could be considered. Another related extension of scReClassify is to estimate and account for different percentage of mislabelled cells. That is, the percentage of mislabelled cells in each cell type may be different from other cell types in a scRNA-seq dataset. Therefore, the sampling probabilities applied to each cell type may need to account for such differences in order to overcome classification bias towards cell types that are large and with lower proportion of mislabelled cells.</p><p>In scRNA-seq experiments, rare cell types with subtle difference in their transcriptome profiles are more likely to be mislabelled than large cell types with distinctive difference in their transcriptome profiles in comparison to other cell types. Moreover, cell types that are closely related to other and located in the ambiguous regions of the decision boundary are more likely to be mislabelled. The current model does not account for such a nonrandomness in cell type mislabelling. Modelling the nonrandom mislabelling in the initial cell type annotations may lead to further improvement of scReClassify performance. In addition, we found the performance of scReClassify scales well with different numbers of cell types, ranging from 3 to 10. Yet, given that large scRNA-seq datasets with considerably more cell types are increasingly common (such as the mouse and human cell atlas initiatives), it will be useful to assess the scalability of scReClassify on datasets with significantly more cells and much larger number of cell types.</p><p>While our application to the four experimental scRNA-seq datasets show reclassification of a relatively small percentage of cells from their original annotations, suggesting that the original cell type annotations are mostly high quality, our evaluation experiments on both simulation and these four real-world datasets demonstrate that scReClassify is robust even when the noise level is significantly higher. Therefore, the utility of scReClassify could become more apparent when the original annotation less from perfect.</p></sec><sec id="Sec8" sec-type="conclusion"><title>Conclusion</title><p>In summary, we have implemented a post hoc classification tool, scReClassify, to fine-tune cell type annotations generated using any methods in scRNA-seq datasets. As a simple, easy to use R package, we hope scReClassify will be a useful addition to the scRNA-seq data analysis toolkit.</p></sec><sec id="Sec9"><title>Methods</title><sec id="Sec10"><title>The scReClassify framework</title><p>Here we summarise the proposed framework of scReClassify. Briefly, scReClassify (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>) expects an <italic>N</italic>&#x000d7;<italic>M</italic> expression matrix (denoted as <italic>X</italic>) with <italic>N</italic> being the number of cells and <italic>M</italic> being the number of genes. Importantly, it also expects that an initial cell type annotation of cells (denoted as <bold>y</bold>) is available. This initial cell type annotation may be inferred using prior biological knowledge such as cell functions, morphologies, physiologies and marker genes, and computational techniques such as PCA, tSNE, clustering and SOMs, or combinations of these approaches. Assuming both <italic>X</italic> and <bold>y</bold> are given for a scRNA-seq dataset, scReClassify performs post hoc cell type classification by first using PCA (&#x0201c;<xref rid="Sec4" ref-type="sec">Determining ensemble size</xref>&#x0201d; section) to reduce the dimensionality of the expression matrix and then applying a semi-supervised learning procedure, AdaSampling (&#x0201c;<xref rid="Sec12" ref-type="sec">AdaSampling and ensemble learning</xref>&#x0201d; section), to learn and adjust cell type labels for cells that are likely to be mislabelled in the initial annotation.</p></sec><sec id="Sec11"><title>The PCA dimension reduction procedure</title><p>Due to the high feature-dimensionality (i.e. the large number of measured genes in each cell) and that only a small fraction of them are cell type-specific and therefore are informative for cell type identification, it is often necessary to apply dimension reduction techniques prior to downstream cell type identification and analysis [<xref ref-type="bibr" rid="CR16">16</xref>].</p><p>Starting from the original scRNA-seq expression dataset, which we denote as an <italic>N</italic>&#x000d7;<italic>M</italic> matrix as previously described, we apply PCA to perform dimension reduction. We select the number of PCs to use (<italic>M</italic><sup>&#x02032;</sup>) by first determining <italic>d</italic>, the number of PCs required to capture at least 70% of overall variability in the dataset. If <italic>d</italic> falls outside of the range of 10 and 20, we set <italic>M</italic><sup>&#x02032;</sup> to either be 10 or 20 (summarised in Eq. <xref rid="Equ1" ref-type="">1</xref>). After the PCA procedure, the dimension of our original expression matrix will be reduced to <italic>N</italic>&#x000d7;<italic>M</italic><sup>&#x02032;</sup>.
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  M' = \left\{ \begin{array}{ll} 10, &#x00026; d &#x0003c; 10 \\ d, &#x00026; 10 \leq d \leq 20 \\ 20, &#x00026; d &#x0003e; 20 \end{array} \right.  $$ \end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mn>10</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>d</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mn>10</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>d</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mn>10</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>d</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mn>20</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>20</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>d</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>20</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2019_6305_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec12"><title>AdaSampling and ensemble learning</title><p>Most scRNA-seq studies annotate each cell profiled in the experiments by its most likely cell type, and classify all cells into a finite set of cell types. Due to the technical limitations and/or limitations in current biological knowledge, the cell type annotation for a given scRNA-seq dataset may contain a proportion of mislabelled cells (a.k.a label noise and denoted as <italic>&#x003c1;</italic>). AdaSampling is a wrapper approach that couples a weighted sampling procedure with a probabilistic classification model for learning and correcting mislabelled instances in a dataset [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. Here we extend AdaSampling for multi-class classification and tailor its application for scRNA-seq datasets.</p><p>Let us denote the initial observed cell type labels as <italic>y</italic><sub><italic>i</italic></sub>=<italic>k</italic>, where <italic>k</italic>&#x02208;{1,...,<italic>K</italic>} and <italic>K</italic> is the total number of cell types in a dataset, and <italic>i</italic> denotes cell index, where <italic>i</italic>&#x02208;{1,...,<italic>N</italic>} and <italic>N</italic> is the total number of cells. In a multi-class classification problem (<italic>K</italic>&#x02265; 3), the probability of a cell being mislabelled <italic>&#x003b5;</italic><sub><italic>i</italic></sub> can be estimated by a probabilistic classification model as follows:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \varepsilon_{i} = P(\hat{y}_{i} \neq k | \mathbf{\mathrm{x}}_{i},y_{i} = k, D_{\rho}) = 1 - P(\hat{y}_{i} = k | \mathbf{\mathrm{x}}_{i},y_{i} = k, D_{\rho})  $$ \end{document}</tex-math><mml:math id="M4"><mml:mspace width="-15.0pt"/><mml:msub><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x00177;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02260;</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x00177;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12864_2019_6305_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p>where <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P(\hat {y}_{i} \neq k |\mathbf {\mathrm {x}}_{i},y_{i} = k, D_{\rho })$\end{document}</tex-math><mml:math id="M6"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x00177;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02260;</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2019_6305_Article_IEq1.gif"/></alternatives></inline-formula> is the probability of the <italic>i</italic>th cell with a pre-assigned type of <italic>k</italic> been classified as a cell type that is not <italic>k</italic> by a given classifier trained on the dataset <italic>D</italic><sub><italic>&#x003c1;</italic></sub>. Here x<sub><italic>i</italic></sub>&#x02208;<italic>X</italic> is the expression profile of the <italic>i</italic>th cell.</p><p>To identify these mislabelled cells and subsequently reclassify them to their correct cell types, AdaSampling starts by treating all cells with uniform probability <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {1}{n}$\end{document}</tex-math><mml:math id="M8"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12864_2019_6305_Article_IEq2.gif"/></alternatives></inline-formula> of being selected and training a given classification model on <italic>D</italic><sub><italic>&#x003c1;</italic></sub> that estimate the mislabelling probability of each cell using Eq. (<xref rid="Equ2" ref-type="">2</xref>). Subsequently, AdaSampling applies a weighted sampling from <italic>D</italic><sub><italic>&#x003c1;</italic></sub> in which each cell <italic>i</italic> will have a probability of 1&#x02212;<italic>&#x003b5;</italic><sub><italic>i</italic></sub> to be included in the updated training data <italic>D</italic><sub><italic>&#x003c1;</italic>,<italic>l</italic></sub> (where <italic>l</italic>=1,...,<italic>L</italic> denotes number of iterations). In other words, cells that are likely to be mislabelled (i.e. those with large <italic>&#x003b5;</italic><sub><italic>i</italic></sub>) will have less chance to be included in next iteration of model training. This procedure iteratively improves the accuracy of the trained classification model by improving the quality of the cell labels included in training the model. Our previous evaluation suggests that only a few iteration is needed to achieve a good performance [<xref ref-type="bibr" rid="CR31">31</xref>]. Our implemented package allows users to specify this parameter and a default of 3 iterations was used in this study.</p><p>The final estimation of mislabelling probability for each cell is <italic>&#x003b5;</italic><sub><italic>i</italic>,<italic>L</italic></sub> (<italic>i</italic>=1,...,<italic>N</italic>). A <italic>&#x003b5;</italic><sub><italic>i</italic>,<italic>L</italic></sub> weighted sampling from <italic>D</italic><sub><italic>&#x003c1;</italic></sub> can be applied to generate the final training dataset <italic>D</italic><sub><italic>&#x003c1;</italic>,<italic>L</italic>+1</sub>, and the classification model trained on <italic>D</italic><sub><italic>&#x003c1;</italic>,<italic>L</italic>+1</sub> can be used to reclassify all cells in the original dataset <italic>D</italic><sub><italic>&#x003c1;</italic></sub>. Alternatively, <italic>&#x003b5;</italic><sub><italic>i</italic>,<italic>L</italic></sub> weighted sampling can be performed multiple times and will result in <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D^{b}_{\rho,L+1}, (1,..., B)$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12864_2019_6305_Article_IEq3.gif"/></alternatives></inline-formula> training datasets. Each of the dataset then can be used to train a base classification model. An ensemble classification of all cells in <italic>D</italic><sub><italic>&#x003c1;</italic></sub> can be obtained by combining the classification probabilities of each cell from each of the base models.</p></sec><sec id="Sec13"><title>Base classifiers</title><p>The AdaSampling framework, essentially a wrapper procedure, relies on base classification models to estimate the mislabelling probability of each cell in a scRNA-seq dataset. In this work, we used either support vector machine (SVM) [<xref ref-type="bibr" rid="CR32">32</xref>] or random forest (RF) [<xref ref-type="bibr" rid="CR33">33</xref>] as base classifiers to provide such probabilistic estimates, but any other classifiers capable of providing probabilistic estimates can be used. Specifically, for SVM, the prediction probability of each cell is estimated using Platt&#x02019;s method [<xref ref-type="bibr" rid="CR34">34</xref>] as follows:
<disp-formula id="Equa"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P(\hat{y} = k|\mathbf{\mathrm{x}},D) = \frac{1}{1 + \text{exp}(A \times f(\mathbf{\mathrm{x}}) + B)} $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>&#x00177;</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12864_2019_6305_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equb"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ f(\mathbf{\mathrm{x}}) = \beta + \sum_{\tau \in S} \alpha_{\tau} \text{exp}(-\gamma ||\mathbf{\mathrm{x}} - \mathbf{\mathrm{x}}_\tau||^{2}_{2}) $$ \end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b3;</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12864_2019_6305_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>S</italic> is the support vector set and <italic>A</italic> and <italic>B</italic> are parameters (estimated by maximum likelihood) of sigmoid link function that converts the output <italic>f</italic>(x) from the SVM into a probability where <italic>&#x003b1;</italic><sub><italic>&#x003c4;</italic></sub> and <italic>&#x003b2;</italic> represent the coefficient and intercept term of a classification vector respectively, and exp(<inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$-\gamma ||x-x_{\tau }||^{2}_{2}$\end{document}</tex-math><mml:math id="M16"><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b3;</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2019_6305_Article_IEq4.gif"/></alternatives></inline-formula>) represents radial basis kernel. Note that we used one-against-one approach for multi-class learning with SVM.</p><p>For RF, the prediction probability of each cell is estimated from a collection of trees as follows:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P(\hat{y} = k|\mathbf{\mathrm{x}},D) = \frac{1}{B}\sum_{b=1}^{B} \text{round}(h(\mathbf{\mathrm{x}}|\theta_{b}))  $$ \end{document}</tex-math><mml:math id="M18"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>&#x00177;</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mtext>round</mml:mtext><mml:mo>(</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">x</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12864_2019_6305_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>h</italic>(<bold>x</bold>|<italic>&#x003b8;</italic><sub><italic>b</italic></sub>) denote classification tree, each parameterised by <italic>&#x003b8;</italic><sub><italic>b</italic></sub> by training on the <italic>b</italic>th bootstrap data sample and a subset of features randomly sampled from <italic>M</italic><sup>&#x02032;</sup>. The round(.) function converts the probability value to the nearest integer to either 0 or 1. We estimate the probabilities by making a class prediction for each tree, and counting the fraction of trees that vote for a certain class. <italic>B</italic> is set to a default value of 100.</p></sec><sec id="Sec14"><title>Simulated and experimental scRNA-seq datasets</title><p>We used both simulated and real-world experimental scRNA-seq datasets to evaluate the proposed method. To simulate scRNA-seq datasets, we used the Splatter R package [<xref ref-type="bibr" rid="CR35">35</xref>]. Specifically, datasets with 3, 5, 7 and 9 cell types were simulated. The number of cells in each type was set to 100, the number of genes in each transcriptome was set to 10,000 and the probability of a gene being differentially expressed was set to 0.1. To simulate mislabelling, cell type label of 10%, 20%, 30%, 40% and 50% of randomly selected cells in each cell type group were flipped to the next cell type group. This was done for all cell types in each dataset and therefore introduced an overall of 10%, 20%, 30%, 40% and 50% mislabelled cells in each dataset with known ground truth label.</p><p>For experimental scRNA-seq datasets (Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>), the cell type annotation information from their original studies were treated as &#x02018;gold standard&#x02019; for method evaluation. The same procedure, in which 10%, 20%, 30%, 40% and 50% of the cells randomly selected in each cell type group were flipped into the next cell type group, was used to introduce mislabelled cells in each dataset. Both simulated and experimental scRNA-seq datasets were in unit fragments per kilobase of transcript per million mapped reads (FPKM) and were converted into log2(FPKM+1). Genes with more than 80% of missing values across cells were removed. This is because that while typically all genes are included in a scRNA-seq dataset, only a subset of genes are expressed. Therefore, many of the genes are expected to have no quantification and removing non-expressed genes in a scRNA-seq dataset is a common pre-processing approach [<xref ref-type="bibr" rid="CR36">36</xref>]. After filtering, these datasets were used to assess if and to what degree a method can correctly recover the mislabelled cells in each dataset. These datasets were used to assess if and to what degree a method can correctly recover the mislabelled cells in each dataset.</p></sec><sec id="Sec15"><title>Evaluation metrics</title><p>The mean classification accuracy and adjusted Rand index (ARI) were used to assess the performance of cell type identification from each dataset. For each cell <italic>i</italic> in a scRNA-seq dataset, let us denote the observed cell type label as <italic>y</italic><sub><italic>i</italic></sub> and the ground truth label (or gold standard label in the cases of experimental datasets) as <italic>s</italic><sub><italic>i</italic></sub>, then the mean classification accuracy can be defined as follows:
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \mathrm{mean~accuracy} = \frac{1}{K} \sum_{k=1}^{K} \frac{1}{N_{k}}\sum_{s_{i} = k} I\left(\hat{y}_{i}=s_{i}\right)  $$ \end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="normal">mean</mml:mi><mml:mspace width="1em"/><mml:mtext mathvariant="italic">accuracy</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x00177;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12864_2019_6305_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p>where <inline-formula id="IEq5"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {y}_{i}$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>&#x00177;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_6305_Article_IEq5.gif"/></alternatives></inline-formula> is the cell type given by the classification model, <italic>k</italic>&#x02208;{1,...,<italic>K</italic>} is the index of cell types in a dataset with <italic>K</italic> cell types, <italic>I</italic>(.) is the indicator function, and <italic>N</italic><sub><italic>k</italic></sub> is the number of cells the <italic>k</italic>th cell type.</p><p>ARI is a measure of the concordance between two lists of groupings [<xref ref-type="bibr" rid="CR37">37</xref>] and is widely used for benchmark performance of clustering method for scRNA-seq data. One advantage of ARI over mean classification accuracy is that the size of each cell type (i.e. the number of cells in each cell type group) is adjusted for in ARI whereas the mean classification accuracy does not distinguish between the different numbers of cells across cell type groups. Let <inline-formula id="IEq6"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$y_{i}, \hat {y}_{i}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x00177;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2019_6305_Article_IEq6.gif"/></alternatives></inline-formula>, and <italic>s</italic><sub><italic>i</italic></sub> be the lists of cell type labels for each cell in a scRNA-seq dataset, then for any given two lists we can define <italic>a</italic> the number of pairs of cells labelled as the same type in both lists, <italic>b</italic> the number of pairs of cells labelled as the same cell type in the first list but as different cell types in the second list, <italic>c</italic> the number of pairs of cells labelled as different cell types in the first list but as the same cell type in the second list, and <italic>d</italic> the number of pairs of cells labelled as from different cell types in both the first and the second list. ARI is then defined as follows:
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{ARI}=\frac{2(ad-bc)}{(a+b)(b+d)+(a+c)(c+d)}  $$ \end{document}</tex-math><mml:math id="M26"><mml:mtext>ARI</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">ad</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">bc</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2019_6305_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>ARI</term><def><p>adjusted rand index</p></def></def-item><def-item><term>FPKM</term><def><p>fragments per kilobase of transcript per million mapped reads PCA: principal component analysis</p></def></def-item><def-item><term>scRNA-seq</term><def><p>Single-cell RNA-seq</p></def></def-item><def-item><term>SOMs</term><def><p>self-organizing maps</p></def></def-item><def-item><term>tSNE</term><def><p>t-distributed stochastic neighbour embedding</p></def></def-item></def-list></glossary><fn-group><fn><p><bold>Publisher&#x02019;s Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><ack><title>Acknowledgements</title><p>The authors thank their colleagues at the School of Mathematics and Statistics, The University of Sydney, for informative discussion and valuable feedback.</p><sec id="d29e2065"><title>About this supplement</title><p>This article has been published as part of BMC Genomics, Volume 20 Supplement 9, 2019: 18th International Conference on Bioinformatics. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcgenomics.biomedcentral.com/articles/supplements/volume-20-supplement-9">https://bmcgenomics.biomedcentral.com/articles/supplements/volume-20-supplement-9</ext-link>.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>PY conceived the study. TK and PY implemented the method and performed the analyses with input from KL, TAG and JYHY PY drafted the manuscript with input from TK, KL and HJK. All authors edited and approved the final version of the manuscript.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>Publication of this article was funded by an Australian Research Council (ARC) Discovery Early Career Researcher Award (DE170100759) and a National Health and Medical Research Council (NHMRC) Investigator Grant (1173469) to P.Y., a NHMRC Career Development Fellowship (1105271) to J.Y.H.Y., an ARC Discovery Project (DP170100654) grant to P.Y. and J.Y.H.Y., and a Cardio Precision Medicine Coffey Scholarship to T.K.</p></notes><notes notes-type="data-availability"><title>Availability of data and materials</title><p>The datasets generated and/or analysed during the current study are available from the GEO, EBI, and Broad repositories. Details of datasets are listed in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>.</p></notes><notes><title>Ethics approval and consent to participate</title><p>Not applicable.</p></notes><notes><title>Consent for publication</title><p>Not applicable.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petropoulos</surname><given-names>S</given-names></name><name><surname>Edsg&#x000e4;rd</surname><given-names>D</given-names></name><name><surname>Reinius</surname><given-names>B</given-names></name><name><surname>Deng</surname><given-names>Q</given-names></name><name><surname>Panula</surname><given-names>SP</given-names></name><name><surname>Codeluppi</surname><given-names>S</given-names></name><name><surname>Reyes</surname><given-names>AP</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name><name><surname>Lanner</surname><given-names>F</given-names></name></person-group><article-title>Single-cell rna-seq reveals lineage and x chromosome dynamics in human preimplantation embryos</article-title><source>Cell</source><year>2016</year><volume>165</volume><issue>4</issue><fpage>1012</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.03.023</pub-id><pub-id pub-id-type="pmid">27062923</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>Q</given-names></name><name><surname>Lukowski</surname><given-names>S</given-names></name><name><surname>Chiu</surname><given-names>H</given-names></name><name><surname>Senabouth</surname><given-names>A</given-names></name><name><surname>Bruxner</surname><given-names>T</given-names></name><name><surname>Christ</surname><given-names>A</given-names></name><name><surname>Palpant</surname><given-names>N</given-names></name><name><surname>Powell</surname><given-names>J</given-names></name></person-group><article-title>Single-cell rna-seq of human induced pluripotent stem cells reveals cellular heterogeneity and cell state transitions between subpopulations</article-title><source>Genome Res</source><year>2018</year><volume>28</volume><fpage>gr</fpage><lpage>223925</lpage><pub-id pub-id-type="doi">10.1101/gr.223925.117</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeLaughter</surname><given-names>DM</given-names></name><name><surname>Bick</surname><given-names>AG</given-names></name><name><surname>Wakimoto</surname><given-names>H</given-names></name><name><surname>McKean</surname><given-names>D</given-names></name><name><surname>Gorham</surname><given-names>JM</given-names></name><name><surname>Kathiriya</surname><given-names>IS</given-names></name><name><surname>Hinson</surname><given-names>JT</given-names></name><name><surname>Homsy</surname><given-names>J</given-names></name><name><surname>Gray</surname><given-names>J</given-names></name><name><surname>Pu</surname><given-names>W</given-names></name><etal/></person-group><article-title>Single-cell resolution of temporal gene expression during heart development</article-title><source>Dev cell</source><year>2016</year><volume>39</volume><issue>4</issue><fpage>480</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1016/j.devcel.2016.10.001</pub-id><pub-id pub-id-type="pmid">27840107</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>Mu&#x000f1;oz-Manchado</surname><given-names>AB</given-names></name><name><surname>Codeluppi</surname><given-names>S</given-names></name><name><surname>L&#x000f6;nnerberg</surname><given-names>P</given-names></name><name><surname>La Manno</surname><given-names>G</given-names></name><name><surname>Jur&#x000e9;us</surname><given-names>A</given-names></name><name><surname>Marques</surname><given-names>S</given-names></name><name><surname>Munguba</surname><given-names>H</given-names></name><name><surname>He</surname><given-names>L</given-names></name><name><surname>Betsholtz</surname><given-names>C</given-names></name><etal/></person-group><article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell rna-seq</article-title><source>Science</source><year>2015</year><volume>347</volume><issue>6226</issue><fpage>1138</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id><pub-id pub-id-type="pmid">25700174</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname><given-names>X</given-names></name><name><surname>Shi</surname><given-names>Y</given-names></name><name><surname>Zou</surname><given-names>X</given-names></name><name><surname>Lu</surname><given-names>Z-N</given-names></name><name><surname>Xie</surname><given-names>G</given-names></name><name><surname>Yang</surname><given-names>JY</given-names></name><name><surname>Wu</surname><given-names>C-C</given-names></name><name><surname>Cui</surname><given-names>X-F</given-names></name><name><surname>He</surname><given-names>K-Y</given-names></name><name><surname>Luo</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Single-cell rna-seq analysis reveals dynamic trajectories during mouse liver development</article-title><source>BMC Genomics</source><year>2017</year><volume>18</volume><issue>1</issue><fpage>946</fpage><pub-id pub-id-type="doi">10.1186/s12864-017-4342-x</pub-id><pub-id pub-id-type="pmid">29202695</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Puram</surname><given-names>SV</given-names></name><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Parikh</surname><given-names>AS</given-names></name><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Yizhak</surname><given-names>K</given-names></name><name><surname>Gillespie</surname><given-names>S</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>Luo</surname><given-names>CL</given-names></name><name><surname>Mroz</surname><given-names>EA</given-names></name><name><surname>Emerick</surname><given-names>KS</given-names></name><etal/></person-group><article-title>Single-cell transcriptomic analysis of primary and metastatic tumor ecosystems in head and neck cancer</article-title><source>Cell</source><year>2017</year><volume>171</volume><issue>7</issue><fpage>1611</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.10.044</pub-id><pub-id pub-id-type="pmid">29198524</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>C</given-names></name><name><surname>Zheng</surname><given-names>L</given-names></name><name><surname>Yoo</surname><given-names>J-K</given-names></name><name><surname>Guo</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Kang</surname><given-names>B</given-names></name><name><surname>Hu</surname><given-names>R</given-names></name><name><surname>Huang</surname><given-names>JY</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Landscape of infiltrating t cells in liver cancer revealed by single-cell sequencing</article-title><source>Cell</source><year>2017</year><volume>169</volume><issue>7</issue><fpage>1342</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.05.035</pub-id><pub-id pub-id-type="pmid">28622514</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolodziejczyk</surname><given-names>AA</given-names></name><name><surname>Kim</surname><given-names>JK</given-names></name><name><surname>Svensson</surname><given-names>V</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name></person-group><article-title>The technology and biology of single-cell rna sequencing</article-title><source>Mol Cell</source><year>2015</year><volume>58</volume><issue>4</issue><fpage>610</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2015.04.005</pub-id><pub-id pub-id-type="pmid">26000846</pub-id></element-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>R</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Fei</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Lai</surname><given-names>S</given-names></name><name><surname>Saadatpour</surname><given-names>A</given-names></name><name><surname>Zhou</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Ye</surname><given-names>F</given-names></name><etal/></person-group><article-title>Mapping the mouse cell atlas by microwell-seq</article-title><source>Cell</source><year>2018</year><volume>172</volume><issue>5</issue><fpage>1091</fpage><lpage>107</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.02.001</pub-id><pub-id pub-id-type="pmid">29474909</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name><name><surname>Stubbington</surname><given-names>MJ</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name></person-group><article-title>The human cell atlas: from vision to reality</article-title><source>Nat News</source><year>2017</year><volume>550</volume><issue>7677</issue><fpage>451</fpage><pub-id pub-id-type="doi">10.1038/550451a</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Computational and analytical challenges in single-cell transcriptomics</article-title><source>Nat Rev Genet</source><year>2015</year><volume>16</volume><issue>3</issue><fpage>133</fpage><pub-id pub-id-type="doi">10.1038/nrg3833</pub-id><pub-id pub-id-type="pmid">25628217</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arendt</surname><given-names>D</given-names></name><name><surname>Musser</surname><given-names>JM</given-names></name><name><surname>Baker</surname><given-names>CV</given-names></name><name><surname>Bergman</surname><given-names>A</given-names></name><name><surname>Cepko</surname><given-names>C</given-names></name><name><surname>Erwin</surname><given-names>DH</given-names></name><name><surname>Pavlicev</surname><given-names>M</given-names></name><name><surname>Schlosser</surname><given-names>G</given-names></name><name><surname>Widder</surname><given-names>S</given-names></name><name><surname>Laubichler</surname><given-names>MD</given-names></name><etal/></person-group><article-title>The origin and evolution of cell types</article-title><source>Nat Rev Genet</source><year>2016</year><volume>17</volume><issue>12</issue><fpage>744</fpage><pub-id pub-id-type="doi">10.1038/nrg.2016.127</pub-id><pub-id pub-id-type="pmid">27818507</pub-id></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tirosh</surname><given-names>I</given-names></name><name><surname>Venteicher</surname><given-names>AS</given-names></name><name><surname>Hebert</surname><given-names>C</given-names></name><name><surname>Escalante</surname><given-names>LE</given-names></name><name><surname>Patel</surname><given-names>AP</given-names></name><name><surname>Yizhak</surname><given-names>K</given-names></name><name><surname>Fisher</surname><given-names>JM</given-names></name><name><surname>Rodman</surname><given-names>C</given-names></name><name><surname>Mount</surname><given-names>C</given-names></name><name><surname>Filbin</surname><given-names>MG</given-names></name><etal/></person-group><article-title>Single-cell rna-seq supports a developmental hierarchy in human oligodendroglioma</article-title><source>Nature</source><year>2016</year><volume>539</volume><issue>7628</issue><fpage>309</fpage><pub-id pub-id-type="doi">10.1038/nature20123</pub-id><pub-id pub-id-type="pmid">27806376</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maaten</surname><given-names>Lvd</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><article-title>Visualizing data using t-sne</article-title><source>J Mach Learn Res</source><year>2008</year><volume>9</volume><issue>Nov</issue><fpage>2579</fpage><lpage>605</lpage></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>DH</given-names></name><name><surname>Marinov</surname><given-names>GK</given-names></name><name><surname>Pepke</surname><given-names>S</given-names></name><name><surname>Singer</surname><given-names>ZS</given-names></name><name><surname>He</surname><given-names>P</given-names></name><name><surname>Williams</surname><given-names>B</given-names></name><name><surname>Schroth</surname><given-names>GP</given-names></name><name><surname>Elowitz</surname><given-names>MB</given-names></name><name><surname>Wold</surname><given-names>BJ</given-names></name></person-group><article-title>Single-cell transcriptome analysis reveals dynamic changes in lncrna expression during reprogramming</article-title><source>Cell Stem Cell</source><year>2015</year><volume>16</volume><issue>1</issue><fpage>88</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1016/j.stem.2014.11.005</pub-id><pub-id pub-id-type="pmid">25575081</pub-id></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bacher</surname><given-names>R</given-names></name><name><surname>Kendziorski</surname><given-names>C</given-names></name></person-group><article-title>Design and computational analysis of single-cell rna-sequencing experiments</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>63</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0927-y</pub-id><pub-id pub-id-type="pmid">27052890</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herring</surname><given-names>CA</given-names></name><name><surname>Banerjee</surname><given-names>A</given-names></name><name><surname>McKinley</surname><given-names>ET</given-names></name><name><surname>Simmons</surname><given-names>AJ</given-names></name><name><surname>Ping</surname><given-names>J</given-names></name><name><surname>Roland</surname><given-names>JT</given-names></name><name><surname>Franklin</surname><given-names>JL</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Gerdes</surname><given-names>MJ</given-names></name><name><surname>Coffey</surname><given-names>RJ</given-names></name><etal/></person-group><article-title>Unsupervised trajectory analysis of single-cell rna-seq and imaging data reveals alternative tuft cell origins in the gut</article-title><source>Cell Syst</source><year>2018</year><volume>6</volume><issue>1</issue><fpage>37</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2017.10.012</pub-id><pub-id pub-id-type="pmid">29153838</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gr&#x000fc;n</surname><given-names>D</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><article-title>Design and analysis of single-cell sequencing experiments</article-title><source>Cell</source><year>2015</year><volume>163</volume><issue>4</issue><fpage>799</fpage><lpage>810</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.10.039</pub-id><pub-id pub-id-type="pmid">26544934</pub-id></element-citation></ref><ref id="CR19"><label>19</label><mixed-citation publication-type="other">Kim T, Chen IR, Lin Y, Wang AY-Y, Yang JYH, Yang P. Impact of similarity metrics on single-cell rna-seq data clustering. Brief Bioinformatics. 2018. 10.1093/bib/bby076.</mixed-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>P</given-names></name><name><surname>Gao</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Noel</surname><given-names>P</given-names></name><name><surname>Yang</surname><given-names>C</given-names></name><name><surname>Hoff</surname><given-names>DV</given-names></name><name><surname>Han</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>MQ</given-names></name><name><surname>Lin</surname><given-names>W</given-names></name></person-group><article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title><source>Nucleic Acids Res</source><year>2019</year><volume>47</volume><issue>8</issue><fpage>e48</fpage><pub-id pub-id-type="doi">10.1093/nar/gkz116</pub-id><pub-id pub-id-type="pmid">30799483</pub-id></element-citation></ref><ref id="CR21"><label>21</label><mixed-citation publication-type="other">Wagner F, Yanai I. Moana: A robust and scalable cell type classification framework for single-cell rna-seq data. bioRxiv. 2018:456129. 10.1101/456129.</mixed-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiselev</surname><given-names>VY</given-names></name><name><surname>Yiu</surname><given-names>A</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group><article-title>scmap: projection of single-cell rna-seq data across data sets</article-title><source>Nat Methods</source><year>2018</year><volume>15</volume><issue>5</issue><fpage>359</fpage><pub-id pub-id-type="doi">10.1038/nmeth.4644</pub-id><pub-id pub-id-type="pmid">29608555</pub-id></element-citation></ref><ref id="CR23"><label>23</label><mixed-citation publication-type="other">Alquicira-Hernandez J, Nguyen Q, Powell JE. scpred: Single cell prediction using singular value decomposition and machine learning classification. bioRxiv. 2018:369538.</mixed-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crow</surname><given-names>M</given-names></name><name><surname>Paul</surname><given-names>A</given-names></name><name><surname>Ballouz</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>ZJ</given-names></name><name><surname>Gillis</surname><given-names>J</given-names></name></person-group><article-title>Characterizing the replicability of cell types defined by single cell rna-sequencing data using metaneighbor</article-title><source>Nat Commun</source><year>2018</year><volume>9</volume><issue>1</issue><fpage>884</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-03282-0</pub-id><pub-id pub-id-type="pmid">29491377</pub-id></element-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lieberman</surname><given-names>Y</given-names></name><name><surname>Rokach</surname><given-names>L</given-names></name><name><surname>Shay</surname><given-names>T</given-names></name></person-group><article-title>Castle&#x02013;classification of single cells by transfer learning: Harnessing the power of publicly available single cell rna sequencing experiments to annotate new experiments</article-title><source>PloS One</source><year>2018</year><volume>13</volume><issue>10</issue><fpage>0205499</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0205499</pub-id></element-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fr&#x000e9;nay</surname><given-names>B</given-names></name><name><surname>Verleysen</surname><given-names>M</given-names></name></person-group><article-title>Classification in the presence of label noise: a survey</article-title><source>IEEE Trans Neural Netw Learn Syst</source><year>2014</year><volume>25</volume><issue>5</issue><fpage>845</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1109/TNNLS.2013.2292894</pub-id><pub-id pub-id-type="pmid">24808033</pub-id></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>P</given-names></name><name><surname>Ormerod</surname><given-names>JT</given-names></name><name><surname>Liu</surname><given-names>W</given-names></name><name><surname>Ma</surname><given-names>C</given-names></name><name><surname>Zomaya</surname><given-names>AY</given-names></name><name><surname>Yang</surname><given-names>JY</given-names></name></person-group><article-title>Adasampling for positive-unlabeled and label noise learning with bioinformatics applications</article-title><source>IEEE Trans Cybern</source><year>2019</year><volume>49</volume><issue>5</issue><fpage>1932</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1109/TCYB.2018.2816984</pub-id><pub-id pub-id-type="pmid">29993676</pub-id></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gokce</surname><given-names>O</given-names></name><name><surname>Stanley</surname><given-names>GM</given-names></name><name><surname>Treutlein</surname><given-names>B</given-names></name><name><surname>Neff</surname><given-names>NF</given-names></name><name><surname>Camp</surname><given-names>JG</given-names></name><name><surname>Malenka</surname><given-names>RC</given-names></name><name><surname>Rothwell</surname><given-names>PE</given-names></name><name><surname>Fuccillo</surname><given-names>MV</given-names></name><name><surname>S&#x000fc;dhof</surname><given-names>TC</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name></person-group><article-title>Cellular taxonomy of the mouse striatum as revealed by single-cell rna-seq</article-title><source>Cell Rep</source><year>2016</year><volume>16</volume><issue>4</issue><fpage>1126</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2016.06.059</pub-id><pub-id pub-id-type="pmid">27425622</pub-id></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gates</surname><given-names>AJ</given-names></name><name><surname>Ahn</surname><given-names>Y-Y</given-names></name></person-group><article-title>The impact of random models on clustering similarity</article-title><source>J Mach Learn Res</source><year>2017</year><volume>18</volume><issue>1</issue><fpage>3049</fpage><lpage>76</lpage></element-citation></ref><ref id="CR30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>P</given-names></name><name><surname>Yoo</surname><given-names>PD</given-names></name><name><surname>Fernando</surname><given-names>J</given-names></name><name><surname>Zhou</surname><given-names>BB</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Zomaya</surname><given-names>AY</given-names></name></person-group><article-title>Sample subset optimization techniques for imbalanced and ensemble learning problems in bioinformatics applications</article-title><source>IEEE Trans Cybern</source><year>2014</year><volume>44</volume><issue>3</issue><fpage>445</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1109/TCYB.2013.2257480</pub-id><pub-id pub-id-type="pmid">24108722</pub-id></element-citation></ref><ref id="CR31"><label>31</label><mixed-citation publication-type="other">Yang P, Liu W, Yang J. Positive unlabeled learning via wrapper-based adaptive sampling. In: Proceedings of the Twenty-Sixth International Joint Conference on Artificial Intelligence, IJCAI-17. International Joint Conferences on Artificial Intelligence Organization: 2017. p. 3273&#x02013;9. 10.24963/ijcai.2017/457.</mixed-citation></ref><ref id="CR32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cortes</surname><given-names>C</given-names></name><name><surname>Vapnik</surname><given-names>V</given-names></name></person-group><article-title>Support-vector networks</article-title><source>Mach Learn</source><year>1995</year><volume>20</volume><issue>3</issue><fpage>273</fpage><lpage>97</lpage></element-citation></ref><ref id="CR33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>L</given-names></name></person-group><article-title>Random forests</article-title><source>Mach Learn</source><year>2001</year><volume>45</volume><issue>1</issue><fpage>5</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id></element-citation></ref><ref id="CR34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Platt</surname><given-names>J</given-names></name></person-group><article-title>Probabilistic outputs for support vector machines and comparisons to regularized likelihood methods</article-title><source>Adv Large Margin Classif</source><year>2000</year><volume>10</volume><fpage>61</fpage><lpage>74</lpage></element-citation></ref><ref id="CR35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Oshlack</surname><given-names>A</given-names></name></person-group><article-title>Splatter: simulation of single-cell rna sequencing data</article-title><source>Genome Biol</source><year>2017</year><volume>18</volume><issue>1</issue><fpage>174</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id><pub-id pub-id-type="pmid">28899397</pub-id></element-citation></ref><ref id="CR36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Y</given-names></name><name><surname>Ghazanfar</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>KY</given-names></name><name><surname>Gagnon-Bartsch</surname><given-names>JA</given-names></name><name><surname>Lo</surname><given-names>KK</given-names></name><name><surname>Su</surname><given-names>X</given-names></name><name><surname>Han</surname><given-names>Z-G</given-names></name><name><surname>Ormerod</surname><given-names>JT</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name><name><surname>Yang</surname><given-names>P</given-names></name><etal/></person-group><article-title>scmerge leverages factor analysis, stable expression, and pseudoreplication to merge multiple single-cell rna-seq datasets</article-title><source>Proc Nat Acad Sci</source><year>2019</year><volume>116</volume><issue>20</issue><fpage>9775</fpage><lpage>84</lpage><?supplied-pmid 31028141?><pub-id pub-id-type="pmid">31028141</pub-id></element-citation></ref><ref id="CR37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rand</surname><given-names>WM</given-names></name></person-group><article-title>Objective criteria for the evaluation of clustering methods</article-title><source>J Am Stat Assoc</source><year>1971</year><volume>66</volume><issue>336</issue><fpage>846</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1080/01621459.1971.10482356</pub-id></element-citation></ref></ref-list></back></article>